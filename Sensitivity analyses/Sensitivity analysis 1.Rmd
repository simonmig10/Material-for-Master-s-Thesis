---
title: "Bimets model"
output: html_document
date: "2022-12-21"
---



```{r}
rm(list = ls())

library(bimets)
```


# Tekst fil


```{r}
S_model.txt="MODEL

COMMENT> Disposable income and wealth 

COMMENT> 
IDENTITY> yd_r_brown
EQ> yd_r_brown = y_r_brown *(1 - theta_brown)

COMMENT> 
IDENTITY> yd_w_brown
EQ> yd_w_brown = y_w_brown*(1 - theta_brown) 

COMMENT> 
IDENTITY> yd_hs_r_brown
EQ> yd_hs_r_brown = yd_r_brown + cg_b_brown + cg_e_brown

COMMENT> 
IDENTITY> cg_b_brown
EQ> cg_b_brown = TSDELTA(xr_green)*TSLAG(b_browngreen_s,1) 

COMMENT> 
IDENTITY> cg_e_brown
EQ> cg_e_brown = TSDELTA(xr_green)*TSLAG(e_browngreen_s,1) 

COMMENT> 
IDENTITY> v_r_brown
EQ>  v_r_brown = TSLAG(v_r_brown,1) + yd_hs_r_brown - cons_r_brown 

COMMENT> 
IDENTITY> v_w_brown
EQ> v_w_brown = TSLAG(v_w_brown,1) + yd_w_brown - cons_w_brown 

COMMENT> 
IDENTITY> yd_r_green
EQ> yd_r_green = y_r_green*(1 - theta_green) - carbon_tax_green

COMMENT> 
IDENTITY> yd_w_green
EQ> yd_w_green = y_w_green*(1 - theta_green)

COMMENT> 
IDENTITY> yd_hs_r_green
EQ> yd_hs_r_green = yd_r_green + cg_b_green + cg_e_green  

COMMENT> 
IDENTITY> cg_b_green
EQ> cg_b_green = TSDELTA(xr_brown)*TSLAG(b_greenbrown_s,1)

COMMENT> 
IDENTITY> cg_e_green
EQ> cg_e_green = TSDELTA(xr_brown)*TSLAG(e_greenbrown_s,1)

COMMENT> 
IDENTITY> v_r_green
EQ> v_r_green = TSLAG(v_r_green,1) + yd_hs_r_green - cons_r_green 

COMMENT> 
IDENTITY> v_w_green
EQ> v_w_green = TSLAG(v_w_green,1) + yd_w_green - cons_w_green

COMMENT> 
IDENTITY> t_brown
EQ> t_brown = (y_r_brown + y_w_brown)*theta_brown + carbon_tax_brown

COMMENT> 
IDENTITY> t_green
EQ> t_green = (y_r_green + y_w_green)*theta_green + carbon_tax_green


COMMENT> Consumption and Income Shares


COMMENT> 
IDENTITY> cons
EQ> cons = cons_brown + cons_green 


COMMENT> Ændret shares
IDENTITY> cons_brown
EQ> cons_brown = cons_ob*cons_ob_dk_s
if> date < 2018
IDENTITY> cons_brown
EQ> cons_brown = cons_r_brown + cons_w_brown
if> date >= 2018


COMMENT> Ændret shares
IDENTITY> cons_green
EQ> cons_green = cons_ob*cons_ob_row_s
if> date < 2018
IDENTITY> cons_green
EQ> cons_green = cons_r_green+cons_w_green
if> date >= 2018



COMMENT>
IDENTITY> cons_w_brown
EQ> cons_w_brown = cons_brown-cons_r_brown
if> date < 2018
IDENTITY> cons_w_brown
EQ> cons_w_brown = (alpha1_w_brown*yd_w_brown + alpha2_w_brown*TSLAG(v_w_brown,1))*(1 - TSLAG(d_t_brown,1))
if> date >= 2018


COMMENT>
IDENTITY> cons_w_green
EQ> cons_w_green = cons_green-cons_r_green
if> date < 2018
IDENTITY> cons_w_green
EQ> cons_w_green = (alpha1_w_green*yd_w_green + alpha2_w_green*TSLAG(v_w_green,1))*(1 - TSLAG(d_t_green,1))
if> date >= 2018


COMMENT> 
IDENTITY> cons_r_brown
EQ> cons_r_brown = (alpha1_r_brown*yd_r_brown + alpha2_r_brown*TSLAG(v_r_brown,1))*(1 - TSLAG(d_t_brown,1)) 

COMMENT> 
IDENTITY> cons_r_green
EQ> cons_r_green = (alpha1_r_green*yd_r_green + alpha2_r_green*TSLAG(v_r_green,1))*(1 - TSLAG(d_t_green,1))  

COMMENT> 
IDENTITY> y_brown
EQ> y_brown = cons_r_brown + cons_w_brown + gov_tot_brown + x_brown - im_brown + inv_brown

COMMENT> 
IDENTITY> y_green
EQ> y_green = cons_r_green + cons_w_green + gov_tot_green + x_green - im_green + inv_green

COMMENT> 
IDENTITY> y_w_brown
EQ> y_w_brown = y_brown*omega_brown

COMMENT> 
IDENTITY> y_w_green
EQ> y_w_green = omega_green*y_green

COMMENT> 
IDENTITY> f_brown
EQ> f_brown = y_brown - y_w_brown - da_brown - TSLAG(r_l_brown,1)*TSLAG(l_firm_brown,1) - carbon_tax_brown

COMMENT> 
IDENTITY> fu_brown
EQ> fu_brown = f_brown*ret_brown 

COMMENT> Brownland firms distributed profits (dividends)
IDENTITY> fd_brown
EQ> fd_brown = TSLAG(r_e_brown,1)*(TSLAG(e_brownbrown_s,1)+TSLAG(e_greenbrown_s,1))

COMMENT> 
IDENTITY> f_m_brown
EQ> f_m_brown = f_brown - fu_brown - fd_brown

COMMENT> 
IDENTITY> y_r_brown
EQ> y_r_brown = f_m_brown +  f_bank_brown + TSLAG(r_brown,1)*TSLAG(b_brownbrown_s,1) + TSLAG(xr_green,1)*TSLAG(r_green,1)*TSLAG(b_browngreen_s,1) + TSLAG(f_d_brownbrown,1) + TSLAG(f_d_browngreen,1)

COMMENT> 
IDENTITY> f_d_browngreen
EQ> f_d_browngreen = xr_green*r_e_green*e_browngreen_s

COMMENT> 
IDENTITY> f_d_brownbrown
EQ> f_d_brownbrown = r_e_brown*e_brownbrown_s 

COMMENT> 
IDENTITY> f_green
EQ> f_green = y_green - y_w_green - da_green - TSLAG(r_l_green,1)*TSLAG(l_firm_green,1)

COMMENT> 
IDENTITY> fu_green
EQ> fu_green = f_green*ret_green

COMMENT> 
IDENTITY> fd_green
EQ> fd_green = TSLAG(r_e_green,1)*(TSLAG(e_greengreen_s,1)+TSLAG(e_browngreen_s,1))

COMMENT> 
IDENTITY> f_m_green
EQ> f_m_green = f_green - fu_green - fd_green


COMMENT> 
IDENTITY> y_r_green
EQ> y_r_green = f_m_green + f_bank_green + TSLAG(r_green,1)*TSLAG(b_greengreen_s,1) + TSLAG(xr_brown,1)*TSLAG(r_brown,1)*TSLAG(b_greenbrown_s,1) + TSLAG(f_d_greengreen,1) + TSLAG(f_d_greenbrown,1)


COMMENT> 
IDENTITY> f_d_greenbrown
EQ> f_d_greenbrown = xr_brown*r_e_brown*e_greenbrown_s


COMMENT> 
IDENTITY> f_d_greengreen
EQ> f_d_greengreen = r_e_green*e_greengreen_s


COMMENT> FIRMS# INVESTMENT PLANS


COMMENT> 
IDENTITY> k_brown
EQ> k_brown = k_gr_brown + k_con_brown + k_gr_im_brown


COMMENT> 
IDENTITY> k_gr_brown
EQ> k_gr_brown = TSLAG(k_gr_brown,1) + inv_gr_brown - da_gr_brown


COMMENT> 
IDENTITY> k_con_brown
EQ> k_con_brown = TSLAG(k_con_brown,1) + inv_con_brown - da_con_brown


COMMENT> 
IDENTITY> da_brown
EQ> da_brown = da_gr_brown + da_con_brown + da_gr_im_brown


COMMENT> 
IDENTITY> da_gr_brown
EQ> da_gr_brown = TSLAG(delta_brown*k_gr_brown,1)


COMMENT> 
IDENTITY> da_con_brown
EQ> da_con_brown = TSLAG(delta_brown*k_con_brown,1)


COMMENT> NOT included in paper!!!
IDENTITY> y_tr_brown
EQ> y_tr_brown=y_brown


COMMENT> 
IDENTITY> af_brown
EQ> af_brown = da_brown



COMMENT> HVAD SKER DER HER?
IDENTITY> inv_brown
EQ> inv_brown = (gamma0_brown + gamma1_brown*TSLAG(inv_brown,1) + gamma2_brown*TSLAG(gov_tot_inv_brown,1))*1
if> date < 2018
IDENTITY> inv_brown
EQ> inv_brown = (gamma0_brown + gamma1_brown*TSLAG(inv_brown,1) + gamma2_brown*TSLAG(gov_tot_inv_brown,1))*(1 - TSLAG(d_t_brown,1))
if> date >= 2018


COMMENT> 
IDENTITY> inv_gr_brown_t
EQ> inv_gr_brown_t =  ((chi1_brown*gov_gr_inv_brown + chi2_brown*y_brown + chi3_brown*TSLAG(d_t_brown,1))*(1 - TSLAG(d_t_brown,1)))*(1+g_gr_inv_brown)^(trend)


IDENTITY> inv_gr_brown
EQ> inv_gr_brown = inv_brown - inv_gr_im_brown - inv_gr_rd_brown
if> inv_gr_rd_brown + inv_gr_brown_t + inv_gr_im_brown > inv_brown
IDENTITY> inv_gr_brown
EQ> inv_gr_brown = inv_gr_brown_t
if> inv_gr_brown_t + inv_gr_im_brown + inv_gr_rd_brown <= inv_brown


COMMENT> 
IDENTITY> inv_gr_rd_brown
EQ> LOG(inv_gr_rd_brown) = -2.305 + LOG(inv_brown)
IF> date >= 1990 & Weak_PH <= 0 & carbon_tax_brown <= 0 
IDENTITY> inv_gr_rd_brown
EQ> LOG(inv_gr_rd_brown) = -2.305 + LOG(inv_brown)
IF> date >= 1990 & Weak_PH <= 0 & carbon_tax_brown > 0 
IDENTITY> inv_gr_rd_brown
EQ> LOG(inv_gr_rd_brown) = -2.305 + LOG(inv_brown)
IF> date >= 1990 & Weak_PH > 0 & carbon_tax_brown <= 0
IDENTITY> inv_gr_rd_brown
EQ> LOG(inv_gr_rd_brown) = -1.42 + LOG(inv_brown) + 0.15*LOG(carbon_tax_brown)
IF> date >= 1990 & Weak_PH > 0 & carbon_tax_brown > 0 
IDENTITY> inv_gr_rd_brown
EQ> inv_gr_rd_brown = 0
IF>  date < 1990



COMMENT> 
IDENTITY> inv_con_brown
EQ> inv_con_brown = inv_brown - inv_gr_brown - inv_gr_im_brown - inv_gr_rd_brown


COMMENT> 
IDENTITY> l_firm_brown
EQ> l_firm_brown  = TSLAG(l_firm_brown,1) + inv_brown - af_brown  - fu_brown - TSDELTA(e_greenbrown_s) - TSDELTA(e_brownbrown_s)


COMMENT> 
IDENTITY> k_green
EQ> k_green = k_gr_green + k_con_green + k_gr_im_green


COMMENT> 
IDENTITY> k_gr_green
EQ> k_gr_green = TSLAG(k_gr_green,1) + inv_gr_green - da_gr_green


COMMENT> 
IDENTITY> k_con_green
EQ> k_con_green = TSLAG(k_con_green,1) + inv_con_green - da_con_green


COMMENT> 
IDENTITY> da_green
EQ> da_green = da_gr_green + da_con_green + da_gr_im_green


COMMENT> 
IDENTITY> da_gr_green
EQ> da_gr_green = delta_green*TSLAG(k_gr_green,1)


COMMENT> 
IDENTITY> da_con_green
EQ> da_con_green = delta_green*TSLAG(k_con_green,1)

COMMENT> Not included in paper!
IDENTITY> y_tr_green
EQ> y_tr_green=y_green

COMMENT> 
IDENTITY> af_green
EQ> af_green = da_green




COMMENT> 
IDENTITY> inv_green
EQ> inv_green = (gamma0_green + gamma1_green*TSLAG(inv_green,1)  + gamma2_green*TSLAG(gov_tot_inv_green,1))*1
if> date < 2018
IDENTITY> inv_green
EQ> inv_green = (gamma0_green + gamma1_green*TSLAG(inv_green,1)  + gamma2_green*TSLAG(gov_tot_inv_green,1))*(1 - TSLAG(d_t_green,1))
if> date >= 2018


COMMENT> 
IDENTITY> inv_gr_green_t
EQ> inv_gr_green_t = ((chi1_green*gov_gr_inv_green+chi2_green*y_green + chi3_green*TSLAG(d_t_green,1))*(1 - TSLAG(d_t_green,1))) *(1+g_gr_inv_green)^(trend)


IDENTITY> inv_gr_green
EQ> inv_gr_green = inv_green - inv_gr_im_green - inv_gr_rd_green
if> inv_gr_rd_green + inv_gr_green_t + inv_gr_im_green > inv_green
IDENTITY> inv_gr_green
EQ> inv_gr_green = inv_gr_green_t
if> inv_gr_rd_green + inv_gr_green_t + inv_gr_im_green <= inv_green


COMMENT> 
IDENTITY> inv_gr_rd_green
EQ> LOG(inv_gr_rd_green) = -2.66 + LOG(inv_green) 
IF> date >= 1990 
IDENTITY> inv_gr_rd_green
EQ> inv_gr_rd_green = 0
IF> date < 1990 


COMMENT> 
IDENTITY> inv_con_green
EQ> inv_con_green = inv_green - inv_gr_green - inv_gr_im_green - inv_gr_rd_green

COMMENT> 
IDENTITY> l_firm_green
EQ> l_firm_green  = TSLAG(l_firm_green,1) + inv_green - af_green  - fu_green - TSDELTA(e_browngreen_s) - TSDELTA(e_greengreen_s)



COMMENT> INTERNATIONAL TRADE, Kan jeg skifte rundt på det her, det skal i hvertfald gøres så det ene af landene har lille åben økonomi assumptions!


COMMENT> 
IDENTITY> x_brown
EQ> LOG(x_brown) = eps0 - eps1*LOG(TSLAG(xr_brown,1)) + eps2*LOG(y_green)
IF> Strong_PH <= 0
IDENTITY> x_brown
EQ> LOG(x_brown) = -5.9502 - eps1*LOG(TSLAG(xr_brown,1)) + eps2*LOG(y_green) + 0.05*LOG(eta_gr_brown)
IF> Strong_PH > 0 & sens_5_high <= 0
IDENTITY> x_brown
EQ> LOG(x_brown) = -5.8008 - eps1*LOG(TSLAG(xr_brown,1)) + eps2*LOG(y_green) + 0.1*LOG(eta_gr_brown)
IF> Strong_PH > 0 & sens_5_high > 0



COMMENT> 
IDENTITY> x_con_brown
EQ> x_con_brown = x_brown - x_gr_brown


COMMENT> *(1 + ad_im*TSLAG(d_t_brown,1))
IDENTITY> im_brown
EQ> LOG(im_brown) = mu0 + mu1*LOG(TSLAG(xr_brown,1)) + mu2*LOG(y_brown)
IF> Strong_PH <= 0
IDENTITY> im_brown
EQ> LOG(im_brown) = -0.303 + mu1*LOG(TSLAG(xr_brown,1)) + mu2*LOG(y_brown) + 0.05*LOG(eta_gr_green)
IF> Strong_PH > 0 & sens_5_high <= 0
IDENTITY> im_brown
EQ> LOG(im_brown) = -0.1475 + mu1*LOG(TSLAG(xr_brown,1)) + mu2*LOG(y_brown) + 0.1*LOG(eta_gr_green)
IF> Strong_PH > 0 & sens_5_high > 0



COMMENT> 
IDENTITY> im_con_brown
EQ> im_con_brown = im_brown - im_gr_brown

COMMENT> 
IDENTITY> x_green
EQ> x_green = im_brown*xr_brown

COMMENT> 
IDENTITY> im_green
EQ> im_green = x_brown*xr_brown

COMMENT> 
IDENTITY> im_gr_green
EQ> im_gr_green = x_gr_brown*xr_brown

COMMENT> 
IDENTITY> im_con_green
EQ> im_con_green = x_con_brown*xr_brown

COMMENT> 
IDENTITY> x_gr_green
EQ> x_gr_green = im_gr_brown*xr_brown

COMMENT> 
IDENTITY> x_con_green
EQ> x_con_green = im_con_brown*xr_brown


COMMENT> DEMAND FOR FINANCIAL ASSETS (PORTFOLIO EQUATIONS), Hvordan skal bond markedet laves for at inkludere en lille åben økonomi???


COMMENT> 
IDENTITY> b_brownbrown_d
EQ> b_brownbrown_d = v_r_brown*(lambda10 + lambda11*TSLAG(r_brown,1) - lambda12* TSLAG(r_green,1) - lambda13*TSLAG(r_e_brown,1) - lambda14*TSLAG(r_e_green,1))

COMMENT> Bills issued by Greenland acquired by Brownland: demand
IDENTITY> b_browngreen_d
EQ> b_browngreen_d = v_r_brown*(lambda20 - lambda21*TSLAG(r_brown,1) + lambda22*TSLAG(r_green,1) - lambda23*TSLAG(r_e_brown,1) - lambda24*TSLAG(r_e_green,1))


COMMENT> HVAD SKER DER HER?
IDENTITY> e_browngreen_d
EQ> e_browngreen_d = 0
if> date < 1961
IDENTITY> e_browngreen_d
EQ> e_browngreen_d = v_r_brown*(lambda70 - lambda71*TSLAG(r_brown,1) - lambda72*TSLAG(r_green,1) - lambda73*TSLAG(r_e_brown,1) + lambda74*TSLAG(r_e_green,1))
if> date >= 1961


COMMENT> HVAD SKER DER HER?
IDENTITY> e_brownbrown_d
EQ> e_brownbrown_d = 0
if> date < 1961
IDENTITY> e_brownbrown_d
EQ> e_brownbrown_d = v_r_brown*(lambda90 - lambda91*TSLAG(r_brown,1) - lambda92*TSLAG(r_green,1) + lambda93*TSLAG(r_e_brown,1) - lambda94*TSLAG(r_e_green,1))
if> date >= 1961


COMMENT> 
IDENTITY> dep_r_brown
EQ> dep_r_brown = (v_r_brown - b_brownbrown_s - e_brownbrown_s - ((b_browngreen_s + e_browngreen_s)*xr_green))*depsh_brown

COMMENT> 
IDENTITY> h_brown_r_h
EQ> h_brown_r_h = v_r_brown - b_brownbrown_s - e_brownbrown_s - ((b_browngreen_s + e_browngreen_s)*xr_green) - dep_r_brown

COMMENT> 
IDENTITY> dep_w_brown
EQ> dep_w_brown = v_w_brown*depsh_brown

COMMENT> 
IDENTITY> h_brown_w_h
EQ> h_brown_w_h = v_w_brown - dep_w_brown

COMMENT> 
IDENTITY> h_brown_h
EQ> h_brown_h = h_brown_w_h + h_brown_r_h

COMMENT> 
IDENTITY> b_greengreen_d
EQ> b_greengreen_d = v_r_green*(lambda40 - lambda41*TSLAG(r_brown,1) + lambda42*TSLAG(r_green,1) - lambda43*TSLAG(r_e_brown,1) - lambda44*TSLAG(r_e_green,1))

COMMENT> 
IDENTITY> b_greenbrown_d
EQ> b_greenbrown_d = v_r_green*(lambda50 + lambda51*TSLAG(r_brown,1) - lambda52*TSLAG(r_green,1) - lambda53*TSLAG(r_e_brown,1) - lambda54*TSLAG(r_e_green,1))



COMMENT> 
IDENTITY> e_greenbrown_d
EQ> e_greenbrown_d = 0
if> date < 1961
IDENTITY> e_greenbrown_d
EQ> e_greenbrown_d = v_r_green*(lambda80 - lambda81*TSLAG(r_brown,1) - lambda82*TSLAG(r_green,1) + lambda83*TSLAG(r_e_brown,1) - lambda84*TSLAG(r_e_green,1))
if> date >= 1961

COMMENT> 
IDENTITY> e_greengreen_d
EQ> e_greengreen_d = 0
if> date < 1961
IDENTITY> e_greengreen_d
EQ> e_greengreen_d = v_r_green*(lambda100 - lambda101*TSLAG(r_brown,1) - lambda102*TSLAG(r_green,1) - lambda103*TSLAG(r_e_brown,1) + lambda104*TSLAG(r_e_green,1))
if> date >= 1961


COMMENT> 
IDENTITY> dep_r_green
EQ> dep_r_green = (v_r_green - b_greengreen_s - e_greengreen_s - ((b_greenbrown_s + e_greenbrown_s)*xr_brown))*depsh_green

COMMENT> 
IDENTITY> h_green_r_h
EQ> h_green_r_h = v_r_green - b_greengreen_s - e_greengreen_s - ((b_greenbrown_s + e_greenbrown_s)*xr_brown) - dep_r_green

COMMENT> 
IDENTITY> dep_w_green
EQ> dep_w_green = v_w_green*depsh_green

COMMENT> 
IDENTITY> h_green_w_h
EQ> h_green_w_h = v_w_green - dep_w_green

COMMENT> 
IDENTITY> h_green_h
EQ> h_green_h = h_green_w_h + h_green_r_h


COMMENT> SUPPLIES AND PRICES OF FINANCIAL ASSETS (EQUILIBRIUM CONDITIONS)



COMMENT> 
IDENTITY> b_brownbrown_s
EQ> b_brownbrown_s = b_brownbrown_d 


COMMENT>
IDENTITY> b_greenbrown_s
EQ> b_greenbrown_s = b_greenbrown_d*xr_green

COMMENT> 
IDENTITY> b_greengreen_s
EQ> b_greengreen_s = b_greengreen_d

COMMENT> 
IDENTITY> b_browngreen_s
EQ> b_browngreen_s = b_browngreen_d*xr_brown

COMMENT> 
IDENTITY> e_browngreen_s
EQ> e_browngreen_s = e_browngreen_d*xr_brown

COMMENT> 
IDENTITY> e_greengreen_s
EQ> e_greengreen_s = e_greengreen_d


COMMENT> Skal initial værdi ændres?
IDENTITY> e_green_real_s
EQ> e_green_real_s = 10
if> date < 1961
IDENTITY> e_green_real_s
EQ> e_green_real_s = TSLAG(e_green_real_s,1) + xi_green*TSLAG(inv_green,1)/TSLAG(p_e_green,1)
if> date >= 1961



COMMENT> HVAD SKER DER HER?
IDENTITY> p_e_green
EQ> p_e_green = 1
if> date < 1961
IDENTITY> p_e_green
EQ> p_e_green = (e_greengreen_d+e_browngreen_d)/e_green_real_s
if> date >= 1961


COMMENT> 
IDENTITY> e_greenbrown_s
EQ> e_greenbrown_s = e_greenbrown_d*xr_green

COMMENT> 
IDENTITY> e_brownbrown_s
EQ> e_brownbrown_s = e_brownbrown_d


COMMENT> Skal initial værdi ændres?
IDENTITY> e_brown_real_s
EQ> e_brown_real_s = 10
if> date < 1961
IDENTITY> e_brown_real_s
EQ> e_brown_real_s = TSLAG(e_brown_real_s,1) + xi_brown*TSLAG(inv_brown,1)/TSLAG(p_e_brown,1)
if> date >= 1961


COMMENT> HVAD SKER DER HER?
IDENTITY> p_e_brown
EQ> p_e_brown = 1
if> date < 1961
IDENTITY> p_e_brown
EQ> p_e_brown = (e_brownbrown_d+e_greenbrown_d)/e_brown_real_s
if> date >= 1961


COMMENT> 
IDENTITY> r_e_green
EQ> r_e_green = (1-pi_dy_green)*r_green + pi_dy_green*r_e_green_t



COMMENT> HVAD SKER DER HER?
IDENTITY> r_e_green_t
EQ> r_e_green_t = r_e_green
if> date < 1961
IDENTITY> r_e_green_t
EQ> r_e_green_t = (f_green/(TSLAG(e_green_real_s,1)*TSLAG(p_e_green,1)))
if> date >= 1961


COMMENT> 
IDENTITY> r_e_brown
EQ> r_e_brown = (1-pi_dy_brown)*r_brown + pi_dy_brown*r_e_brown_t


COMMENT> HVAD SKER DER HER?
IDENTITY> r_e_brown_t
EQ> r_e_brown_t = r_e_brown
if> date < 1961
IDENTITY> r_e_brown_t
EQ> r_e_brown_t = (f_brown/(TSLAG(e_brown_real_s,1)*TSLAG(p_e_brown,1)))
if> date >= 1961



COMMENT> THE BANKING SECTOR 



COMMENT> 
IDENTITY> dep_bank_brown
EQ> dep_bank_brown = dep_w_brown + dep_r_brown

COMMENT> 
IDENTITY> l_s_brown
EQ> l_s_brown= l_firm_brown

COMMENT> 
IDENTITY> b_brown_bank_not
EQ> b_brown_bank_not = dep_bank_brown - l_s_brown

COMMENT> TJEK Denne!
IDENTITY> z_brown
EQ> z_brown = 1 
if> b_brown_bank_not > 0
IDENTITY> z_brown
EQ> z_brown = 0 
if> b_brown_bank_not <= 0

COMMENT> 
IDENTITY> b_brown_bank
EQ> b_brown_bank = b_brown_bank_not*z_brown

COMMENT> 
IDENTITY> a_d_brown
EQ> a_d_brown = -b_brown_bank_not*(1- z_brown)

COMMENT> 
IDENTITY> a_s_brown
EQ> a_s_brown = a_d_brown

COMMENT> 
IDENTITY> f_bank_brown
EQ> f_bank_brown = TSLAG(r_brown,1)*TSLAG(b_brown_bank,1) + TSLAG(r_l_brown,1)*TSLAG(l_s_brown,1)

COMMENT> 
IDENTITY> dep_bank_green
EQ> dep_bank_green = dep_w_green + dep_r_green

COMMENT> 
IDENTITY> l_s_green
EQ> l_s_green= l_firm_green

COMMENT> 
IDENTITY> b_green_bank_not
EQ> b_green_bank_not = dep_bank_green - l_s_green


COMMENT> TJEK Denne!
IDENTITY> z_green
EQ> z_green = 1 
if> b_green_bank_not > 0
IDENTITY> z_green
EQ> z_green = 0 
if> b_green_bank_not <= 0


COMMENT> 
IDENTITY> b_green_bank
EQ> b_green_bank = b_green_bank_not*z_green

COMMENT> 
IDENTITY> a_d_green
EQ> a_d_green = -b_green_bank_not*(1- z_green)

COMMENT> 
IDENTITY> a_s_green
EQ> a_s_green = a_d_green

COMMENT> 
IDENTITY> f_bank_green
EQ> f_bank_green = TSLAG(r_green,1)*TSLAG(b_green_bank,1) + TSLAG(r_l_green,1)*TSLAG(l_s_green,1)



COMMENT> THE CENTRAL BANK AND THE GOVERNMENT SECTOR



COMMENT> TJEK!
IDENTITY> b_cb_brownbrown_s
EQ> b_cb_brownbrown_s = b_brown_s - b_brownbrown_s - b_greenbrown_s - b_brown_bank 


COMMENT> TJEK!
IDENTITY> h_brown_s
EQ> h_brown_s = TSLAG(h_brown_s,1) + TSDELTA(b_cb_brownbrown_s) + TSDELTA(a_s_brown) + TSDELTA(or_brown)


COMMENT> 
IDENTITY> f_cb_brown
EQ> f_cb_brown = TSLAG(r_brown,1)*TSLAG(b_cb_brownbrown_s,1)

COMMENT> 
IDENTITY> b_cb_greengreen_s
EQ> b_cb_greengreen_s = b_green_s - b_greengreen_s - b_browngreen_s - b_green_bank


COMMENT> 
IDENTITY> h_green_s
EQ> h_green_s = TSLAG(h_green_s,1)+ TSDELTA(b_cb_greengreen_s) + TSDELTA(a_s_green) + TSDELTA(or_green)


COMMENT> 
IDENTITY> f_cb_green
EQ> f_cb_green = TSLAG(r_green,1)*TSLAG(b_cb_greengreen_s,1)


COMMENT> 
IDENTITY> gov_tot_brown
EQ> gov_tot_brown = gov_con_brown + gov_gr_brown

COMMENT> 
IDENTITY> gov_tot_green
EQ> gov_tot_green = gov_con_green + gov_gr_green


COMMENT> 
IDENTITY> gov_con_brown
EQ> gov_con_brown = (gov_ob*gov_ob_dk_s) - gov_gr_brown
if> date < 2018
IDENTITY> gov_con_brown
EQ> gov_con_brown =  0.076167*gov_ob_dk_s + 1.003373*TSLAG(gov_con_brown,1) 
if> date >= 2018



COMMENT> Ændret share, Skal de ændres efter 2018?
IDENTITY> gov_con_green
EQ> gov_con_green = (gov_ob*gov_ob_row_s) - gov_gr_green
if> date < 2018
IDENTITY> gov_con_green
EQ> gov_con_green =  0.076167*gov_ob_row_s + 1.003373*TSLAG(gov_con_green,1)
if> date >= 2018


COMMENT> 
IDENTITY> b_brown_s
EQ> b_brown_s = TSLAG(b_brown_s,1) + gov_tot_brown + TSLAG(r_brown,1)*TSLAG(b_brown_s,1) - t_brown - f_cb_brown

COMMENT> 
IDENTITY> b_green_s
EQ> b_green_s = TSLAG(b_green_s,1) + gov_tot_green + TSLAG(r_green,1)*TSLAG(b_green_s,1) - t_green - f_cb_green


COMMENT> TJEK!
IDENTITY> xr_green
EQ> xr_green = 1


COMMENT> 
IDENTITY> xr_brown
EQ> xr_brown = 1/xr_green


COMMENT> TJEK!
IDENTITY> or_brown
EQ> or_brown = TSLAG(or_brown,1) + cab_brown + kabp_brown



COMMENT>
IDENTITY> or_green
EQ> or_green = TSLAG(or_green,1) - TSDELTA(or_brown)


COMMENT> THE ECOSYSTEM: MATERIAL RESOURCES AND RESERVES


COMMENT> 
IDENTITY> y_mat_brown
EQ> y_mat_brown = mu_brown*y_brown

COMMENT> 
IDENTITY> y_mat_green
EQ> y_mat_green = mu_green*y_green

COMMENT> 
IDENTITY> mat_brown
EQ> mat_brown = y_mat_brown - rec_brown

COMMENT> 
IDENTITY> mat_green
EQ> mat_green = y_mat_green - rec_green

COMMENT> 
IDENTITY> rec_brown
EQ> rec_brown = rho_brown*dis_brown

COMMENT> 
IDENTITY> rec_green
EQ> rec_green = rho_green*dis_green

COMMENT> 
IDENTITY> dis_brown
EQ> dis_brown = mu_brown*(da_brown + zeta_brown*TSLAG(dc_brown,1))

COMMENT> 
IDENTITY> dis_green
EQ> dis_green = mu_green*(da_green + zeta_green*TSLAG(dc_green,1))

COMMENT> 
IDENTITY> dc_brown
EQ> dc_brown = TSLAG(dc_brown,1) + cons_brown - tb_brown - zeta_brown*TSLAG(dc_brown,1)

COMMENT> 
IDENTITY> dc_green
EQ> dc_green = TSLAG(dc_green,1) + cons_green - tb_green - zeta_green*TSLAG(dc_green,1)

COMMENT> 
IDENTITY> k_se_brown
EQ> k_se_brown = TSLAG(k_se_brown,1) + y_mat_brown - dis_brown

COMMENT> 
IDENTITY> k_se_green
EQ> k_se_green = TSLAG(k_se_green,1) + y_mat_green - dis_green

COMMENT> 
IDENTITY> wa_brown
EQ> wa_brown = mat_brown - TSDELTA(k_se_brown)

COMMENT> 
IDENTITY> wa_green
EQ> wa_green = mat_green - TSDELTA(k_se_green)

COMMENT> 
IDENTITY> k_m_brown
EQ> k_m_brown = TSLAG(k_m_brown,1) + conv_m_brown - mat_brown

COMMENT> 
IDENTITY> k_m_green
EQ> k_m_green = TSLAG(k_m_green,1) + conv_m_green - mat_green

COMMENT> 
IDENTITY> conv_m_brown
EQ> conv_m_brown = sigma_m_brown*TSLAG(res_m_brown,1)

COMMENT> 
IDENTITY> conv_m_green
EQ> conv_m_green = sigma_m_green*TSLAG(res_m_green,1)


COMMENT> 
IDENTITY> res_m_brown
EQ> res_m_brown = TSLAG(res_m_brown,1) - conv_m_brown

COMMENT> 
IDENTITY> res_m_green
EQ> res_m_green = TSLAG(res_m_green,1) - conv_m_green

COMMENT> 
IDENTITY> res_m
EQ> res_m = res_m_brown + res_m_green

COMMENT> 
IDENTITY> cen_brown
EQ> cen_brown = emis_brown/car

COMMENT> 
IDENTITY> cen_green
EQ> cen_green = emis_green/car

COMMENT> 
IDENTITY> o2_brown
EQ> o2_brown = emis_brown - cen_brown

COMMENT> 
IDENTITY> o2_green
EQ> o2_green = emis_green - cen_green



COMMENT> THE ECOSYSTEM: ENERGY RESOURCES AND RESERVES (equations 155 to 170)


COMMENT> 
IDENTITY> e_brown
EQ> e_brown = epsilon_brown*y_brown

COMMENT> 
IDENTITY> er_brown
EQ> er_brown = eta_brown*e_brown

COMMENT> 
IDENTITY> en_brown
EQ> en_brown = e_brown - er_brown

COMMENT> 
IDENTITY> ed_brown
EQ> ed_brown = er_brown + en_brown

COMMENT> 
IDENTITY> e_green
EQ> e_green = epsilon_green*y_green

COMMENT> 
IDENTITY> er_green
EQ> er_green = eta_green*e_green

COMMENT> 
IDENTITY> en_green
EQ> en_green = e_green - er_green

COMMENT> 
IDENTITY> ed_green
EQ> ed_green = er_green + en_green

COMMENT> 
IDENTITY> k_e_brown
EQ> k_e_brown = TSLAG(k_e_brown,1) + conv_e_brown - en_brown

COMMENT> 
IDENTITY> k_e_green
EQ> k_e_green = TSLAG(k_e_green,1) + conv_e_green - en_green

COMMENT> 
IDENTITY> k_e
EQ> k_e = k_e_brown + k_e_green

COMMENT> 
IDENTITY> conv_e_brown
EQ> conv_e_brown = sigma_e_brown*TSLAG(res_e_brown,1)

COMMENT> 
IDENTITY> conv_e_green
EQ> conv_e_green = sigma_e_green*TSLAG(res_e_green,1)

COMMENT> 
IDENTITY> res_e_brown
EQ> res_e_brown = TSLAG(res_e_brown,1) - conv_e_brown

COMMENT> 
IDENTITY> res_e_green
EQ> res_e_green = TSLAG(res_e_green,1) - conv_e_green

COMMENT> 
IDENTITY> res_e
EQ> res_e = res_e_brown + res_e_green



COMMENT> THE ECOSYSTEM: EMISSIONS AND CLIMATE CHANGE (equations 171 to 181)


COMMENT> Ændret så der ik er constraint mere
IDENTITY> emis_brown
EQ> emis_brown = beta_brown0 + beta_brown*en_brown



COMMENT> Igen fungerer grøn land som residual, skal det laves om eller brug Brown som DK??
IDENTITY> emis_green
EQ> emis_green = emis - emis_brown - emis_l
if> date < 2018
IDENTITY> emis_green
EQ> emis_green =  (beta_green0-4) + beta_green*en_green
if> date >= 2018


COMMENT> 
IDENTITY> emis_l
EQ> emis_l = TSLAG(emis_l,1)*(1-g_land)


COMMENT> TJEK!
IDENTITY> emis
EQ> emis = emis_ob
if> date < 2018
IDENTITY> emis
EQ> emis =  emis_brown + emis_green + emis_l
if> date >= 2018


COMMENT> 
IDENTITY> co2_at
EQ> co2_at = emis + phi11*TSLAG(co2_at,1) + phi21*TSLAG(co2_up,1)

COMMENT> 
IDENTITY> co2_up
EQ> co2_up = phi12*TSLAG(co2_at,1) + phi22*TSLAG(co2_up,1) + phi32*TSLAG(co2_lo,1)

COMMENT> 
IDENTITY> co2_lo
EQ> co2_lo = phi23*TSLAG(co2_up,1) + phi33*TSLAG(co2_lo,1)

COMMENT> 
IDENTITY> f
EQ> f = f2*log((co2_at/co2_at_pre),2) + f_ex

COMMENT> 
IDENTITY> f_ex
EQ> f_ex = TSLAG(f_ex,1) + fex


COMMENT> TJEK!
IDENTITY> temp_at
EQ> temp_at = temp_at_ob
if> date < 2018
IDENTITY> temp_at
EQ> temp_at =  TSLAG(temp_at,1) + t1*(f - (f2/sens)*TSLAG(temp_at,1)-t2*(TSLAG(temp_at,1) - TSLAG(temp_lo,1)))
if> date >= 2018


COMMENT> 
IDENTITY> temp_lo
EQ> temp_lo = TSLAG(temp_lo,1) + t3*(TSLAG(temp_at,1)-TSLAG(temp_lo,1))


COMMENT> Note: maximum temperature rise depends also on non_CO2 radiative forcing due to methane, nitrous oxide, aerosols and other anthropogenic factors (see IPCC 2018, p. 7)


COMMENT> THE ECOSYSTEM: ECOLOGICAL EFFICIENCY (equations 182 to 193)

COMMENT> NOTE: starting from 1990 in Greenland, while starting from 2010 in Brownland


COMMENT> TJEK!
IDENTITY> mu_brown
EQ> mu_brown = mu_con_brown
if> date < 1990
IDENTITY> mu_brown
EQ> mu_brown =  (mu_gr_brown*k_gr_brown/k_brown + mu_gr_green*k_gr_im_brown/k_brown + mu_con_brown*k_con_brown/k_brown)
if> date >= 1990


COMMENT> TJEK!
IDENTITY> mu_green
EQ> mu_green = mu_con_green
if> date < 1990
IDENTITY> mu_green
EQ> mu_green =  (mu_gr_green*k_gr_green/k_green + mu_gr_brown*k_gr_im_green/k_green + mu_con_green*k_con_green/k_green)
if> date >= 1990


COMMENT> TJEK!
IDENTITY> epsilon_brown
EQ> epsilon_brown = epsilon_con_brown
if> date < 1990
IDENTITY> epsilon_brown
EQ> epsilon_brown =  (epsilon_gr_brown*k_gr_brown/k_brown + epsilon_gr_green*k_gr_im_brown/k_brown + epsilon_con_brown*k_con_brown/k_brown)
if> date >= 1990


COMMENT> TJEK!
IDENTITY> epsilon_green
EQ> epsilon_green = epsilon_con_green
if> date < 1990
IDENTITY> epsilon_green
EQ> epsilon_green =  (epsilon_gr_green*k_gr_green/k_green + epsilon_gr_brown*k_gr_im_green/k_green + epsilon_con_green*k_con_green/k_green)
if> date >= 1990


COMMENT> 
IDENTITY> beta_brown
EQ> beta_brown = beta_con_brown
if> date < 1990
IDENTITY> beta_brown
EQ> beta_brown = (beta_avg_gr_brown*k_gr_brown/k_brown + beta_im_gr_brown*k_gr_im_brown/k_brown + beta_con_brown*k_con_brown/k_brown)
if> date >= 1990 



COMMENT> 
IDENTITY> beta_green
EQ> beta_green = beta_con_green
if> date < 1990
IDENTITY> beta_green
EQ> beta_green = (beta_avg_gr_green*k_gr_green/k_green + beta_im_gr_green*k_gr_im_green/k_green + beta_con_green*k_con_green/k_green)
if> date >= 1990 



COMMENT> TJEK!
IDENTITY> eta_brown
EQ> eta_brown =  (eta_avg_gr_brown*k_gr_brown/k_brown + eta_im_gr_brown*k_gr_im_brown/k_brown + eta_con_brown*k_con_brown/k_brown)




COMMENT> 
IDENTITY> eta_gr_impv_brown
EQ> LOG(eta_gr_impv_brown) = -1.33 + 0.5944*LOG(gov_gr_rd_brown + inv_gr_rd_brown)



COMMENT> 
IDENTITY> eta_gr_brown
EQ> eta_gr_brown =  TSLAG(eta_gr_brown,1) + eta_gr_impv_brown




COMMENT> 
IDENTITY> eta_gr_impv_green
EQ> LOG(eta_gr_impv_green) = -4.242 + 0.5944*log(gov_gr_rd_green + inv_gr_rd_green) 



COMMENT> 
IDENTITY> eta_gr_green
EQ> eta_gr_green =  TSLAG(eta_gr_green,1) + eta_gr_impv_green


COMMENT> TJEK!
IDENTITY> eta_green
EQ> eta_green = (eta_avg_gr_green*k_gr_green/k_green + eta_im_gr_green*k_gr_im_green/k_green + eta_con_green*k_con_green/k_green)



COMMENT> Skal der opdateres starting value??
IDENTITY> depl_m_brown
EQ> depl_m_brown = 0.24
if> date < 1962
IDENTITY> depl_m_brown
EQ> depl_m_brown = mat_brown/TSLAG(k_m_brown,1)
if> date >= 1962


COMMENT> Skal der opdateres starting value??
IDENTITY> depl_m_green
EQ> depl_m_green = 0.24
if> date < 1962
IDENTITY> depl_m_green
EQ> depl_m_green = mat_green/TSLAG(k_m_green,1)
if> date >= 1962


COMMENT> TJEK!
IDENTITY> depl_e_brown
EQ> depl_e_brown = 0
if> date < 1962
IDENTITY> depl_e_brown
EQ> depl_e_brown = en_brown/TSLAG(k_e_brown,1)
if> date >= 1962


COMMENT> TJEK!
IDENTITY> depl_e_green
EQ> depl_e_green = 0
if> date < 1962
IDENTITY> depl_e_green
EQ> depl_e_green = en_green/TSLAG(k_e_green,1)
if> date >= 1962


COMMENT> THE ECOSYSTEM: ECOLOGICAL FEEDBACKS (equations 194 to 197)

COMMENT> TJEK!
IDENTITY> d_t_brown
EQ> d_t_brown = 1 - 1/(1 + dam1_brown*temp_at + dam2_brown*temp_at^2 + dam3_brown*temp_at^(dam4_brown))
if> temp_at > 0
IDENTITY> d_t_brown
EQ> d_t_brown = 1 - 1/(1 + dam1_brown*temp_at)
if> temp_at <= 0


COMMENT> TJEK!
IDENTITY> d_t_green
EQ> d_t_green = 1 - 1/(1 + dam1_green*temp_at + dam2_green*temp_at^2 + dam3_green*temp_at^(dam4_green))
if> temp_at > 0
IDENTITY> d_t_green
EQ> d_t_green = 1 - 1/(1 + dam1_green*temp_at)
if> temp_at <= 0


COMMENT> TJEK!
IDENTITY> delta_brown
EQ> delta_brown = delta0_brown
if> date < 2018
IDENTITY> delta_brown
EQ> delta_brown = delta0_brown + (1-delta0_brown)*(1 - ad_k_brown)*TSLAG(d_t_brown,1)
if> date >= 2018


COMMENT> TJEK!
IDENTITY> delta_green
EQ> delta_green = delta0_green
if> date < 2018
IDENTITY> delta_green
EQ> delta_green = delta0_green + (1-delta0_green)*(1 - ad_k_green)*TSLAG(d_t_green,1)
if> date >= 2018


COMMENT> AUXILIARY EQUATIONS FOR DOMESTIC AND FOREIGN BALANCES


COMMENT> 
IDENTITY> psbr_brown
EQ> psbr_brown = gov_tot_brown + TSLAG(r_brown,1)*TSLAG(b_brown_s,1) - t_brown - f_cb_brown

COMMENT> 
IDENTITY> psbr_green
EQ> psbr_green = gov_tot_green + TSLAG(r_green,1)*TSLAG(b_green_s,1) - t_green - f_cb_green

COMMENT> 
IDENTITY> nafa_brown
EQ> nafa_brown = psbr_brown + cab_brown

COMMENT> 
IDENTITY> nafa_green
EQ> nafa_green = psbr_green + cab_green

COMMENT> Current account balance in Brownland
IDENTITY> cab_brown
EQ> cab_brown = x_brown - im_brown + TSLAG(xr_green,1)*(TSLAG(r_green,1)*TSLAG(b_browngreen_s,1) + TSLAG(r_e_green,1)*TSLAG(e_browngreen_s,1)) - TSLAG(r_brown,1)*TSLAG(b_greenbrown_s,1) - TSLAG(r_e_brown,1)*TSLAG(e_greenbrown_s,1)

COMMENT> 
IDENTITY> cab_green
EQ> cab_green = x_green - im_green + TSLAG(xr_brown,1)*(TSLAG(r_brown,1)*TSLAG(b_greenbrown_s,1) + TSLAG(r_e_brown,1)*TSLAG(e_greenbrown_s,1)) - TSLAG(r_green,1)*TSLAG(b_browngreen_s,1) - TSLAG(r_e_green,1)*TSLAG(e_browngreen_s,1)

COMMENT> Diff?
IDENTITY> kabp_brown
EQ> kabp_brown = - TSDELTA(b_browngreen_s)*xr_green - TSDELTA(e_browngreen_s)*xr_green + TSDELTA(b_greenbrown_s) + TSDELTA(e_greenbrown_s)

COMMENT> Diff?
IDENTITY> kabp_green
EQ> kabp_green = - TSDELTA(b_greenbrown_s)*xr_brown - TSDELTA(e_greenbrown_s)*xr_brown + TSDELTA(b_browngreen_s) + TSDELTA(e_browngreen_s)

COMMENT> 
IDENTITY> tb_brown
EQ> tb_brown =  x_brown - im_brown

COMMENT> 
IDENTITY> tb_green
EQ> tb_green = x_green - im_green

COMMENT> 
IDENTITY> bp_brown
EQ> bp_brown = cab_brown + kabp_brown

COMMENT> 
IDENTITY> bp_green
EQ> bp_green = cab_green + kabp_green

COMMENT> 
IDENTITY> gnp_brown
EQ> gnp_brown = y_brown + TSLAG(xr_green,1)*TSLAG(r_green,1)*TSLAG(b_browngreen_s,1) - TSLAG(r_brown,1)*TSLAG(b_greenbrown_s,1) + TSLAG(xr_green,1)*TSLAG(r_e_green,1)*TSLAG(e_browngreen_s,1) - TSLAG(r_e_brown,1)*TSLAG(e_greenbrown_s,1)

COMMENT> 
IDENTITY> gnp_green
EQ> gnp_green = y_green + TSLAG(xr_brown,1)*TSLAG(r_brown,1)*TSLAG(b_greenbrown_s,1) - TSLAG(r_green,1)*TSLAG(b_browngreen_s,1) + TSLAG(xr_brown,1)*TSLAG(r_e_brown,1)*TSLAG(e_greenbrown_s,1) - TSLAG(r_e_green,1)*TSLAG(e_browngreen_s,1)

COMMENT> Tror denne er ligegyldig!!!
IDENTITY> mu2
EQ> mu2 = TSLAG(mu2,1) + mu2_par*TSDELTA(gov_gr_brown)


COMMENT> INEQUALITY INDICES

COMMENT> 
IDENTITY> yd_tot_brown
EQ> yd_tot_brown = yd_w_brown + yd_hs_r_brown

COMMENT> 
IDENTITY> gini_brown
EQ> gini_brown  = yd_hs_r_brown/yd_tot_brown

COMMENT> 
IDENTITY> yd_tot_green
EQ> yd_tot_green = yd_w_green + yd_hs_r_green

COMMENT> 
IDENTITY> gini_green
EQ> gini_green  = yd_hs_r_green/yd_tot_green

COMMENT> 
IDENTITY> v_tot_brown
EQ> v_tot_brown = v_r_brown + v_w_brown

COMMENT> 
IDENTITY> giniw_brown
EQ> giniw_brown  = v_r_brown/v_tot_brown


COMMENT> 
IDENTITY> v_tot_green
EQ> v_tot_green = v_r_green + v_w_green


COMMENT> 
IDENTITY> giniw_green
EQ> giniw_green  = v_r_green/v_tot_green



COMMENT> ADDITIONAL FINANCIAL VARIABLES AND INDICES



COMMENT> TJEK!
IDENTITY> q_green
EQ> q_green = 0.81
if> date < 1961
IDENTITY> q_green
EQ> q_green = (e_green_real_s*p_e_green + l_firm_green)/k_green
if> date >= 1961


COMMENT> TJEK!
IDENTITY> q_brown
EQ> q_brown = 0.81
if> date < 1961
IDENTITY> q_brown
EQ> q_brown = (e_brown_real_s*p_e_brown + l_firm_brown)/k_brown
if> date >= 1961


COMMENT> TJEK!
IDENTITY> lev_f_green
EQ> lev_f_green = 0.05
if> date < 1961
IDENTITY> lev_f_green
EQ> lev_f_green = l_firm_green/k_green
if> date >= 1961


COMMENT> TJEK!
IDENTITY> lev_f_brown
EQ> lev_f_brown = 0.05
if> date < 1961
IDENTITY> lev_f_brown
EQ> lev_f_brown = l_firm_brown/k_brown
if> date >= 1961



COMMENT> TJEK!
IDENTITY> per_green
EQ> per_green = 0.28
if> date < 1961
IDENTITY> per_green
EQ> per_green = p_e_green/(f_green/TSLAG(e_green_real_s,1))
if> date >= 1961



COMMENT> TJEK!
IDENTITY> per_brown
EQ> per_brown = 0.28
if> date < 1961
IDENTITY> per_brown
EQ> per_brown = p_e_brown/(f_brown/TSLAG(e_brown_real_s,1))
if> date >= 1961


COMMENT> 
IDENTITY> liq_b_green
EQ> liq_b_green = (a_s_green+dep_bank_green-l_s_green)/dep_bank_green


COMMENT> 
IDENTITY> liq_b_brown
EQ> liq_b_brown = (a_s_brown+dep_bank_brown-l_s_brown)/dep_bank_brown



COMMENT> ECOLOGICAL EFFICIENCY: ADDITIONAL CALCULATIONS



COMMENT> TJEK!
IDENTITY> mu_world
EQ> mu_world = 0
if> date < 1961
IDENTITY> mu_world
EQ> mu_world = mu_brown*k_brown/(k_brown+k_green)+mu_green*k_green/(k_brown+k_green)
if> date >= 1961


COMMENT> TJEK!
IDENTITY> epsilon_world
EQ> epsilon_world = 0
if> date < 1961
IDENTITY> epsilon_world
EQ> epsilon_world = epsilon_brown*k_brown/(k_brown+k_green)+epsilon_green*k_green/(k_brown+k_green)
if> date >= 1961


COMMENT> TJEK!
IDENTITY> beta_world
EQ> beta_world = 0
if> date < 1961
IDENTITY> beta_world
EQ> beta_world = beta_brown*k_brown/(k_brown+k_green)+beta_green*k_green/(k_brown+k_green)
if> date >= 1961


COMMENT> TJEK!
IDENTITY> eta_world
EQ> eta_world = 0
if> date < 1961
IDENTITY> eta_world
EQ> eta_world = eta_brown*k_brown/(k_brown+k_green)+eta_green*k_green/(k_brown+k_green)
if> date >= 1961


COMMENT> ADDITIONAL EQUATIONS FOR BOND MARKET


COMMENT> 
IDENTITY> p_b_brown
EQ> p_b_brown = (b_brownbrown_d + b_greenbrown_d)/(b_brown_s)

COMMENT> 
IDENTITY> p_b_green
EQ> p_b_green = (b_greengreen_d + b_browngreen_d)/(b_green_s)



COMMENT> EQUATIONS FOR GLOBAL VARIABLES (DENOMINATED IN GREENLAND CURRENCY)


COMMENT> 
IDENTITY> inv
EQ> inv = inv_green + inv_brown*xr_brown

COMMENT> 
IDENTITY> gov
EQ> gov = gov_con_green + gov_con_brown*xr_brown + gov_gr_green + gov_gr_brown*xr_brown

COMMENT> 
IDENTITY> yd
EQ> yd = yd_w_brown*xr_brown + yd_w_green + yd_r_brown*xr_brown + yd_r_green

COMMENT> 
IDENTITY> k
EQ> k = k_green + k_brown*xr_brown

COMMENT> 
IDENTITY> v
EQ> v = v_w_brown*xr_brown + v_w_green + v_r_brown*xr_brown + v_r_green

COMMENT> 
IDENTITY> y
EQ> y = inv + cons + gov

COMMENT> Carbon tax ##############################################


COMMENT> Tax per ton co2 in dollars. 
IDENTITY> carbon_tax_rate_green
EQ> carbon_tax_rate_green = 0
if> carbon_tax_shock_green <= 0
IDENTITY> carbon_tax_rate_green
EQ> carbon_tax_rate_green = 50
if> carbon_tax_shock_green > 0

COMMENT> Tax per ton co2 in dollars. 
IDENTITY> carbon_tax_rate_brown
EQ> carbon_tax_rate_brown = 0
if> carbon_tax_shock_brown <= 0
IDENTITY> carbon_tax_rate_brown
EQ> carbon_tax_rate_brown = carbon_tax_2022
if> carbon_tax_shock_brown > 0


COMMENT> Total Carbon tax in greenland. 
IDENTITY> carbon_tax_green
EQ> carbon_tax_green= 0
if> (emis_green*1000000000*carbon_tax_rate_green)/1000000000000 <= 0
IDENTITY> carbon_tax_green
EQ> carbon_tax_green= (emis_green*1000000000*carbon_tax_rate_green)/1000000000000
if> (emis_green*1000000000*carbon_tax_rate_green)/1000000000000 > 0

COMMENT> Total Carbon tax in greenland. 
IDENTITY> carbon_tax_brown
EQ> carbon_tax_brown= 0
if> (emis_brown*1000000000*carbon_tax_rate_brown)/1000000000000 <= 0
IDENTITY> carbon_tax_brown
EQ> carbon_tax_brown= (emis_brown*1000000000*carbon_tax_rate_brown)/1000000000000
if> (emis_brown*1000000000*carbon_tax_rate_brown)/1000000000000 > 0


COMMENT> Share of carbon tax going to export of tech (must sum to 1)
IDENTITY> carbon_tax_x_brown
EQ> carbon_tax_x_brown = share_x_brown * carbon_tax_brown

COMMENT> Share of carbon tax going to green tech development (must sum to 1)
IDENTITY> carbon_tax_dev_brown
EQ> carbon_tax_dev_brown = share_dev_brown * carbon_tax_brown

COMMENT> Share of carbon tax going to green tech production (must sum to 1)
IDENTITY> carbon_tax_tech_brown
EQ> carbon_tax_tech_brown = share_tech_brown * carbon_tax_brown

COMMENT> Share of carbon tax going to export of tech (must sum to 1)
IDENTITY> carbon_tax_x_green
EQ> carbon_tax_x_green = share_x_green * carbon_tax_green

COMMENT> Share of carbon tax going to green tech development (must sum to 1)
IDENTITY> carbon_tax_dev_green
EQ> carbon_tax_dev_green = share_dev_green * carbon_tax_green

COMMENT> Share of carbon tax going to green tech production (must sum to 1)
IDENTITY> carbon_tax_tech_green
EQ> carbon_tax_tech_green = share_tech_green * carbon_tax_green



COMMENT> Samler det grønne forbrug i brown
IDENTITY> gov_gr_brown
EQ> gov_gr_brown = gov_gr_inv_brown + gov_gr_rd_brown + carbon_tax_x_brown

COMMENT> Samler totale forbrug der går til investeringer. 
IDENTITY> gov_tot_inv_brown
EQ> gov_tot_inv_brown = gov_gr_inv_brown + gov_con_brown

COMMENT> Samler det grønne forbrug i green
IDENTITY> gov_gr_green
EQ> gov_gr_green = gov_gr_inv_green + gov_gr_rd_green + carbon_tax_x_green

COMMENT> Samler totale forbrug der går til investeringer. 
IDENTITY> gov_tot_inv_green
EQ> gov_tot_inv_green = gov_gr_inv_green + gov_con_green



COMMENT> Channels through Carbon tax #######################################################


COMMENT> 
IDENTITY> beta_gr_brown
EQ> beta_gr_brown= beta_gr_brown*1
IF> date < 1990 
IDENTITY> beta_gr_brown
EQ> beta_gr_brown = TSLAG(beta_gr_brown,1)* (1- g_gr_beta_brown)
IF> date >= 1990


COMMENT> 
IDENTITY> beta_gr_green
EQ> beta_gr_green = beta_gr_green*1
IF> date < 1990 
IDENTITY> beta_gr_green
EQ> beta_gr_green = TSLAG(beta_gr_green,1)* (1- g_gr_beta_green)
IF> date >= 1990


COMMENT> Mangler: 
IDENTITY> x_gr_brown
EQ> x_gr_brown = (exp(-3.75+ eps_gr1*log(x_brown)))
IF> Narrowly_strong_PH  <= 0 
IDENTITY> x_gr_brown
EQ> x_gr_brown = exp(-2.25+ eps_gr1*log(x_brown) + 0.5*log(eta_gr_brown))
IF> Narrowly_strong_PH  > 0 & sens_4_low <= 0
IDENTITY> x_gr_brown
EQ> x_gr_brown = exp(-3.09 + eps_gr1*log(x_brown) + 0.22*log(eta_gr_brown)) 
IF> Narrowly_strong_PH  > 0 & sens_4_low > 0



COMMENT> 
IDENTITY> im_gr_brown
EQ> im_gr_brown = (exp(-3.75+ eps_gr1*log(im_brown)))



COMMENT> Nye kapital beholdninger ##########################################################

COMMENT> 
IDENTITY> inv_gr_im_green
EQ> inv_gr_im_green = im_gr_green

COMMENT> 
IDENTITY> inv_gr_im_brown
EQ> inv_gr_im_brown = im_gr_brown


COMMENT> 
IDENTITY> k_gr_im_green
EQ> k_gr_im_green = TSLAG(k_gr_im_green,1) + inv_gr_im_green - da_gr_im_green


COMMENT> Skulle man ændre dette til delta_brown? Da deres maskiner?
IDENTITY> da_gr_im_green
EQ> da_gr_im_green = delta_green* TSLAG(k_gr_im_green,1)


COMMENT> 
IDENTITY> k_gr_im_brown
EQ> k_gr_im_brown = TSLAG(k_gr_im_brown,1) + inv_gr_im_brown - da_gr_im_brown


COMMENT> 
IDENTITY> da_gr_im_brown
EQ> da_gr_im_brown = delta_brown* TSLAG(k_gr_im_brown,1)


COMMENT> SHOCK VARIABLES ##########################################


COMMENT> Shock variable
IDENTITY> carbon_tax_shock_green
EQ> carbon_tax_shock_green= carbon_tax_shock_green*1

COMMENT> Shock variable
IDENTITY> carbon_tax_shock_brown
EQ> carbon_tax_shock_brown= carbon_tax_shock_brown*1


COMMENT>
IDENTITY> share_x_brown
EQ> share_x_brown= 0/4




COMMENT> Shock variable
IDENTITY> share_dev_brown
EQ> share_dev_brown= 2/4


COMMENT> Så i baseline er denne ligmed 1
IDENTITY> share_tech_brown
EQ> share_tech_brown= 1 - (share_dev_brown + share_x_brown)


COMMENT> Updating import beta values ##########################################


COMMENT> 
IDENTITY> k_gr_im_new_brown
EQ> k_gr_im_new_brown= k_gr_im_brown - TSLAG(k_gr_im_brown,1)

COMMENT> 
IDENTITY> beta_im_gr_brown
EQ> beta_im_gr_brown = k_gr_im_new_brown/k_gr_im_brown*beta_gr_green + (k_gr_im_brown - k_gr_im_new_brown)/k_gr_im_brown*TSLAG(beta_im_gr_brown,1)


COMMENT> 
IDENTITY> eta_im_gr_brown
EQ> eta_im_gr_brown = k_gr_im_new_brown/k_gr_im_brown*eta_gr_green + (k_gr_im_brown - k_gr_im_new_brown)/k_gr_im_brown*TSLAG(eta_im_gr_brown,1)


COMMENT> 
IDENTITY> k_gr_im_new_green
EQ> k_gr_im_new_green= k_gr_im_green - TSLAG(k_gr_im_green,1)

COMMENT> 
IDENTITY> beta_im_gr_green
EQ> beta_im_gr_green = k_gr_im_new_green/k_gr_im_green*beta_gr_brown + (k_gr_im_green - k_gr_im_new_green)/k_gr_im_green*TSLAG(beta_im_gr_green,1)


COMMENT> 
IDENTITY> eta_im_gr_green
EQ> eta_im_gr_green = k_gr_im_new_green/k_gr_im_green*eta_gr_brown + (k_gr_im_green - k_gr_im_new_green)/k_gr_im_green*TSLAG(eta_im_gr_green,1)


COMMENT> 
IDENTITY> k_gr_new_brown
EQ> k_gr_new_brown= k_gr_brown - TSLAG(k_gr_brown,1)

COMMENT> 
IDENTITY> beta_avg_gr_brown
EQ> beta_avg_gr_brown = k_gr_new_brown/k_gr_brown* beta_gr_brown + imp_brown*((k_gr_brown - k_gr_new_brown)/k_gr_brown)*TSLAG(beta_avg_gr_brown,1) + (1-imp_brown)*((k_gr_brown - k_gr_new_brown)/k_gr_brown)*beta_gr_brown

COMMENT> 
IDENTITY> eta_avg_gr_brown
EQ> eta_avg_gr_brown = k_gr_new_brown/k_gr_brown* eta_gr_brown + imp_brown*((k_gr_brown - k_gr_new_brown)/k_gr_brown)*TSLAG(eta_avg_gr_brown,1) + (1-imp_brown)*((k_gr_brown - k_gr_new_brown)/k_gr_brown)*eta_gr_brown


COMMENT> 
IDENTITY> k_gr_new_green
EQ> k_gr_new_green= k_gr_green - TSLAG(k_gr_green,1)

COMMENT> 
IDENTITY> beta_avg_gr_green
EQ> beta_avg_gr_green = k_gr_new_green/k_gr_green*beta_gr_green + imp_green*((k_gr_green - k_gr_new_green)/k_gr_green)*TSLAG(beta_avg_gr_green,1) + (1-imp_green)*((k_gr_green - k_gr_new_green)/k_gr_green)*beta_gr_green

COMMENT> 
IDENTITY> eta_avg_gr_green
EQ> eta_avg_gr_green = k_gr_new_green/k_gr_green*eta_gr_green + imp_green*((k_gr_green - k_gr_new_green)/k_gr_green)*TSLAG(eta_avg_gr_green,1) + (1-imp_green)*((k_gr_green - k_gr_new_green)/k_gr_green)*eta_gr_green


COMMENT> 
IDENTITY> imp_green
EQ> imp_green= 0.85

COMMENT> 
IDENTITY> imp_brown
EQ> imp_brown= 0.85



COMMENT> Investeringer i de tre kanaler ###################################

COMMENT>  
IDENTITY> gov_gr_rd_brown
EQ> gov_gr_rd_brown = (gov_gr_ob*gov_ob_dk_s)*0.05 + carbon_tax_dev_brown



COMMENT>  
IDENTITY> gov_gr_rd_green
EQ> gov_gr_rd_green = (gov_gr_ob*gov_ob_row_s)*0.05 + carbon_tax_dev_green



COMMENT> 
IDENTITY> gov_gr_inv_brown
EQ> gov_gr_inv_brown = (gov_gr_ob*gov_ob_dk_s)*0.95 + carbon_tax_tech_brown


COMMENT> 
IDENTITY> gov_gr_inv_green
EQ> gov_gr_inv_green = (gov_gr_ob*gov_ob_row_s)*0.95 + carbon_tax_tech_green



IDENTITY> Strong_PH
EQ> Strong_PH = Strong_PH*1


IDENTITY> Weak_PH
EQ> Weak_PH = Weak_PH*1


IDENTITY> Narrowly_strong_PH
EQ> Narrowly_strong_PH = Narrowly_strong_PH*1


IDENTITY> sens_4_low
EQ> sens_4_low = sens_4_low*1


IDENTITY> sens_5_high
EQ> sens_5_high = sens_5_high*1



END"
```




## update txt


```{r}
S_model=LOAD_MODEL(modelText = S_model.txt)
```


# Data and initial values.


We create a list to store the variables within

```{r}
S_modelData=list( )
```


## Import data

```{r}

### Greenland = Denmark 
### Brownland = ROW


library(readxl)
library(tidyverse)
library(bimets)
Data_virk_tak <- read_excel("Data virk tak.xlsx", 
    col_types = c("skip", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric")) 

data= Data_virk_tak %>% 
  rename(y_bil = `GDP (constant 2015 US$)`,
         y_bil_dk = `Danish GDP (2015 US$) (World bank)`,
         gcons_bil= `Final consumption expenditure (constant 2015 US$)` ,
         gcons_bil_dk= `Danish Final consumption expenditure (2015 US$) World bank` ,
         inv_bil = `Gross fixed capital formation (constant 2015 US$)`,
         inv_bil_dk = `Danish Gross fixed capital formation (2015 US$) World bank`,
         theta_ob = `Tax revenue (% of GDP)`,
         theta_ob_dk = `Danish Tax revenue (% of GDP) World Bank`,
         kappa_ob = `Capital stock, total, % of GDP, IMF`,
         #kappa_ob_dk = `Danish Gross Capital stock, % of GDP, IMF`,
         gov_bil = `General government final consumption expenditure (constant 2015 US$)`,
         gov_bil_dk = `Danish General government final consumption expenditure (2015 US$) World bank`,
         emis_ob = `Annual CO2 emiss, Ritchie and Roser 2017`,
         emis_ob_dk_un_adj = `Danish Annual CO2 emiss, Ritchie and Roser 2017`,
         temp_at_ob = `NASA Temperature Anomaly`
        )



data_ts=lapply(data, function(t) TIMESERIES(t, START = c(1960,1)))

attach(data_ts)

inv_bil_dk_t= (inv_bil/y_bil)*y_bil_dk

### Put variables inside S_model

S_modelData$emis_ob = emis_ob
emis_ob_dk= emis_ob_dk_un_adj/1000000000;S_modelData$emis_ob_dk = emis_ob_dk
S_modelData$temp_at_ob = temp_at_ob

#ADJUST UNIT OF MEASURE OF TIME SERIES
y_ob=y_bil/1000000000000; S_modelData$y_ob = y_ob
y_ob_dk=y_bil_dk/1000000000000; S_modelData$y_ob_dk = y_ob_dk
gcons_ob=gcons_bil/1000000000000; S_modelData$gcons_ob = gcons_ob
gcons_ob_dk=gcons_bil_dk/1000000000000; S_modelData$gcons_ob_dk = gcons_ob_dk
inv_ob=inv_bil/1000000000000; S_modelData$inv_ob = inv_ob
inv_ob_dk=inv_bil_dk_t/1000000000000; S_modelData$inv_ob_dk = inv_ob_dk
gov_ob=gov_bil/1000000000000; S_modelData$gov_ob = gov_ob
gov_ob_dk=gov_bil_dk/1000000000000; S_modelData$gov_ob_dk = gov_ob_dk
cint_ob = inv_ob+gcons_ob+gov_ob-y_ob; S_modelData$cint_ob = cint_ob
cint_ob_dk = inv_ob_dk+gcons_ob_dk+gov_ob_dk-y_ob_dk; S_modelData$cint_ob_dk = cint_ob_dk
cons_ob = gcons_ob-cint_ob ; S_modelData$cons_ob = cons_ob
cons_ob_dk = gcons_ob_dk-cint_ob_dk ; S_modelData$cons_ob_dk = cons_ob_dk
k_ob = y_ob*kappa_ob/100; S_modelData$k_ob = k_ob
k_ob_dk = y_ob_dk*kappa_ob/100; S_modelData$k_ob_dk = k_ob_dk
delta_ob = TIMESERIES(c(0.079,(inv_ob - TSDELTA(k_ob))/TSLAG(k_ob,1)), START = c(1960,1)) ; S_modelData$delta_ob = delta_ob 
delta_ob_dk = TIMESERIES(c(0.079,(inv_ob_dk - TSDELTA(k_ob_dk))/TSLAG(k_ob_dk,1)), START = c(1960,1)) ; S_modelData$delta_ob_dk = delta_ob_dk ## Kig på den her!!!!
yd_ob = y_ob*(1-(theta_ob/100)); S_modelData$yd_ob = yd_ob
yd_ob_dk = y_ob_dk*(1-(theta_ob_dk/100)); S_modelData$yd_ob_dk = yd_ob_dk
```




## Define shares

```{r}

date= TIMESERIES(c(seq(from=1960, to = 2060)), START= c(1960, 1)); S_modelData$date = date
# Denmark
y_ob_dk_s=y_ob_dk/y_ob ; S_modelData$y_ob_dk_s = y_ob_dk_s
gcons_ob_dk_s=gcons_ob_dk/gcons_ob ; S_modelData$gcons_ob_dk_s = gcons_ob_dk_s
inv_ob_dk_s=inv_ob_dk/inv_ob ; S_modelData$inv_ob_dk_s = inv_ob_dk_s
gov_ob_dk_s=gov_ob_dk/gov_ob ; S_modelData$gov_ob_dk_s = gov_ob_dk_s
k_ob_dk_s=k_ob_dk/k_ob ; S_modelData$k_ob_dk_s = k_ob_dk_s
emis_ob_dk_s=emis_ob_dk/emis_ob ; S_modelData$emis_ob_dk_s = emis_ob_dk_s
cons_ob_dk_s=cons_ob_dk/cons_ob ; S_modelData$cons_ob_dk_s = cons_ob_dk_s

y_ob_dk_s = ifelse(date<2018,y_ob_dk_s,mean(window(y_ob_dk_s, start=2002,end= 2017)));S_modelData$y_ob_dk_s = y_ob_dk_s
gcons_ob_dk_s = ifelse(date<2018,gcons_ob_dk_s,mean(window(gcons_ob_dk_s, start=2002,end= 2017)));S_modelData$gcons_ob_dk_s = gcons_ob_dk_s
inv_ob_dk_s = ifelse(date<2018,inv_ob_dk_s,mean(window(inv_ob_dk_s, start=2002,end= 2017)));S_modelData$inv_ob_dk_s = inv_ob_dk_s
gov_ob_dk_s = ifelse(date<2018,gov_ob_dk_s,mean(window(gov_ob_dk_s, start=2002,end= 2017)));S_modelData$gov_ob_dk_s = gov_ob_dk_s
k_ob_dk_s = ifelse(date<2018,k_ob_dk_s,mean(window(k_ob_dk_s, start=2002,end= 2017)));S_modelData$k_ob_dk_s = k_ob_dk_s
emis_ob_dk_s = ifelse(date<2018,emis_ob_dk_s,mean(window(emis_ob_dk_s, start=2002,end= 2017)));S_modelData$emis_ob_dk_s = emis_ob_dk_s
cons_ob_dk_s = ifelse(date<2018,cons_ob_dk_s,mean(window(cons_ob_dk_s, start=2002,end= 2017)));S_modelData$cons_ob_dk_s = cons_ob_dk_s

# ROW
y_ob_row_s=1-y_ob_dk_s ; S_modelData$y_ob_row_s = y_ob_row_s
gcons_ob_row_s=1-gcons_ob_dk_s ; S_modelData$gcons_ob_row_s = gcons_ob_row_s
inv_ob_row_s=1-inv_ob_dk_s ; S_modelData$inv_ob_row_s = inv_ob_row_s
gov_ob_row_s=1-gov_ob_dk_s ; S_modelData$gov_ob_row_s = gov_ob_row_s
k_ob_row_s=1-k_ob_dk_s ; S_modelData$k_ob_row_s = k_ob_row_s
emis_ob_row_s=1-emis_ob_dk_s ; S_modelData$emis_ob_row_s = emis_ob_row_s
cons_ob_row_s=1-cons_ob_dk_s ; S_modelData$cons_ob_row_s = cons_ob_row_s

y_ob_row_s = ifelse(date<2018,y_ob_row_s,mean(window(y_ob_row_s, start=2002,end= 2017)));S_modelData$y_ob_row_s = y_ob_row_s
gcons_ob_row_s = ifelse(date<2018,gcons_ob_row_s,mean(window(gcons_ob_row_s, start=2002,end= 2017)));S_modelData$gcons_ob_row_s = gcons_ob_row_s
inv_ob_row_s = ifelse(date<2018,inv_ob_row_s,mean(window(inv_ob_row_s, start=2002,end= 2017)));S_modelData$inv_ob_row_s = inv_ob_row_s
gov_ob_row_s = ifelse(date<2018,gov_ob_row_s,mean(window(gov_ob_row_s, start=2002,end= 2017)));S_modelData$gov_ob_row_s = gov_ob_row_s
k_ob_row_s = ifelse(date<2018,k_ob_row_s,mean(window(k_ob_row_s, start=2002,end= 2017)));S_modelData$k_ob_row_s = k_ob_row_s
emis_ob_row_s = ifelse(date<2018,emis_ob_row_s,mean(window(emis_ob_row_s, start=2002,end= 2017)));S_modelData$emis_ob_row_s = emis_ob_row_s
cons_ob_row_s = ifelse(date<2018,cons_ob_row_s,mean(window(cons_ob_row_s, start=2002,end= 2017)));S_modelData$cons_ob_row_s = cons_ob_row_s

```






## Define data


```{r}
# Trend and date variables

trend= TIMESERIES(c(seq(from=0, to = 100)), START= c(1960, 1)); S_modelData$trend = trend

# DEFINE EXCHANGE RATE MECHANISM
er_regime1 = TIMESERIES(rep(1,101), START= c(1960,1)); S_modelData$er_regime1 = er_regime1 #Note: 0 = floating exchange rate; 1 = fixed exchange rate 

############################################### Starting values for coefficients and related variables ####################################################
omega_brown = TIMESERIES(rep(0.62,101), START = c(1960, 1)); S_modelData$omega_brown = omega_brown  
omega_green = TIMESERIES(rep(0.62,101), START = c(1960, 1)); S_modelData$omega_green = omega_green
cons_brown = cons_ob*cons_ob_dk_s; S_modelData$cons_brown = cons_brown ## Ændret share, også i model
cons_green = cons_ob*cons_ob_row_s; S_modelData$cons_green = cons_green ## Ændret share, også i model
cons_w_brown = cons_brown*omega_brown ; S_modelData$cons_w_brown = cons_w_brown
cons_r_brown = cons_brown - cons_w_brown; S_modelData$cons_r_brown = cons_r_brown
cons_w_green = cons_green*omega_green; S_modelData$cons_w_green = cons_w_green
cons_r_green = cons_green - cons_w_green; S_modelData$cons_r_green = cons_r_green
h_brown_r_h= ifelse(er_regime1 == 0,1,10*cons_ob_dk_s); S_modelData$h_brown_r_h = h_brown_r_h  #Ændre de 5 til 10*share af cons?
h_brown_w_h = TIMESERIES(rep(0,101), START = c(1960, 1)); S_modelData$h_brown_w_h = h_brown_w_h
h_brown_h = h_brown_r_h + h_brown_w_h ; S_modelData$h_brown_h = h_brown_h 
h_green_r_h= ifelse(er_regime1==0,0,10*cons_ob_row_s) ; S_modelData$h_green_r_h = h_green_r_h #Ændre de 5 til 10*share af cons?
h_green_w_h= TIMESERIES(rep(0,101), START = c(1960, 1))  ; S_modelData$h_green_w_h = h_green_w_h
h_green_h = h_green_r_h + h_green_w_h; S_modelData$h_green_h = h_green_h
h_brown_s = ifelse(er_regime1 == 0,h_brown_h,10*cons_ob_dk_s); S_modelData$h_brown_s = h_brown_s #Ændre de 5 til 10*share af cons?
h_green_s = ifelse(er_regime1 == 0,h_green_h,10*cons_ob_row_s); S_modelData$h_green_s = h_green_s #Ændre de 5 til 10*share af cons?
or_brown= ifelse(er_regime1==0,0,10*cons_ob_dk_s); S_modelData$or_brown = or_brown # Ændre de 5 til 10*share af cons?
or_green= ifelse(er_regime1==0,0,10*cons_ob_row_s) ; S_modelData$or_green = or_green # Ændre de 5 til 10*share af cons?
a_s_brown= TIMESERIES(rep(0,101), START = c(1960, 1))  ; S_modelData$a_s_brown = a_s_brown
a_s_green= TIMESERIES(rep(0,101), START = c(1960, 1)) ; S_modelData$a_s_green = a_s_green
v_w_brown= TIMESERIES(rep(0,101), START = c(1960, 1)) ; S_modelData$v_w_brown = v_w_brown
v_w_green= TIMESERIES(rep(0,101), START = c(1960, 1)) ; S_modelData$v_w_green = v_w_green
v_r_brown = ifelse(er_regime1==0,0,10*cons_ob_dk_s); S_modelData$v_r_brown = v_r_brown # Ændre de 5 til 10*share af cons?
v_r_green = ifelse(er_regime1==0,0,10*cons_ob_row_s) ; S_modelData$v_r_green = v_r_green # Ændre de 5 til 10*share af cons?
theta_brown = ifelse(date<2018,theta_ob_dk/100,mean(window(theta_ob_dk/100, start=2002,end= 2017)));S_modelData$theta_brown = theta_brown#opdateret!
theta_green = ifelse(date<2018,theta_ob/100,mean(window(theta_ob/100, start=2002, end= 2017))); S_modelData$theta_green = theta_green
k_gr_brown= TIMESERIES(rep(0,101), START = c(1960, 1)); S_modelData$k_gr_brown = k_gr_brown
k_gr_green= TIMESERIES(rep(0,101), START = c(1960, 1)); S_modelData$k_gr_green = k_gr_green
k_con_brown = k_ob*k_ob_dk_s; S_modelData$k_con_brown = k_con_brown # Ændret share, skal vist ikke ændres i model
k_con_green = k_ob*k_ob_row_s; S_modelData$k_con_green = k_con_green # Ændret share, skal vist ikke ændres i model
k_brown = k_con_brown + k_gr_brown; S_modelData$k_brown = k_brown
k_green = k_con_green + k_gr_green; S_modelData$k_green = k_green
delta0_brown = ifelse(date<2018,delta_ob,mean(window(delta_ob, start=2002, end= 2017))); S_modelData$delta0_brown = delta0_brown
delta0_green = ifelse(date<2018,delta_ob,mean(window(delta_ob, start=2002, end= 2017))); S_modelData$delta0_green = delta0_green
delta_brown = delta0_brown; S_modelData$delta_brown = delta_brown
delta_green = delta0_green; S_modelData$delta_green = delta_green
ad_k_green = TIMESERIES(rep(0.75,101), START = c(1960, 1)) ; S_modelData$ad_k_green = ad_k_green
ad_k_brown = TIMESERIES(rep(0.75,101), START = c(1960, 1)); S_modelData$ad_k_brown = ad_k_brown
kappa = ifelse(date<2018,kappa_ob,mean(window(kappa_ob, start=2002, end= 2017))); S_modelData$kappa = kappa

gov_gr_ob= ifelse(window(date,end=2017)<1990,0,0.2*gov_ob); S_modelData$gov_gr_ob = gov_gr_ob #Starter efter oliekrisen i 1973!

gov_gr_brown = gov_gr_ob*gov_ob_dk_s; S_modelData$gov_gr_brown = gov_gr_brown # Opdateret
gov_gr_green = gov_gr_ob*gov_ob_row_s; S_modelData$gov_gr_green = gov_gr_green #Opdateret

gov_con_brown_init = (gov_ob*gov_ob_dk_s) - gov_gr_brown; S_modelData$gov_con_brown_init = gov_con_brown_init # Ændret share, Ændret share i model
gov_con_green_init = (gov_ob*gov_ob_row_s) - gov_gr_green; S_modelData$gov_con_green_init = gov_con_green_init # Ændret share, Ændret share i model.
gov_con_brown = gov_con_brown_init; S_modelData$gov_con_brown = gov_con_brown
gov_con_green = gov_con_green_init; S_modelData$gov_con_green = gov_con_green
gov_tot_brown = gov_ob*gov_ob_dk_s; S_modelData$gov_tot_brown = gov_tot_brown # Ændret Share
gov_tot_green = gov_ob*gov_ob_row_s; S_modelData$gov_tot_green = gov_tot_green # Ændret share
gov = gov_ob; S_modelData$gov = gov

emis_l = TIMESERIES(rep(4,101), START = c(1960, 1)); S_modelData$emis_l = emis_l
g_land = ifelse(date<2015,0,0.044)  ; S_modelData$g_land = g_land
emis_brown = (emis_ob-emis_l)*emis_ob_dk_s; S_modelData$emis_brown = emis_brown ## Ændret share, men ved ik om der skal være forskellige "emis_l", Ændret share i model!
emis_green = (emis_ob-emis_l)*emis_ob_row_s; S_modelData$emis_green = emis_green ## Ændret share, men ved ik om der skal være forskellige "emis_l" , IKKE ændret share i model!
inv_brown = inv_ob*inv_ob_dk_s; S_modelData$inv_brown = inv_brown #Ændret shares, skal vist ikke ændres i model!
inv_green = inv_ob*inv_ob_row_s; S_modelData$inv_green = inv_green # Ændret shares, Skal vist ikke ændres i model!
inv = inv_ob; S_modelData$inv = inv
y_brown = y_ob*y_ob_dk_s; S_modelData$y_brown = y_brown # ændret shares, skal vist ikke ændres i model?
y_green = y_ob*y_ob_row_s; S_modelData$y_green = y_green # ændret shares, Skal vist ikke ændres i model?
y = y_ob; S_modelData$y = y
v = y_ob; S_modelData$v = v
cons = cons_ob; S_modelData$cons = cons
yd = yd_ob; S_modelData$yd = yd
alpha1_w_brown = TIMESERIES(rep(0.890919,101), START = c(1960, 1)); S_modelData$alpha1_w_brown = alpha1_w_brown
alpha1_r_brown = TIMESERIES(rep(0.490919,101), START = c(1960, 1)) ; S_modelData$alpha1_r_brown = alpha1_r_brown# ændert
alpha1_w_green = TIMESERIES(rep(0.790919,101), START = c(1960, 1)) ; S_modelData$alpha1_w_green = alpha1_w_green
alpha1_r_green = TIMESERIES(rep(0.490919,101), START = c(1960, 1)) ; S_modelData$alpha1_r_green = alpha1_r_green# ændert
alpha2_w_brown = TIMESERIES(rep(0.030834,101), START = c(1960, 1)) ; S_modelData$alpha2_w_brown = alpha2_w_brown
alpha2_r_brown = TIMESERIES(rep(0.020834,101), START = c(1960, 1)) ; S_modelData$alpha2_r_brown = alpha2_r_brown
alpha2_w_green = TIMESERIES(rep(0.020834,101), START = c(1960, 1)) ; S_modelData$alpha2_w_green = alpha2_w_green
alpha2_r_green = TIMESERIES(rep(0.020834,101), START = c(1960, 1)) ; S_modelData$alpha2_r_green = alpha2_r_green
yd_r_brown = ((yd_ob_dk)*(1-0.62)); S_modelData$yd_r_brown = yd_r_brown # Hvorfor er det ikke yd_ob/2??, ændret nu men ved ik om rigtigt
yd_w_brown = ((yd_ob_dk)*0.62); S_modelData$yd_w_brown = yd_w_brown # Hvorfor er det ikke yd_ob/2??, ændret nu men ved ik om rigtigt
yd_r_green = ((yd_ob-yd_ob_dk)*(1-0.62)); S_modelData$yd_r_green = yd_r_green # Hvorfor er det ikke yd_ob/2??, ændret nu men ved ik om rigtigt
yd_w_green = ((yd_ob-yd_ob_dk)*0.62); S_modelData$yd_w_green = yd_w_green # Hvorfor er det ikke yd_ob/2??, ændret nu men ved ik om rigtigt
emis = emis_ob; S_modelData$emis = emis


########################################## Starting values for parameters ########################################################
eps0 = TIMESERIES(rep(-6.1,101), START = c(1960, 1)) ; S_modelData$eps0 = eps0 ## Skal tilpases
eps1 = TIMESERIES(rep(0.5,101), START = c(1960, 1)) ; S_modelData$eps1 = eps1
eps2 = TIMESERIES(rep(0.92,101), START = c(1960, 1)) ; S_modelData$eps2 = eps2 ## Skal tilpasses
mu0 = TIMESERIES(rep(-0.45,101), START = c(1960, 1)) ; S_modelData$mu0 = mu0 #Skal tilpasses
mu1 = TIMESERIES(rep(0.5,101), START = c(1960, 1)) ; S_modelData$mu1 = mu1
mu2 = TIMESERIES(rep(1.45,101), START = c(1960, 1)) ; S_modelData$mu2 = mu2 ## Skal tilpasses
mu2_par = TIMESERIES(rep(0,101), START = c(1960, 1)) ; S_modelData$mu2_par = mu2_par
lambda10 = TIMESERIES(rep(0.2,101), START = c(1960, 1))    ; S_modelData$lambda10 = lambda10 #Ændret!
lambda11 = TIMESERIES(rep(1,101), START = c(1960, 1))  ; S_modelData$lambda11 = lambda11 
lambda12 = TIMESERIES(rep(1,101), START = c(1960, 1)) ; S_modelData$lambda12 = lambda12
lambda13 = TIMESERIES(rep(0,101), START = c(1960, 1))  ; S_modelData$lambda13 = lambda13
lambda14 = TIMESERIES(rep(0,101), START = c(1960, 1)) ; S_modelData$lambda14 = lambda14 
lambda20 = TIMESERIES(rep(0.30,101), START = c(1960, 1)) ; S_modelData$lambda20 = lambda20 #Ændret!
lambda21 = TIMESERIES(rep(1,101), START = c(1960, 1)) ; S_modelData$lambda21 = lambda21
lambda22 = TIMESERIES(rep(1,101), START = c(1960, 1)) ; S_modelData$lambda22 = lambda22
lambda23 = TIMESERIES(rep(0,101), START = c(1960, 1))  ; S_modelData$lambda23 = lambda23
lambda24 = TIMESERIES(rep(0,101), START = c(1960, 1))  ; S_modelData$lambda24 = lambda24
lambda40 = TIMESERIES(rep(0.40,101), START = c(1960, 1))   ; S_modelData$lambda40 = lambda40 # Ændre!
lambda41 = TIMESERIES(rep(1,101), START = c(1960, 1)) ; S_modelData$lambda41 = lambda41
lambda42 = TIMESERIES(rep(1,101), START = c(1960, 1)) ; S_modelData$lambda42 = lambda42
lambda43 = TIMESERIES(rep(0,101), START = c(1960, 1))   ; S_modelData$lambda43 = lambda43
lambda44 = TIMESERIES(rep(0,101), START = c(1960, 1))  ; S_modelData$lambda44 = lambda44
lambda50 = TIMESERIES(rep(0.0008,101), START = c(1960, 1))   ; S_modelData$lambda50 = lambda50 # Ændre
lambda51 = TIMESERIES(rep(1,101), START = c(1960, 1)) ; S_modelData$lambda51 = lambda51
lambda52 = TIMESERIES(rep(1,101), START = c(1960, 1)) ; S_modelData$lambda52 = lambda52
lambda53 = TIMESERIES(rep(0,101), START = c(1960, 1))  ; S_modelData$lambda53 = lambda53
lambda54 = TIMESERIES(rep(0,101), START = c(1960, 1))  ; S_modelData$lambda54 = lambda54
lambda70 = TIMESERIES(rep(0.05,101), START = c(1960, 1))   ; S_modelData$lambda70 = lambda70 #ændret!
lambda71 = TIMESERIES(rep(0,101), START = c(1960, 1))  ; S_modelData$lambda71 = lambda71
lambda72 = TIMESERIES(rep(0,101), START = c(1960, 1))  ; S_modelData$lambda72 = lambda72
lambda73 = TIMESERIES(rep(0.01,101), START = c(1960, 1))  ; S_modelData$lambda73 = lambda73
lambda74 = TIMESERIES(rep(0.01,101), START = c(1960, 1))  ; S_modelData$lambda74 = lambda74
lambda80 = TIMESERIES(rep(0.0001,101), START = c(1960, 1)) ; S_modelData$lambda80 = lambda80 #Ændret!
lambda81 = TIMESERIES(rep(0,101), START = c(1960, 1))  ; S_modelData$lambda81 = lambda81
lambda82 = TIMESERIES(rep(0,101), START = c(1960, 1))  ; S_modelData$lambda82 = lambda82
lambda83 = TIMESERIES(rep(0.01,101), START = c(1960, 1))  ; S_modelData$lambda83 = lambda83
lambda84 = TIMESERIES(rep(0.01,101), START = c(1960,1))  ; S_modelData$lambda84 = lambda84
lambda90 = TIMESERIES(rep(0.05,101), START = c(1960,1))  ; S_modelData$lambda90 = lambda90
lambda91 = TIMESERIES(rep(0,101), START = c(1960,1))  ; S_modelData$lambda91 = lambda91
lambda92 = TIMESERIES(rep(0,101), START = c(1960,1))  ; S_modelData$lambda92 = lambda92
lambda93 = TIMESERIES(rep(0.01,101), START = c(1960,1))  ; S_modelData$lambda93 = lambda93
lambda94 = TIMESERIES(rep(0.01,101), START = c(1960,1))  ; S_modelData$lambda94 = lambda94
lambda100 = TIMESERIES(rep(0.1,101), START = c(1960,1))   ; S_modelData$lambda100 = lambda100 # Ændre!
lambda101 = TIMESERIES(rep(0,101), START = c(1960,1))  ; S_modelData$lambda101 = lambda101
lambda102 = TIMESERIES(rep(0,101), START = c(1960,1))  ; S_modelData$lambda102 = lambda102
lambda103 = TIMESERIES(rep(0.01,101), START = c(1960,1))  ; S_modelData$lambda103 = lambda103
lambda104 = TIMESERIES(rep(0.01,101), START = c(1960,1))  ; S_modelData$lambda104 = lambda104
xi_green = TIMESERIES(rep(0.01,101), START = c(1960,1))   ; S_modelData$xi_green = xi_green
xi_brown = TIMESERIES(rep(0.01,101), START = c(1960,1))   ; S_modelData$xi_brown = xi_brown
e_brown_real_s = TIMESERIES(rep(1,101), START = c(1960,1)) ; S_modelData$e_brown_real_s = e_brown_real_s
e_green_real_s = TIMESERIES(rep(1,101), START = c(1960,1)) ; S_modelData$e_green_real_s = e_green_real_s
p_e_brown = TIMESERIES(rep(1,101), START = c(1960,1)) ; S_modelData$p_e_brown = p_e_brown
p_e_green = TIMESERIES(rep(1,101), START = c(1960,1)) ; S_modelData$p_e_green = p_e_green

###
gamma2_green = TIMESERIES(rep(0.005,101), START = c(1960,1)) ; S_modelData$gamma2_green = gamma2_green
gamma2_brown = TIMESERIES(rep(0.005,101), START = c(1960,1)) ; S_modelData$gamma2_brown = gamma2_brown
gamma1_green = TIMESERIES(rep(1.008213,101), START = c(1960,1)) ; S_modelData$gamma1_green = gamma1_green
gamma1_brown = TIMESERIES(rep(1.008213,101), START = c(1960,1)) ; S_modelData$gamma1_brown = gamma1_brown
gamma0_green = TIMESERIES(0.086544* inv_ob_row_s, START = c(1960,1)) ; S_modelData$gamma0_green = gamma0_green # Skal tilpasses!
gamma0_brown = TIMESERIES(0.086544* inv_ob_dk_s, START = c(1960,1)) ; S_modelData$gamma0_brown = gamma0_brown # Skal tilpasses!
chi1_brown = TIMESERIES(rep(0.2,101), START = c(1960,1))  ; S_modelData$chi1_brown = chi1_brown
chi1_green = TIMESERIES(rep(0.2,101), START = c(1960,1)) ; S_modelData$chi1_green = chi1_green
ret_brown =  TIMESERIES(rep(0.02,101), START = c(1960,1))  ; S_modelData$ret_brown = ret_brown
ret_green = TIMESERIES(rep(0.02,101), START = c(1960,1)); S_modelData$ret_green = ret_green
depsh_brown = TIMESERIES(rep(0.7,101), START = c(1960,1)) ; S_modelData$depsh_brown = depsh_brown
depsh_green = TIMESERIES(rep(0.7,101), START = c(1960,1)) ; S_modelData$depsh_green = depsh_green
chi2_brown = TIMESERIES(rep(0.02,101), START = c(1960,1))  ; S_modelData$chi2_brown = chi2_brown
chi2_green = TIMESERIES(rep(0.02,101), START = c(1960,1))  ; S_modelData$chi2_green = chi2_green
chi3_brown = TIMESERIES(rep(60*mean(window(emis_ob_dk_s, start= 2017)), 101),START = c(1960,1)); S_modelData$chi3_brown = chi3_brown #Ændret!
chi3_green = TIMESERIES(rep(60*mean(window(emis_ob_row_s, start= 2017)), 101),START = c(1960,1))  ; S_modelData$chi3_green = chi3_green # Ændret!
chi4_green = TIMESERIES(rep(1,101), START = c(1960,1))  ; S_modelData$chi4_green = chi4_green
pi_dy_green = TIMESERIES(rep(0.00555,101), START = c(1960,1))  ; S_modelData$pi_dy_green = pi_dy_green
pi_dy_brown = TIMESERIES(rep(0.00555,101), START = c(1960,1))  ; S_modelData$pi_dy_brown = pi_dy_brown

#Coefficients for ecological variables
beta_gr_brown = TIMESERIES(rep(0.045154 - 0.01,101), START = c(1960,1)); S_modelData$beta_gr_brown = beta_gr_brown #CO2 intensity of green capital in Brownland (Gt/Ej)  
beta_gr_green = TIMESERIES(rep(0.045154 - 0.01,101), START = c(1960,1)); S_modelData$beta_gr_green = beta_gr_green #CO2 intensity of green capital in Greenland (Gt/Ej)
beta_con_brown = TIMESERIES(rep(0.045154 + 0.01,101), START = c(1960,1)); S_modelData$beta_con_brown = beta_con_brown #CO2 intensity of conventional capital in Brownland (Gt/Ej)
beta_con_green = TIMESERIES(rep(0.045154 + 0.01,101), START = c(1960,1)); S_modelData$beta_con_green = beta_con_green #CO2 intensity of conventional capital in Greenland (Gt/Ej)
g_gr_inv_brown = ifelse(date<1990,0,0.015); S_modelData$g_gr_inv_brown = g_gr_inv_brown ##Rate of increase in green investments 
g_gr_inv_green = ifelse(date<1990,0,0.0075); S_modelData$g_gr_inv_green = g_gr_inv_green ##Rate of increase in green investments 

g_gr_beta_brown = ifelse(date<1990,0,0.03); S_modelData$g_gr_beta_brown = g_gr_beta_brown ##Rate of increase in green c02 intensity
g_gr_beta_green = ifelse(date<1990,0,0.015); S_modelData$g_gr_beta_green = g_gr_beta_green##Rate of increase in green c02 intensity

beta_brown0 = ifelse(date<2020,(4.5*emis_ob_dk_s - 0), (4.5*emis_ob_dk_s + 0)); S_modelData$beta_brown0 = beta_brown0 #Initial or autonomous value of CO2 emissions in Brownland (falling after 2020) 

beta_green0 = ifelse(date<2020,(4.5*emis_ob_row_s + 0), (4.5*emis_ob_row_s - 0)); S_modelData$beta_green0 = beta_green0 #Initial or autonomous value of CO2 emissions in Greenland (falling after 2020) 6.904820 før

################################################# Starting values for variables and parameter values for the ecosystem ####################################

mu_gr_brown = TIMESERIES(rep(0.71,101), START = c(1960,1)); S_modelData$mu_gr_brown = mu_gr_brown ##Material intensity of green capital in Brownland (Kg/USD) 
mu_gr_green = TIMESERIES(rep(0.71,101), START = c(1960,1)); S_modelData$mu_gr_green = mu_gr_green ##Material intensity of green capital in Greenland (Kg/USD)
mu_con_brown = TIMESERIES(rep(0.86,101), START = c(1960,1)); S_modelData$mu_con_brown = mu_con_brown #Material intensity of conventional capital in Brownland (Kg/USD)
mu_con_green = TIMESERIES(rep(0.86,101), START = c(1960,1)); S_modelData$mu_con_green = mu_con_green #Material intensity of conventional capital in Greenland (Kg/USD)
epsilon_gr_brown = TIMESERIES(rep(3.65,101), START = c(1960,1)); S_modelData$epsilon_gr_brown = epsilon_gr_brown #Energy intensity of green capital in Brownland (Ej/USD)
epsilon_gr_green = TIMESERIES(rep(7.95,101), START = c(1960,1)); S_modelData$epsilon_gr_green = epsilon_gr_green #Energy intensity of green capital in Greenland (Ej/USD)
epsilon_con_brown = TIMESERIES(rep(4.65,101), START = c(1960,1)); S_modelData$epsilon_con_brown = epsilon_con_brown #Energy intensity of conventional capital in Brownland (Ej/USD)
epsilon_con_green = TIMESERIES(rep(9.95,101), START = c(1960,1)); S_modelData$epsilon_con_green = epsilon_con_green #Energy intensity of conventional capital in Greenland (Ej/USD)

im_brown = TIMESERIES(rep(0,101), START = c(1960,1)) ; S_modelData$im_brown = im_brown#Initial value of Brownland import
im_green = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$im_green = im_green #Initial value of Greenland import
x_brown = im_green; S_modelData$x_brown = x_brown #Initial value of Brownland export
x_green = im_brown; S_modelData$x_green = x_green #Initial value of Greenland export
rho_brown = TIMESERIES(rep(0.2,101), START = c(1960,1)); S_modelData$rho_brown = rho_brown #Recycling rate in Brownland
rho_green = TIMESERIES(rep(0.2,101), START = c(1960,1)); S_modelData$rho_green = rho_green #Recycling rate in Greenland

sigma_m_brown = TIMESERIES(rep(0.00034,101), START = c(1960,1)); S_modelData$sigma_m_brown = sigma_m_brown #Conversion rate of material resources into reserves in Brownland  
sigma_m_green = TIMESERIES(rep(0.00034,101), START = c(1960,1)); S_modelData$sigma_m_green = sigma_m_green #Conversion rate of material resources into reserves in Greenland
sigma_e_brown = TIMESERIES(rep(0.00177,101), START = c(1960,1)); S_modelData$sigma_e_brown = sigma_e_brown #Conversion rate of non-renewable energy resources into reserves in Brownland  
sigma_e_green = TIMESERIES(rep(0.00177,101), START = c(1960,1)); S_modelData$sigma_e_green = sigma_e_green #Conversion rate of non-renewable energy resources into reserves in Greenland
  

k_se_brown = TIMESERIES(rep(0,101), START = c(1960,1)) ; S_modelData$k_se_brown = k_se_brown#Initial value of socio-economic stock of Brownland (Gt)   
k_se_green = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$k_se_green = k_se_green #Initial value of socio-economic stock of Greenland (Gt)
car = TIMESERIES(rep(3.67,101), START = c(1960,1)); S_modelData$car = car #Coefficient converting Gt of carbon into Gt of CO2  
delta11 = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$delta11 = delta11 #Initial value of sensitivity of capital depreciation rate of Brownland firms to matter depletion 
delta12 = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$delta12 = delta12 #Initial value of sensitivity of capital depreciation rate of Brownland firms to energy depletion
delta13 = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$delta13 = delta13 #Initial value of sensitivity of capital depreciation rate of Brownland firms to climate change
delta21 = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$delta21 = delta21 #Initial value of sensitivity of capital depreciation rate of Greenland firms to matter depletion
delta22 = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$delta22 = delta22 #Initial value of sensitivity of capital depreciation rate of Greenland firms to energy depletion
delta23 = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$delta23 = delta23 #Initial value of sensitivity of capital depreciation rate of Greenland firms to climate change
alpha11 = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$alpha11 = alpha11 #Initial value of sensitivity of propensity to consume of Brownland workers to matter depletion 
alpha12 = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$alpha12 = alpha12 #Initial value of sensitivity of propensity to consume of Brownland workers to energy depletion 
alpha13 = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$alpha13 = alpha13 #Initial value of sensitivity of propensity to consume of Brownland workers to climate change 
alpha21 = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$alpha21 = alpha21 #Initial value of sensitivity of propensity to consume of Greenland workers to matter depletion 
alpha22 = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$alpha22 = alpha22 #Initial value of sensitivity of propensity to consume of Greenland workers to energy depletion 
alpha23 = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$alpha23 = alpha23 #Initial value of sensitivity of propensity to consume of Greenland workers to climate change 
a_brown = TIMESERIES(rep(1.15,101), START = c(1960,1)); S_modelData$a_brown = a_brown #Product per unit of capital in Brownland  
a_green = TIMESERIES(rep(1.15,101), START = c(1960,1)); S_modelData$a_green = a_green #Product per unit of capital in Greenland 
iota_brown = TIMESERIES(rep(0.5,101), START = c(1960,1)); S_modelData$iota_brown = iota_brown #Sensitivity of price level in Brownland to output gap 
iota_green = TIMESERIES(rep(0.5,101), START = c(1960,1)); S_modelData$iota_green = iota_green #Sensitivity of price level in Greenland to output gap 
p_brown = TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$p_brown = p_brown #Initial value of price level in Brownland 
p_green = TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$p_green = p_green #Initial value of price level in Greenland 
eta_con_brown = TIMESERIES(rep(0.05,101), START = c(1960,1)); S_modelData$eta_con_brown = eta_con_brown #Share of renewable energy to total energy in Brownland, conventional capital 
eta_con_green = TIMESERIES(rep(0.05,101), START = c(1960,1)); S_modelData$eta_con_green = eta_con_green #Share of renewable energy to total energy in Greenland, conventional capital
eta_gr_brown = TIMESERIES(rep(0.05,101), START = c(1960,1)); S_modelData$eta_gr_brown = eta_gr_brown #Share of renewable energy to total energy in Brownland, green capital
eta_gr_green = TIMESERIES(rep(0.05,101), START = c(1960,1)); S_modelData$eta_gr_green = eta_gr_green #Share of renewable energy to total energy in Greenland, green capital
eta_brown = eta_con_brown; S_modelData$eta_brown = eta_brown #Share of renewable energy to total energy in Brownland, average 
eta_green = eta_con_green; S_modelData$eta_green = eta_green #Share of renewable energy to total energy in Greenland, average

################################# Starting values for exogenous variables for the open economy #####################################
r_brown = TIMESERIES(rep(0.03,101), START = c(1960,1)) ; S_modelData$r_brown = r_brown
r_green = TIMESERIES(rep(0.03,101), START = c(1960,1)) ; S_modelData$r_green = r_green
r_e_brown = r_brown; S_modelData$r_e_brown = r_e_brown
r_e_green = r_green; S_modelData$r_e_green = r_e_green
r_l_green = TIMESERIES(rep(0.035,101), START = c(1960,1)) ; S_modelData$r_l_green = r_l_green
r_l_brown = TIMESERIES(rep(0.035,101), START = c(1960,1)) ; S_modelData$r_l_brown = r_l_brown

####################################### Starting values for endogenous variables with lag for the open economy ###########################################
y_tr_brown = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$y_tr_brown = y_tr_brown
y_tr_green = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$y_tr_green = y_tr_green
xr_brown = TIMESERIES(rep(1,101), START = c(1960,1)) ; S_modelData$xr_brown = xr_brown
xr_green = 1/xr_brown; S_modelData$xr_green = xr_green
lev_f_green = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$lev_f_green = lev_f_green
lev_f_brown = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$lev_f_brown = lev_f_brown
liq_b_green = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$liq_b_green = liq_b_green
liq_b_brown = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$liq_b_brown = liq_b_brown

############################################### Starting values for stocks for the open economy #################################################
b_cb_brownbrown_s = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$b_cb_brownbrown_s = b_cb_brownbrown_s
b_cb_greengreen_s = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$b_cb_greengreen_s = b_cb_greengreen_s
b_brown_s = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$b_brown_s = b_brown_s
b_brownbrown_d = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$b_brownbrown_d = b_brownbrown_d
b_brownbrown_s = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$b_brownbrown_s = b_brownbrown_s
b_browngreen_d = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$b_browngreen_d = b_browngreen_d
b_browngreen_s = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$b_browngreen_s = b_browngreen_s
b_green_s = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$b_green_s = b_green_s
b_greenbrown_d = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$b_greenbrown_d = b_greenbrown_d
b_greenbrown_s = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$b_greenbrown_s = b_greenbrown_s
b_greengreen_d = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$b_greengreen_d = b_greengreen_d
b_greengreen_s = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$b_greengreen_s = b_greengreen_s
e_brownbrown_d = TIMESERIES(rep(0,101), START = c(1960,1)) ; S_modelData$e_brownbrown_d = e_brownbrown_d

e_brownbrown_s = TIMESERIES(rep(0,101), START = c(1960,1)) ; S_modelData$e_brownbrown_s = e_brownbrown_s
e_browngreen_d = TIMESERIES(rep(0,101), START = c(1960,1)) ; S_modelData$e_browngreen_d = e_browngreen_d
e_browngreen_s = TIMESERIES(rep(0,101), START = c(1960,1)) ; S_modelData$e_browngreen_s = e_browngreen_s
e_greenbrown_d = TIMESERIES(rep(0,101), START = c(1960,1)) ; S_modelData$e_greenbrown_d = e_greenbrown_d
e_greenbrown_s = TIMESERIES(rep(0,101), START = c(1960,1)) ; S_modelData$e_greenbrown_s = e_greenbrown_s
e_greengreen_d = TIMESERIES(rep(0,101), START = c(1960,1)) ; S_modelData$e_greengreen_d = e_greengreen_d
e_greengreen_s = TIMESERIES(rep(0,101), START = c(1960,1)) ; S_modelData$e_greengreen_s = e_greengreen_s
b_brown_bank = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$b_brown_bank = b_brown_bank
b_green_bank = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$b_green_bank = b_green_bank
l_s_brown = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$l_s_brown = l_s_brown
l_s_green = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$l_s_green = l_s_green
l_firm_brown = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$l_firm_brown = l_firm_brown
l_firm_green = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$l_firm_green = l_firm_green
f_d_greengreen = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$f_d_greengreen = f_d_greengreen
f_d_brownbrown = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$f_d_brownbrown = f_d_brownbrown
f_d_greenbrown = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$f_d_greenbrown = f_d_greenbrown
f_d_browngreen = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$f_d_browngreen = f_d_browngreen

######################################### Set additional ecological coefficients and variables ###################################################


temp_at = temp_at_ob; S_modelData$temp_at = temp_at #Atmospheric temperature over pre-industrial levels  
temp_lo = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$temp_lo = temp_lo #Lower ocean temperature over pre-industrial levels  
t1 = TIMESERIES(rep(0.027,101), START = c(1960,1)); S_modelData$t1 = t1 #Speed of adjustment parameter in atmospheric temperature function  
t2 = TIMESERIES(rep(0.018,101), START = c(1960,1)); S_modelData$t2 = t2 #Coefficient of heat loss from the atmosphere to the lower ocean in atmospheric temperature function  
t3 = TIMESERIES(rep(0.005,101), START = c(1960,1)); S_modelData$t3 = t3 #Coefficient of heat loss from the atmosphere to the lower ocean in lower ocean temperature function 
sens = TIMESERIES(rep(3,101), START = c(1960,1)); S_modelData$sens = sens #Equilibrium climate sensitivity  
co2_at_pre = TIMESERIES(rep(2156.2,101), START = c(1960,1)); S_modelData$co2_at_pre = co2_at_pre # Pre-industrial CO2 concentration in atmosphere (Gt) 
co2_up_pre = TIMESERIES(rep(4950.5,101), START = c(1960,1)); S_modelData$co2_up_pre = co2_up_pre # Pre-industrial CO2 concentration in upper ocean/biosphere (Gt) 
co2_lo_pre = TIMESERIES(rep(36670,101), START = c(1960,1)); S_modelData$co2_lo_pre = co2_lo_pre # Pre-industrial CO2 concentration in lower ocean (Gt)
co2_at = co2_at_pre; S_modelData$co2_at = co2_at #Initial level of atmospheric CO2 concentration in 1960
co2_up = co2_up_pre; S_modelData$co2_up = co2_up #Upper ocean/biosphere CO2 concentration  
co2_lo = co2_lo_pre; S_modelData$co2_lo = co2_lo #Lower ocean CO2 concentration
phi11 = TIMESERIES(rep(0.9817,101), START = c(1960,1)); S_modelData$phi11 = phi11 #CO2 transfer coefficient 
phi21 = TIMESERIES(rep(0.0080,101), START = c(1960,1)); S_modelData$phi21 = phi21 #CO2 transfer coefficient
phi12 = TIMESERIES(rep(0.0183,101), START = c(1960,1)); S_modelData$phi12 = phi12 #CO2 transfer coefficient
phi22 = TIMESERIES(rep(0.9915,101), START = c(1960,1)); S_modelData$phi22 = phi22 #CO2 transfer coefficient
phi23 = TIMESERIES(rep(0.0005,101), START = c(1960,1)); S_modelData$phi23 = phi23 #CO2 transfer coefficient
phi32 = TIMESERIES(rep(0.0001,101), START = c(1960,1)); S_modelData$phi32 = phi32 #CO2 transfer coefficient
phi33 = TIMESERIES(rep(0.9999,101), START = c(1960,1)); S_modelData$phi33 = phi33 #CO2 transfer coefficient
f = TIMESERIES(rep(2.3,101), START = c(1960,1)); S_modelData$f = f # Radiative forcing over pre-industrial levels (W/m^2)  
f2 = TIMESERIES(rep(3.8,101), START = c(1960,1)); S_modelData$f2 = f2 # Increase in radiative forcing due to doubling of CO2 concentraton since pre-industrial levels (W/m^2)
f_ex =TIMESERIES(rep(0.28,101), START = c(1960,1)); S_modelData$f_ex = f_ex # Radiative forcing over pre-industrial levels (W/m^2) due to non-CO2 greenhouse gases (W/m^2) 
fex = TIMESERIES(rep(0.005,101), START = c(1960,1)); S_modelData$fex = fex # Annual increase in radiative forcing due to non-CO2 greenhouse gas emissions (W/m^2) 
wa_brown = TIMESERIES(rep(22/2*mean(emis_ob_dk_s),101), START = c(1960,1)); S_modelData$wa_brown = wa_brown #Waste generated by production activities (Gt)  
wa_green = TIMESERIES(rep(22/2*mean(emis_ob_row_s),101), START = c(1960,1)); S_modelData$wa_green = wa_green #Waste generated by production activities (Gt)  

## Set coefficients for damages due to global warming
dam1_brown = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$dam1_brown = dam1_brown #Parameter of damage function  
dam2_brown = TIMESERIES(rep(0.00284,101), START = c(1960,1)); S_modelData$dam2_brown = dam2_brown  #Parameter of damage function 
dam3_brown = TIMESERIES(rep(0.000005,101), START = c(1960,1)); S_modelData$dam3_brown = dam3_brown  #Parameter of damage function 
dam4_brown = TIMESERIES(rep(6.6754,101), START = c(1960,1)); S_modelData$dam4_brown = dam4_brown  #Parameter of damage function 
d_t_brown = TIMESERIES(rep(0.0028,101), START = c(1960,1)); S_modelData$d_t_brown = d_t_brown  #Percentage of damages (initial value) 
dam1_green = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$dam1_green = dam1_green #Parameter of damage function  
dam2_green = TIMESERIES(rep(0.00284,101), START = c(1960,1)); S_modelData$dam2_green = dam2_green  #Parameter of damage function 
dam3_green = TIMESERIES(rep(0.000005,101), START = c(1960,1)); S_modelData$dam3_green = dam3_green  #Parameter of damage function 
dam4_green = TIMESERIES(rep(6.6754,101), START = c(1960,1)); S_modelData$dam4_green = dam4_green  #Parameter of damage function 
d_t_green = TIMESERIES(rep(0.0028,101), START = c(1960,1)); S_modelData$d_t_green = d_t_green  #Percentage of damages (initial value) 
ad_exp = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$ad_exp = ad_exp  #Coefficient tuning impact of damages on Brownland export 
ad_im = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$ad_im = ad_im  #Coefficient tuning impact of damages on Brownland import 
dc_brown = cons_brown ; S_modelData$dc_brown = dc_brown#Stock of durable consumption goods in Brownland
dc_green = cons_green ; S_modelData$dc_green = dc_green#Stock of durable consumption goods in Greenland
zeta_brown = TIMESERIES(rep(0.015,101), START = c(1960,1)); S_modelData$zeta_brown = zeta_brown  #Proportion of durable discarded in Brownland every year  
zeta_green = TIMESERIES(rep(0.015,101), START = c(1960,1)); S_modelData$zeta_green = zeta_green  #Proportion of durable discard in Greenland every year  
tb_brown = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$tb_brown = tb_brown #Initial value for trade balance of Brownland
tb_green = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$tb_green = tb_green #Initial value for trade balance of Greenland




### Updating starting values dependent on themselves

k_m_brown = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$k_m_brown = k_m_brown #Initial value of matter reserves of Brownland (Gt) 
k_m_green = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$k_m_green = k_m_green #Initial value of matter reserves of Greenland (Gt)
k_e_brown = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$k_e_brown = k_e_brown #Initial value of non-renewable energy reserves of Brownland (Ej)
k_e_green = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$k_e_green = k_e_green #Initial value of non-renewable energy reserves of Greenland (Ej) 
res_e_brown = TIMESERIES(rep(y_ob_dk_s[1]*542000*(1-sigma_e_brown[1])^(-64),101), START = c(1960,1)); S_modelData$res_e_brown = res_e_brown
res_e_green = TIMESERIES(rep(y_ob_row_s[1]*542000*(1-sigma_e_green[1])^(-64),101), START = c(1960,1)); S_modelData$res_e_green = res_e_green #Initial value of non-renewable energy resources of Greenland (Ej) 



k_e_brown = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$k_e_brown = k_e_brown #Initial value of matter reserves of Brownland (Gt) 
k_e_green = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$k_e_green = k_e_green #Initial value of matter reserves of Greenland (Gt)
k_m_brown = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$k_m_brown = k_m_brown #Initial value of non-renewable energy reserves of Brownland (Ej)
k_m_green = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$k_m_green = k_m_green


res_m_brown = y_ob_dk_s*390000*(1-sigma_m_brown)^(-64); S_modelData$res_m_brown = res_m_brown #Initial value of matter resources of Brownland (Gt) - Note: 64 is the number of periods from 1951 to 2015 
res_m_green = y_ob_row_s*390000*(1-sigma_m_green)^(-64); S_modelData$res_m_green = res_m_green #Initial value of matter resources of Greenland (Gt) 

```



```{r}
# Variables only defined in the model

conv_m_brown = TIMESERIES(rep(67.75875 ,101), START = c(1960,1)); S_modelData$conv_m_brown = conv_m_brown
conv_m_green = TIMESERIES(rep(67.75875 ,101), START = c(1960,1)); S_modelData$conv_m_green = conv_m_green
conv_e_brown = TSLAG(res_e_brown,1)*sigma_e_brown; S_modelData$conv_e_brown = conv_e_brown
conv_e_green = TSLAG(res_e_green,1)*sigma_e_green; S_modelData$conv_e_green = conv_e_green


cg_b_brown = TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$cg_b_brown = cg_b_brown
cg_e_brown = TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$cg_e_brown = cg_e_brown
yd_hs_r_brown = TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$yd_hs_r_brown = yd_hs_r_brown
cg_b_green = TIMESERIES(rep(1,101), START = c(1960,1)) ; S_modelData$cg_b_green = cg_b_green
cg_e_green = TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$cg_e_green = cg_e_green
yd_hs_r_green = TIMESERIES(rep(1,101), START = c(1960,1)) ; S_modelData$yd_hs_r_green = yd_hs_r_green
y_w_brown = TIMESERIES(rep(1,101), START = c(1960,1)) ; S_modelData$y_w_brown = y_w_brown
da_gr_brown = TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$da_gr_brown = da_gr_brown
da_con_brown = TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$da_con_brown = da_con_brown
da_brown = TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$da_brown = da_brown
f_brown = TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$f_brown = f_brown
fu_brown = TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$fu_brown = fu_brown
fd_brown = TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$fd_brown = fd_brown
f_m_brown = TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$f_m_brown = f_m_brown
f_bank_brown = TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$f_bank_brown = f_bank_brown
y_r_brown = TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$y_r_brown = y_r_brown
t_brown = TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$t_brown = t_brown
y_w_green = TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$y_w_green = y_w_green
da_gr_green = TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$da_gr_green = da_gr_green
da_con_green = TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$da_con_green = da_con_green
da_green = TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$da_green = da_green
f_green = TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$f_green = f_green
fu_green = TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$fu_green = fu_green
fd_green = TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$fd_green = fd_green
f_m_green = TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$f_m_green = f_m_green
f_bank_green = TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$f_bank_green = f_bank_green
y_r_green = TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$y_r_green = y_r_green
t_green = TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$t_green = t_green
af_brown = TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$af_brown = af_brown
inv_gr_brown_t =  TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$inv_gr_brown_t = inv_gr_brown_t
inv_gr_brown= TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$inv_gr_brown = inv_gr_brown 
af_green = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$af_green = af_green
inv_gr_green_t = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$inv_gr_green_t = inv_gr_green_t
inv_gr_green= TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$inv_gr_green = inv_gr_green 
inv_con_green = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$inv_con_green = inv_con_green
dep_r_brown = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$dep_r_brown = dep_r_brown
dep_w_brown = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$dep_w_brown = dep_w_brown
dep_r_green = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$dep_r_green = dep_r_green
dep_w_green = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$dep_w_green = dep_w_green
r_e_green_t= TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$r_e_green_t = r_e_green_t
r_e_brown_t= TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$r_e_brown_t = r_e_brown_t
dep_bank_brown = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$dep_bank_brown = dep_bank_brown
b_brown_bank_not = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$b_brown_bank_not = b_brown_bank_not
z_brown= TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$z_brown = z_brown
a_d_brown = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$a_d_brown = a_d_brown
dep_bank_green = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$dep_bank_green = dep_bank_green
b_green_bank_not =TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$b_green_bank_not = b_green_bank_not
z_green= TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$z_green = z_green
a_d_green = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$a_d_green = a_d_green
f_cb_brown = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$f_cb_brown = f_cb_brown
f_cb_green = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$f_cb_green = f_cb_green
mu_brown= TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$mu_brown = mu_brown
y_mat_brown = TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$y_mat_brown = y_mat_brown
mu_green= TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$mu_green = mu_green
y_mat_green = TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$y_mat_green = y_mat_green
dis_brown = TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$dis_brown = dis_brown
rec_brown = TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$rec_brown = rec_brown
mat_brown = TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$mat_brown = mat_brown
dis_green = TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$dis_green = dis_green
rec_green = TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$rec_green = rec_green
mat_green = TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$mat_green = mat_green
res_m = TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$res_m = res_m
cen_brown = TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$cen_brown = cen_brown
cen_green = TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$cen_green = cen_green
o2_brown = TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$o2_brown = o2_brown
o2_green = TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$o2_green = o2_green
epsilon_brown= TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$epsilon_brown = epsilon_brown
e_brown = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$e_brown = e_brown
er_brown = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$er_brown = er_brown
en_brown = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$en_brown = en_brown
ed_brown = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$ed_brown = ed_brown
epsilon_green= TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$epsilon_green = epsilon_green
e_green = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$e_green = e_green
er_green = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$er_green = er_green
en_green = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$en_green = en_green
ed_green = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$ed_green = ed_green
k_e = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$k_e = k_e
conv_e_brown = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$conv_e_brown = conv_e_brown
conv_e_green = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$conv_e_green = conv_e_green
res_e = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$res_e = res_e
beta_brown= TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$beta_brown = beta_brown
beta_green= TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$beta_green = beta_green
depl_m_green= TIMESERIES(rep(0.24,101), START = c(1960,1)); S_modelData$depl_m_green = depl_m_green
depl_m_brown= TIMESERIES(rep(0.24,101), START = c(1960,1)); S_modelData$depl_m_brown = depl_m_brown
depl_e_brown= TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$depl_e_brown = depl_e_brown
depl_e_green= TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$depl_e_green = depl_e_green
psbr_brown = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$psbr_brown = psbr_brown
psbr_green = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$psbr_green = psbr_green
cab_brown = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$cab_brown = cab_brown
nafa_brown = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$nafa_brown = nafa_brown
cab_green = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$cab_green = cab_green
nafa_green = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$nafa_green = nafa_green
kabp_brown = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$kabp_brown = kabp_brown
kabp_green = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$kabp_green = kabp_green
bp_brown = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$bp_brown = bp_brown
bp_green = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$bp_green = bp_green
gnp_brown = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$gnp_brown = gnp_brown
gnp_green = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$gnp_green = gnp_green
yd_tot_brown = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$yd_tot_brown = yd_tot_brown
gini_brown  = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$gini_brown = gini_brown
yd_tot_green = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$yd_tot_green = yd_tot_green
gini_green  = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$gini_green = gini_green
v_tot_brown = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$v_tot_brown = v_tot_brown 
giniw_brown = TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$giniw_brown = giniw_brown
v_tot_green = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$v_tot_green = v_tot_green
giniw_green = TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$giniw_green = giniw_green
q_green= TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$q_green = q_green
q_brown= TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$q_brown = q_brown
per_green= TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$per_green = per_green
per_brown= TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$per_brown = per_brown
mu_world= TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$mu_world = mu_world
epsilon_world= TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$epsilon_world = epsilon_world
beta_world= TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$beta_world = beta_world
eta_world= TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$eta_world = eta_world
p_b_brown = TIMESERIES(rep(1,101), START = c(1960,1)) ; S_modelData$p_b_brown = p_b_brown
p_b_green = TIMESERIES(rep(1,101), START = c(1960,1)) ; S_modelData$p_b_green = p_b_green
k = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$k = k
inv_con_brown = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$inv_con_brown = inv_con_brown

```



## Shock variables

```{r}
## Model variable

carbon_tax_shock_green= TIMESERIES(rep(0,101), START = c(1960,1));S_modelData$carbon_tax_shock_green = carbon_tax_shock_green
carbon_tax_shock_brown= TIMESERIES(rep(0,101), START = c(1960,1));S_modelData$carbon_tax_shock_brown = carbon_tax_shock_brown

Strong_PH= TIMESERIES(rep(0,101), START = c(1960,1));S_modelData$Strong_PH = Strong_PH
sens_4_low= TIMESERIES(rep(0,101), START = c(1960,1));S_modelData$sens_4_low = sens_4_low
sens_5_high= TIMESERIES(rep(0,101), START = c(1960,1));S_modelData$sens_5_high = sens_5_high

carbon_tax_2022= TIMESERIES(c(rep(0,65),50,62,74,86,98,110,rep(110,31)), START = c(1960,1));S_modelData$carbon_tax_2022 = carbon_tax_2022

## Carbon tax shock

## Laver en c02 skat der vokser med 9% hvert år så det passer med de 1000 kr. i 2030
Co2_tax=c(5)
n=38

for (t in 2:n) {
  Co2_tax[t] <- Co2_tax[1]*(1.091649)^t
}

Co2_tax_shock=TIMESERIES(Co2_tax, START = c(1993,1), FREQ = 1)
Co2_tax_base=window(TIMESERIES(Co2_tax, START = c(1993,1), FREQ = 1), end= 2020)

carbon_tax_DK= TIMESERIES(c(rep(0,32),Co2_tax_base,rep(58.249822,41)), START = c(1960,1));S_modelData$carbon_tax_DK = carbon_tax_DK
carbon_tax_DK_shock= TIMESERIES(c(rep(0,32),Co2_tax_shock,rep(140,31)), START = c(1960,1));S_modelData$carbon_tax_DK_shock = carbon_tax_DK_shock

carbon_tax_rate_green= TIMESERIES(rep(50,101), START = c(1960,1));S_modelData$carbon_tax_rate_green = carbon_tax_rate_green
carbon_tax_rate_brown= TIMESERIES(rep(50,101), START = c(1960,1));S_modelData$carbon_tax_rate_brown = carbon_tax_rate_brown
carbon_tax_green = (emis_green*1000000000*carbon_tax_rate_green)/1000000000000;S_modelData$carbon_tax_green = carbon_tax_green
carbon_tax_brown = (emis_brown*1000000000*carbon_tax_rate_brown)/1000000000000;S_modelData$carbon_tax_brown = carbon_tax_brown


share_x_brown= TIMESERIES(rep(0.5,101), START = c(1960,1));S_modelData$share_x_brown = share_x_brown
share_dev_brown= TIMESERIES(rep(0.25,101), START = c(1960,1));S_modelData$share_dev_brown = share_dev_brown
share_tech_brown= TIMESERIES(rep(0.25,101), START = c(1960,1));S_modelData$share_tech_brown = share_tech_brown

share_x_green= TIMESERIES(rep(0.5,101), START = c(1960,1));S_modelData$share_x_green = share_x_green
share_dev_green= TIMESERIES(rep(0.25,101), START = c(1960,1));S_modelData$share_dev_green = share_dev_green
share_tech_green= TIMESERIES(rep(0.25,101), START = c(1960,1));S_modelData$share_tech_green = share_tech_green

carbon_tax_x_green = share_x_green*carbon_tax_green ;S_modelData$carbon_tax_x_green = carbon_tax_x_green
carbon_tax_x_brown = share_x_brown*carbon_tax_brown ;S_modelData$carbon_tax_x_brown = carbon_tax_x_brown

carbon_tax_dev_green = share_dev_green*carbon_tax_green ;S_modelData$carbon_tax_dev_green = carbon_tax_dev_green
carbon_tax_dev_brown = share_dev_green*carbon_tax_brown ;S_modelData$carbon_tax_dev_brown = carbon_tax_dev_brown

carbon_tax_tech_green = share_tech_green*carbon_tax_green ;S_modelData$carbon_tax_tech_green = carbon_tax_tech_green
carbon_tax_tech_brown = share_tech_green*carbon_tax_brown ;S_modelData$carbon_tax_tech_brown = carbon_tax_tech_brown

##### Export/Import

x_gr_brown = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$x_gr_brown = x_gr_brown
x_con_brown = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$x_con_brown = x_con_brown
im_gr_green = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$im_gr_green = im_gr_green
im_con_green = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$im_con_green = im_con_green

im_gr_brown = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$im_gr_brown = im_gr_brown
im_con_brown = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$im_con_brown = im_con_brown
x_gr_green = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$x_gr_green = x_gr_green
x_con_green = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$x_con_green = x_con_green


share_x_gr_brown = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$share_x_gr_brown = share_x_gr_brown
share_im_gr_brown = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$share_im_gr_brown = share_im_gr_brown

eps_gr0= TIMESERIES(rep(-4.65,101), START = c(1960,1));S_modelData$eps_gr0 = eps_gr0
eps_gr1= TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$eps_gr1 = eps_gr1
eps_gr3= TIMESERIES(rep(-0.5,101), START = c(1960,1));S_modelData$eps_gr3 = eps_gr3



### Government spendings 

gov_gr_inv_brown = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$gov_gr_inv_brown = gov_gr_inv_brown
gov_gr_inv_green = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$gov_gr_inv_green = gov_gr_inv_green

gov_tot_inv_brown = gov_tot_brown  ;S_modelData$gov_tot_inv_brown = gov_tot_inv_brown #Skal bruge samme starting value da carbon tax først kommer ind senere!
gov_tot_inv_green = gov_tot_green  ;S_modelData$gov_tot_inv_green = gov_tot_inv_green #Skal bruge samme starting value da carbon tax først kommer ind senere!


gov_gr_rd_brown = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$gov_gr_rd_brown = gov_gr_rd_brown
gov_gr_rd_green = TIMESERIES(rep(0,101), START = c(1960,1)); S_modelData$gov_gr_rd_green = gov_gr_rd_green

### Nye kapital ligninger

inv_gr_im_green = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$inv_gr_im_green = inv_gr_im_green
k_gr_im_green = TIMESERIES(rep(0,101), START = c(1960,1));S_modelData$k_gr_im_green = k_gr_im_green # Start værdi ligmed 0
da_gr_im_green = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$da_gr_im_green = da_gr_im_green

inv_gr_im_brown = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$inv_gr_im_brown = inv_gr_im_brown
k_gr_im_brown = TIMESERIES(rep(0,101), START = c(1960,1));S_modelData$k_gr_im_brown = k_gr_im_brown # Start værdi ligmed 0
da_gr_im_brown = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$da_gr_im_brown = da_gr_im_brown


##### Co2 costs 
growth_beta_gr_green = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$growth_beta_gr_green = growth_beta_gr_green
growth_beta_gr_brown = TIMESERIES(rep(1,101), START = c(1960,1));S_modelData$growth_beta_gr_brown = growth_beta_gr_brown


eta_gr_impv_brown = TIMESERIES(rep(0,101), START = c(1960,1));S_modelData$eta_gr_impv_brown = eta_gr_impv_brown
eta_gr_impv_brown_t = TIMESERIES(rep(0,101), START = c(1960,1));S_modelData$eta_gr_impv_brown_t = eta_gr_impv_brown_t
eta_gr_brown_t = TIMESERIES(rep(0.01,101), START = c(1960,1));S_modelData$eta_gr_brown_t = eta_gr_brown_t
eta_gr_impv_green = TIMESERIES(rep(0,101), START = c(1960,1));S_modelData$eta_gr_impv_green = eta_gr_impv_green

##### Shock 5: difference in greeness

beta_con_brown_shock= beta_con_brown*0.9; S_modelData$beta_con_brown_shock = beta_con_brown_shock
beta_gr_brown_shock= beta_gr_brown*0.9; S_modelData$beta_gr_brown_shock = beta_gr_brown_shock

epsilon_con_brown_shock= epsilon_con_brown*0.9; S_modelData$epsilon_con_brown_shock = epsilon_con_brown_shock
epsilon_gr_brown_shock= epsilon_gr_brown*0.9; S_modelData$epsilon_gr_brown_shock = epsilon_gr_brown_shock

eta_con_brown_shock= TIMESERIES(rep(0.05,101), START = c(1960,1)); S_modelData$eta_con_brown_shock = eta_con_brown_shock
eta_gr_brown_shock= TIMESERIES(rep(0.2,101), START = c(1960,1)); S_modelData$eta_gr_brown_shock = eta_gr_brown_shock


########## difference in beta values ##############


######## import beta values ##################


beta_im_gr_green= beta_gr_brown; S_modelData$beta_im_gr_green = beta_im_gr_green
beta_im_gr_brown= beta_gr_green; S_modelData$beta_im_gr_brown = beta_im_gr_brown

eta_im_gr_green= eta_gr_brown; S_modelData$eta_im_gr_green = eta_im_gr_green
eta_im_gr_brown= eta_gr_green; S_modelData$eta_im_gr_brown = eta_im_gr_brown

beta_avg_gr_green= beta_gr_green; S_modelData$beta_avg_gr_green = beta_avg_gr_green
beta_avg_gr_brown= beta_gr_brown; S_modelData$beta_avg_gr_brown = beta_avg_gr_brown

eta_avg_gr_green= eta_gr_green; S_modelData$eta_avg_gr_green = eta_avg_gr_green
eta_avg_gr_brown= eta_gr_brown; S_modelData$eta_avg_gr_brown = eta_avg_gr_brown

k_gr_im_new_brown= TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$k_gr_im_new_brown = k_gr_im_new_brown
k_gr_im_new_green= TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$k_gr_im_new_green = k_gr_im_new_green

k_gr_new_brown= TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$k_gr_new_brown = k_gr_new_brown
k_gr_new_green= TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$k_gr_new_green = k_gr_new_green


imp_brown = TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$imp_brown = imp_brown
imp_green = TIMESERIES(rep(1,101), START = c(1960,1)); S_modelData$imp_green = imp_green

################ Weak ph ####################

inv_gr_rd_brown = TIMESERIES(rep(0,101), START = c(1960,1));S_modelData$inv_gr_rd_brown = inv_gr_rd_brown
inv_gr_rd_green = TIMESERIES(rep(0,101), START = c(1960,1));S_modelData$inv_gr_rd_green = inv_gr_rd_green

################### PH #####################################

Narrowly_strong_PH = TIMESERIES(rep(0,101), START = c(1960,1));S_modelData$Narrowly_strong_PH = Narrowly_strong_PH
Weak_PH = TIMESERIES(rep(0,101), START = c(1960,1));S_modelData$Weak_PH = Weak_PH


```




# Simulate data!

```{r}
S_model=LOAD_MODEL_DATA(S_model,S_modelData)

```


## Extend timeseries:

```{r}
S_model$modelData <- within(S_model$modelData,{
  cons_ob  = TSEXTEND(cons_ob,  UPTO=c(2060,1))
  gov_ob  = TSEXTEND(gov_ob,  UPTO=c(2060,1))
  emis_ob  = TSEXTEND(emis_ob,  UPTO=c(2060,1))
  temp_at_ob  = TSEXTEND(temp_at_ob,  UPTO=c(2060,1))
  cons_brown  = TSEXTEND(cons_brown,  UPTO=c(2060,1))
  cons_green  = TSEXTEND(cons_green,  UPTO=c(2060,1))
  cons_w_brown  = TSEXTEND(cons_w_brown,  UPTO=c(2060,1))
  cons_w_green  = TSEXTEND(cons_w_green,  UPTO=c(2060,1))
  inv_brown  = TSEXTEND(inv_brown,  UPTO=c(2060,1))
  inv_green  = TSEXTEND(inv_green,  UPTO=c(2060,1))
  gov_con_brown  = TSEXTEND(gov_con_brown,  UPTO=c(2060,1))
  gov_con_green  = TSEXTEND(gov_con_green,  UPTO=c(2060,1))
  emis_brown  = TSEXTEND(emis_brown,  UPTO=c(2060,1))
  emis_green  = TSEXTEND(emis_green,  UPTO=c(2060,1))
  emis  = TSEXTEND(emis,  UPTO=c(2060,1))
  temp_at  = TSEXTEND(temp_at,  UPTO=c(2060,1))
  carbon_tax_green  = TSEXTEND(carbon_tax_green,  UPTO=c(2060,1))
  carbon_tax_brown  = TSEXTEND(carbon_tax_brown,  UPTO=c(2060,1))
  gov_tot_inv_brown = TSEXTEND(gov_tot_inv_brown,  UPTO=c(2060,1))
  gov_tot_inv_green = TSEXTEND(gov_tot_inv_brown,  UPTO=c(2060,1))
  gov_gr_ob = TSEXTEND(gov_gr_ob,  UPTO=c(2060,1))
})
```



# Simulate

## Baseline 1: Without PH


```{r}
baseline1 <- SIMULATE(S_model
                    ,simType='FORECAST'
                    ,TSRANGE=c(1961,1,2060,1)
                    ,simConvergence=0.00001
                    ,simIterLimit=100
                    )
```

```{r}

res_e_brown_10= baseline1$simulation$res_e_brown

############ Economic variables ###############

gov_gr_rd_green_10 = baseline1$simulation$gov_gr_rd_green
gov_gr_rd_brown_10 = baseline1$simulation$gov_gr_rd_brown
inv_gr_rd_brown_10= baseline1$simulation$inv_gr_rd_brown
inv_gr_rd_green_10= baseline1$simulation$inv_gr_rd_green
im_green_10= baseline1$simulation$im_green
gov_gr_brown_10= baseline1$simulation$gov_gr_brown
x_green_10= baseline1$simulation$x_green
k_gr_con_10= baseline1$simulation$k_gr_con
d_t_brown_10= baseline1$simulation$d_t_brown
gov_gr_inv_green_10 = baseline1$simulation$gov_gr_inv_green
gov_con_green_10 = baseline1$simulation$gov_con_green
gov_gr_rd_green_10 = baseline1$simulation$gov_gr_rd_green

############### Validering ################

yd_hs_r_brown_10 = baseline1$simulation$yd_hs_r_brown
f_m_brown_10 = baseline1$simulation$f_m_brown
f_brown_10 = baseline1$simulation$f_brown
da_brown_10 = baseline1$simulation$da_brown
l_firm_brown_10 = baseline1$simulation$l_firm_brown
e_browngreen_d_10= baseline1$simulation$e_browngreen_d
e_greenbrown_d_10= baseline1$simulation$e_greenbrown_d
b_browngreen_d_10= baseline1$simulation$b_browngreen_d
b_greenbrown_d_10= baseline1$simulation$b_greenbrown_d


#############  Slut #####################
eta_im_gr_green_10= baseline1$simulation$eta_im_gr_green
eta_im_gr_brown_10= baseline1$simulation$eta_im_gr_brown
eta_gr_brown_10 = baseline1$simulation$eta_gr_brown
eta_gr_brown_t_10 = baseline1$simulation$eta_gr_brown_t
eta_gr_green_10 = baseline1$simulation$eta_gr_green
eta_green_10= baseline1$simulation$eta_green
eta_gr_impv_green_10 = baseline1$simulation$eta_gr_impv_green

eta_gr_impv_brown_10 = baseline1$simulation$eta_gr_impv_brown

gov_gr_rd_brown_10 = baseline1$simulation$gov_gr_rd_brown
gov_gr_rd_green_10 = baseline1$simulation$gov_gr_rd_green

carbon_tax_rate_brown_10 = baseline1$simulation$carbon_tax_rate_brown
########### Grøn eksport ###########

x_gr_brown_10 = baseline1$simulation$x_gr_brown


x_brown_10 = baseline1$simulation$x_brown

x_gr_brown_10/x_brown_10


x_gr_brown_10 = baseline1$simulation$x_gr_brown

x_brown_10 = baseline1$simulation$x_brown

im_gr_brown_10 = baseline1$simulation$im_gr_brown

im_brown_10 = baseline1$simulation$im_brown

im_gr_brown_10/im_brown_10

######## Patent ####################

eta_gr_brown_10 = baseline1$simulation$eta_gr_brown
eta_gr_green_10 = baseline1$simulation$eta_gr_green

eta_avg_gr_brown_10 = baseline1$simulation$eta_avg_gr_brown
eta_avg_gr_green_10 = baseline1$simulation$eta_avg_gr_green

eta_brown_10 = baseline1$simulation$eta_brown

growth_eta_gr_brown_10 = baseline1$simulation$growth_eta_gr_brown

inv_gr_brown_10 = baseline1$simulation$inv_gr_brown
inv_gr_green_10 = baseline1$simulation$inv_gr_green

inv_brown_10 = baseline1$simulation$inv_brown
inv_green_10 = baseline1$simulation$inv_green

gov_gr_rd_brown_10 = baseline1$simulation$gov_gr_rd_brown

gov_gr_rd_brown_10/inv_brown_10

gov_gr_rd_green_10/inv_green_10


####### difference in beta values #################


spill_browngreen_10 = baseline1$simulation$spill_browngreen
spill_greenbrown_10 = baseline1$simulation$spill_greenbrown

beta_avg_gr_green_10 = baseline1$simulation$beta_avg_gr_green
beta_avg_gr_brown_10 = baseline1$simulation$beta_avg_gr_brown

beta_gr_brown_10 = baseline1$simulation$beta_gr_brown
beta_con_green_10 = baseline1$simulation$beta_con_green

beta_im_gr_green_10 = baseline1$simulation$beta_im_gr_green
beta_im_gr_brown_10 = baseline1$simulation$beta_im_gr_brown

rel_beta_brown_10 = baseline1$simulation$rel_beta_brown
rel_beta_green_10 = baseline1$simulation$rel_beta_green
rel_gr_beta_10 = baseline1$simulation$rel_gr_beta

im_brown_10= baseline1$simulation$im_brown
x_gr_brown_10 = baseline1$simulation$x_gr_brown
x_gr_green_10 = baseline1$simulation$x_gr_green

k_gr_green_10 = baseline1$simulation$k_gr_green

share_im_gr_brown_10 = baseline1$simulation$share_im_gr_brown
share_x_gr_brown_10 = baseline1$simulation$share_x_gr_brown
##### Emission intensity #####

beta_con_brown_10 = baseline1$simulation$beta_con_brown
beta_gr_brown_10 = baseline1$simulation$beta_gr_brown

eta_con_brown_10 = baseline1$simulation$eta_con_brown
eta_gr_brown_10 = baseline1$simulation$eta_gr_brown

mu_con_brown_10 = baseline1$simulation$mu_con_brown
mu_gr_brown_10 = baseline1$simulation$mu_gr_brown

epsilon_con_brown_10 = baseline1$simulation$epsilon_con_brown
epsilon_gr_brown_10 = baseline1$simulation$epsilon_gr_brown



er_green_10 = baseline1$simulation$er_green
er_brown_10 = baseline1$simulation$er_brown

e_green_10 = baseline1$simulation$e_green
e_brown_10 = baseline1$simulation$e_brown

epsilon_green_10 = baseline1$simulation$epsilon_green
epsilon_brown_10 = baseline1$simulation$epsilon_brown

delta_green_10 = baseline1$simulation$delta_green
delta_brown_10 = baseline1$simulation$delta_brown
y_r_green_10 = baseline1$simulation$y_r_green
fd_brown_10 = baseline1$simulation$fd_brown
da_green_10 = baseline1$simulation$da_green
da_brown_10 = baseline1$simulation$da_brown
af_brown_10 = baseline1$simulation$af_brown
f_m_brown_10 = baseline1$simulation$f_m_brown
e_brownbrown_s_10 = baseline1$simulation$e_brownbrown_s 
l_firm_brown_10 = baseline1$simulation$l_firm_brown 
y_10 = baseline1$simulation$y 
inv_10 = baseline1$simulation$inv 
cons_10 = baseline1$simulation$cons 
gov_10 = baseline1$simulation$gov 
inv_green_10 = baseline1$simulation$inv_green
inv_brown_10 = baseline1$simulation$inv_brown
carbon_tax_green_10 = baseline1$simulation$carbon_tax_green
yd_r_green_10 = baseline1$simulation$yd_r_green
yd_r_brown_10 = baseline1$simulation$yd_r_brown
t_green_10 = baseline1$simulation$t_green
t_brown_10 = baseline1$simulation$t_brown
cons_10 = baseline1$simulation$cons 
cons_brown_10 = baseline1$simulation$cons_brown 
cons_green_10 = baseline1$simulation$cons_green  
emis_l_10 = baseline1$simulation$emis_l
xr_brown_10 = baseline1$simulation$xr_brown
p_e_green_10 = baseline1$simulation$p_e_green
p_e_brown_10 = baseline1$simulation$p_e_brown
emis_brown_10 = baseline1$simulation$emis_brown
emis_green_10 = baseline1$simulation$emis_green
beta_brown0_10 = baseline1$simulation$beta_brown0
beta_brown_10 = baseline1$simulation$beta_brown
en_brown_10 = baseline1$simulation$en_brown
emis_10 = baseline1$simulation$emis
emis_l_10 = baseline1$simulation$emis_l
y_green_10 = baseline1$simulation$y_green
y_brown_10 = baseline1$simulation$y_brown
x_brown_10 = baseline1$simulation$x_brown
im_brown_10 = baseline1$simulation$im_brown
k_gr_green_10 = baseline1$simulation$k_gr_green
k_green_10 = baseline1$simulation$k_green
k_brown_10 = baseline1$simulation$k_brown
yd_w_brown_10 = baseline1$simulation$yd_w_brown
yd_w_green_10 = baseline1$simulation$yd_w_green
yd_w_green_10

im_brown_10 - x_brown_10
b_brownbrown_d_10 = baseline1$simulation$b_brownbrown_d


x_brown_10 = baseline1$simulation$x_brown
1000000000000*x_brown_10
im_brown_10 = baseline1$simulation$im_brown


beta_gr_green_10 = baseline1$simulation$beta_gr_green
beta_gr_brown_10 = baseline1$simulation$beta_gr_brown

mu_brown_10 = baseline1$simulation$mu_brown # Ser ud til det er dem her der laver faldet i udledningen 
epsilon_brown_10 = baseline1$simulation$epsilon_brown # Ser ud til det er dem her der laver faldet i udledningen 
eta_brown_10 = baseline1$simulation$eta_brown # Ser ud til det er dem her der laver faldet i udledningen 

x_gr_brown_10 = baseline1$simulation$x_gr_brown
x_con_brown_10 = baseline1$simulation$x_con_brown
im_con_green_10 = baseline1$simulation$im_con_green
im_gr_green_10 = baseline1$simulation$im_gr_green
inv_gr_green_10 = baseline1$simulation$inv_gr_green
gov_tot_green_10 = baseline1$simulation$gov_tot_green
gov_tot_brown_10 = baseline1$simulation$gov_tot_brown
carbon_tax_brown_10 = baseline1$simulation$carbon_tax_brown
temp_at_10 = baseline1$simulation$temp_at
cons_r_green_10 = baseline1$simulation$cons_r_green
cons_r_brown_10 = baseline1$simulation$cons_r_brown
v_r_green_10 = baseline1$simulation$v_r_green
v_r_brown_10 = baseline1$simulation$v_r_brown

cons_w_green_10 = baseline1$simulation$cons_w_green
cons_w_brown_10 = baseline1$simulation$cons_w_brown
v_w_green_10 = baseline1$simulation$v_w_green
v_w_brown_10 = baseline1$simulation$v_w_brown


carbon_tax_brown_10 = baseline1$simulation$carbon_tax_brown


gov_gr_inv_brown_10 = baseline1$simulation$gov_gr_inv_brown


k_gr_green_10 = baseline1$simulation$k_gr_green
k_con_green_10 = baseline1$simulation$k_con_green
k_gr_im_green_10 = baseline1$simulation$k_gr_im_green
k_green_10 = baseline1$simulation$k_green


k_gr_green_10/k_green_10 + k_gr_im_green_10/k_green_10 + k_con_green_10/k_green_10 # Skal give 1 


k_gr_brown_10 = baseline1$simulation$k_gr_brown
k_con_brown_10 = baseline1$simulation$k_con_brown
k_gr_im_brown_10 = baseline1$simulation$k_gr_im_brown
k_brown_10 = baseline1$simulation$k_brown

yd_r_brown_10 = baseline1$simulation$yd_r_brown


k_gr_brown_10/k_brown_10 + k_gr_im_brown_10/k_brown_10 + k_con_brown_10/k_brown_10 # Skal give 1 


inv_con_brown_10 = baseline1$simulation$inv_con_brown
inv_gr_im_brown_10 = baseline1$simulation$inv_gr_im_brown
inv_gr_brown_t_10 = baseline1$simulation$inv_gr_brown_t
inv_gr_brown_10 = baseline1$simulation$inv_gr_brown
inv_brown_10 = baseline1$simulation$inv_brown

d_t_brown_10 = baseline1$simulation$d_t_brown
v_w_brown_10 = baseline1$simulation$v_w_brown
v_r_brown_10 = baseline1$simulation$v_r_brown

inv_con_brown_10 + inv_gr_im_brown_10 + inv_gr_brown_10 - inv_brown_10 # Skal give 0

(chi1_brown*gov_gr_inv_brown_10+chi2_brown*y_brown_10 + chi3_brown*TSLAG(d_t_brown_10,1))

inv_gr_brown_t_10 + inv_gr_im_brown_10 > inv_brown_10

(inv_gr_brown_10 + inv_gr_im_brown_10)/inv_brown_10
inv_con_brown_10/inv_brown_10

inv_gr_brown_t_10 > inv_brown_10

inv_con_green_10 = baseline1$simulation$inv_con_green
inv_gr_im_green_10 = baseline1$simulation$inv_gr_im_green
inv_gr_green_10 = baseline1$simulation$inv_gr_green
inv_green_10 = baseline1$simulation$inv_green

inv_con_green_10 + inv_gr_im_green_10 + inv_gr_green_10 - inv_green_10 # Skal give 0

inv_gr_green_10/inv_green_10
inv_con_green_10/inv_green_10

y_brown_10
cons_r_brown_10 + cons_w_brown_10 + gov_tot_brown_10 + x_brown_10 - im_brown_10 + inv_brown_10

gov_con_brown_10 = baseline1$simulation$gov_con_brown


share_x_brown_10 = baseline1$simulation$share_x_brown
share_tech_brown_10 = baseline1$simulation$share_tech_brown
share_dev_brown_10 = baseline1$simulation$share_dev_brown

###########
y_r_brown_10 = baseline1$simulation$y_r_brown
f_brown_10 = baseline1$simulation$f_brown
fu_brown_10 = baseline1$simulation$fu_brown


f_bank_brown_10 = baseline1$simulation$f_bank_brown # Bankers profit er negativ
b_brown_bank_10 = baseline1$simulation$b_brown_bank # Meget høj!
l_s_brown_10 = baseline1$simulation$l_s_brown # Negativ lån!!!



b_brownbrown_s_10 = baseline1$simulation$b_brownbrown_s

b_browngreen_s_10 = baseline1$simulation$b_browngreen_s

f_d_brownbrown_10 = baseline1$simulation$f_d_brownbrown

f_d_browngreen_10 = baseline1$simulation$f_d_browngreen

e_greenbrown_s_10 = baseline1$simulation$e_greenbrown_s


###### DEMAND FOR FINANCIAL ASSETS (PORTFOLIO EQUATIONS)

b_brownbrown_d_10 = baseline1$simulation$b_brownbrown_d

b_browngreen_d_10 = baseline1$simulation$b_browngreen_d

b_greenbrown_d_10 = baseline1$simulation$b_greenbrown_d # Skal være lavere:  Bills issued by Brownland acquired by Greenland: demand

b_greengreen_d_10 = baseline1$simulation$b_greengreen_d

e_brownbrown_d_10 = baseline1$simulation$e_brownbrown_d

e_browngreen_d_10 = baseline1$simulation$e_browngreen_d

e_greenbrown_d_10 = baseline1$simulation$e_greenbrown_d # Skal være lavere: Brownland shares held by Greenland capitalists

e_greengreen_d_10 = baseline1$simulation$e_greengreen_d

x_gr_brown_10 = baseline1$simulation$x_gr_brown
x_brown_10 = baseline1$simulation$x_brown

x_gr_brown_10/x_brown_10


inv_gr_brown_t_10 + inv_gr_im_brown_10 + inv_gr_rd_brown_10 > inv_brown_10


# co2 intensity

beta_green_10 = baseline1$simulation$beta_green
en_brown_10 = baseline1$simulation$en_brown
en_green_10 = baseline1$simulation$en_green
e_brown_10 = baseline1$simulation$e_brown
er_brown_10 = baseline1$simulation$er_brown
epsilon_brown_10 = baseline1$simulation$epsilon_brown

beta_brown0 + beta_brown_10*en_brown_10 >= (emis_10-emis_l_10)*emis_ob_dk_s



###### Calibration tests

x_gr_green_10/x_green_10
x_gr_brown_10/x_brown_10


inv_gr_rd_brown_10/inv_brown_10
inv_gr_rd_green_10/inv_green_10


eta_gr_impv_brown_10
eta_gr_impv_green_10

## Stability check
h_brown_h_10 = baseline1$simulation$h_brown_h
h_brown_s_10 = baseline1$simulation$h_brown_s
h_green_h_10 = baseline1$simulation$h_green_h
h_green_s_10 = baseline1$simulation$h_green_s

plot(h_brown_h_10-h_brown_s_10)   
plot(h_green_h_10-h_green_s_10) 
```



## Baseline 2: Weak PH

Tror muligvis ikke jeggg behøves lave en baseline til denne, men gør det lige for sikkerhedsskyld

```{r}
Weak_PH_model=Weak_PH %>% window(start= c(1960,1))
```

```{r}
# Define add-factor list (defining shock)
constantAdjList_B2 <- list(
  
Weak_PH = TIMESERIES(Weak_PH_model+1 ,START=c(1960,1),  FREQ=1)

)

```


```{r}
baseline2 <- SIMULATE(S_model
                    ,simType='FORECAST'
                    ,TSRANGE=c(1961,1,2060,1)
                    ,simConvergence=0.00001
                    ,simIterLimit=100
                    , ConstantAdjustment = constantAdjList_B2
                    )
```


```{r}



im_green_20= baseline2$simulation$im_green
inv_gr_rd_brown_10
inv_gr_rd_brown_20= baseline2$simulation$inv_gr_rd_brown
inv_gr_rd_green_20= baseline2$simulation$inv_gr_rd_green


d_t_brown_20= baseline2$simulation$d_t_brown
gov_gr_brown_20= baseline2$simulation$gov_gr_brown
x_green_20= baseline2$simulation$x_green

############### Validering ################

yd_hs_r_brown_20 = baseline2$simulation$yd_hs_r_brown
window(yd_hs_r_brown_20, start= 2016)


f_m_brown_20 = baseline2$simulation$f_m_brown

window(f_m_brown_20, start= 2016)

f_brown_20 = baseline2$simulation$f_brown
window(f_brown_20, start= 2016)

da_brown_20 = baseline2$simulation$da_brown
window(da_brown_20, start= 2016)

l_firm_brown_20 = baseline2$simulation$l_firm_brown
window(l_firm_brown_20, start= 2016)


e_browngreen_d_20= baseline2$simulation$e_browngreen_d
window(e_browngreen_d_20, start= 2016)
e_greenbrown_d_20= baseline2$simulation$e_greenbrown_d
window(e_greenbrown_d_20, start= 2016)

b_browngreen_d_20= baseline2$simulation$b_browngreen_d
window(b_browngreen_d_20, start= 2016)
b_greenbrown_d_20= baseline2$simulation$b_greenbrown_d
window(b_greenbrown_d_20, start= 2016)

#############  Slut #####################
eta_im_gr_green_20= baseline2$simulation$eta_im_gr_green
eta_im_gr_brown_20= baseline2$simulation$eta_im_gr_brown
eta_gr_brown_20 = baseline2$simulation$eta_gr_brown
eta_gr_brown_t_20 = baseline2$simulation$eta_gr_brown_t
eta_gr_green_20 = baseline2$simulation$eta_gr_green
eta_green_20= baseline2$simulation$eta_green
eta_gr_impv_green_20 = baseline2$simulation$eta_gr_impv_green

eta_gr_impv_brown_20 = baseline2$simulation$eta_gr_impv_brown

gov_gr_rd_brown_20 = baseline2$simulation$gov_gr_rd_brown
gov_gr_rd_green_20 = baseline2$simulation$gov_gr_rd_green


########### Grøn eksport ###########

x_gr_brown_20 = baseline2$simulation$x_gr_brown

x_brown_20 = baseline2$simulation$x_brown

x_gr_brown_20/x_brown_20

x_gr_brown_20 = baseline2$simulation$x_gr_brown

x_brown_20 = baseline2$simulation$x_brown

im_gr_brown_20 = baseline2$simulation$im_gr_brown

im_brown_20 = baseline2$simulation$im_brown

im_gr_brown_20/im_brown_20

######## Patent ####################

eta_gr_brown_20 = baseline2$simulation$eta_gr_brown
eta_gr_green_20 = baseline2$simulation$eta_gr_green

eta_avg_gr_brown_20 = baseline2$simulation$eta_avg_gr_brown
eta_avg_gr_green_20 = baseline2$simulation$eta_avg_gr_green

eta_brown_20 = baseline2$simulation$eta_brown

growth_eta_gr_brown_20 = baseline2$simulation$growth_eta_gr_brown

inv_gr_brown_20 = baseline2$simulation$inv_gr_brown
inv_gr_green_20 = baseline2$simulation$inv_gr_green

inv_brown_20 = baseline2$simulation$inv_brown
inv_green_20 = baseline2$simulation$inv_green

gov_gr_rd_brown_20 = baseline2$simulation$gov_gr_rd_brown

####### difference in beta values #################


spill_browngreen_20 = baseline2$simulation$spill_browngreen
spill_greenbrown_20 = baseline2$simulation$spill_greenbrown

beta_avg_gr_green_20 = baseline2$simulation$beta_avg_gr_green
beta_avg_gr_brown_20 = baseline2$simulation$beta_avg_gr_brown

beta_gr_brown_20 = baseline2$simulation$beta_gr_brown
beta_con_green_20 = baseline2$simulation$beta_con_green

beta_im_gr_green_20 = baseline2$simulation$beta_im_gr_green
beta_im_gr_brown_20 = baseline2$simulation$beta_im_gr_brown

rel_beta_brown_20 = baseline2$simulation$rel_beta_brown
rel_beta_green_20 = baseline2$simulation$rel_beta_green
rel_gr_beta_20 = baseline2$simulation$rel_gr_beta

im_brown_20= baseline2$simulation$im_brown
x_gr_brown_20 = baseline2$simulation$x_gr_brown
x_gr_green_20 = baseline2$simulation$x_gr_green

k_gr_green_20 = baseline2$simulation$k_gr_green

share_im_gr_brown_20 = baseline2$simulation$share_im_gr_brown
share_x_gr_brown_20 = baseline2$simulation$share_x_gr_brown
##### Emission intensity #####

beta_con_brown_20 = baseline2$simulation$beta_con_brown
beta_gr_brown_20 = baseline2$simulation$beta_gr_brown

eta_con_brown_20 = baseline2$simulation$eta_con_brown
eta_gr_brown_20 = baseline2$simulation$eta_gr_brown

mu_con_brown_20 = baseline2$simulation$mu_con_brown
mu_gr_brown_20 = baseline2$simulation$mu_gr_brown

epsilon_con_brown_20 = baseline2$simulation$epsilon_con_brown
epsilon_gr_brown_20 = baseline2$simulation$epsilon_gr_brown



er_green_20 = baseline2$simulation$er_green
er_brown_20 = baseline2$simulation$er_brown

e_green_20 = baseline2$simulation$e_green
e_brown_20 = baseline2$simulation$e_brown

epsilon_green_20 = baseline2$simulation$epsilon_green
epsilon_brown_20 = baseline2$simulation$epsilon_brown

delta_green_20 = baseline2$simulation$delta_green
delta_brown_20 = baseline2$simulation$delta_brown
y_r_green_20 = baseline2$simulation$y_r_green
fd_brown_20 = baseline2$simulation$fd_brown
da_green_20 = baseline2$simulation$da_green
da_brown_20 = baseline2$simulation$da_brown
af_brown_20 = baseline2$simulation$af_brown
f_m_brown_20 = baseline2$simulation$f_m_brown
e_brownbrown_s_20 = baseline2$simulation$e_brownbrown_s 
l_firm_brown_20 = baseline2$simulation$l_firm_brown 
y_20 = baseline2$simulation$y 
inv_20 = baseline2$simulation$inv 
cons_20 = baseline2$simulation$cons 
gov_20 = baseline2$simulation$gov 
inv_green_20 = baseline2$simulation$inv_green
inv_brown_20 = baseline2$simulation$inv_brown
carbon_tax_green_20 = baseline2$simulation$carbon_tax_green
yd_r_green_20 = baseline2$simulation$yd_r_green
yd_r_brown_20 = baseline2$simulation$yd_r_brown
t_green_20 = baseline2$simulation$t_green
t_brown_20 = baseline2$simulation$t_brown
cons_20 = baseline2$simulation$cons 
cons_brown_20 = baseline2$simulation$cons_brown 
cons_green_20 = baseline2$simulation$cons_green  
emis_l_20 = baseline2$simulation$emis_l
xr_brown_20 = baseline2$simulation$xr_brown
p_e_green_20 = baseline2$simulation$p_e_green
p_e_brown_20 = baseline2$simulation$p_e_brown
emis_brown_20 = baseline2$simulation$emis_brown
emis_green_20 = baseline2$simulation$emis_green
beta_brown0_20 = baseline2$simulation$beta_brown0
beta_brown_20 = baseline2$simulation$beta_brown
en_brown_20 = baseline2$simulation$en_brown
emis_20 = baseline2$simulation$emis
emis_l_20 = baseline2$simulation$emis_l
y_green_20 = baseline2$simulation$y_green
y_brown_20 = baseline2$simulation$y_brown
x_brown_20 = baseline2$simulation$x_brown
im_brown_20 = baseline2$simulation$im_brown
k_gr_green_20 = baseline2$simulation$k_gr_green
k_green_20 = baseline2$simulation$k_green
k_brown_20 = baseline2$simulation$k_brown
yd_w_brown_20 = baseline2$simulation$yd_w_brown
yd_w_green_20 = baseline2$simulation$yd_w_green


im_brown_20 - x_brown_20
b_brownbrown_d_20 = baseline2$simulation$b_brownbrown_d


x_brown_20 = baseline2$simulation$x_brown
1000000000000*x_brown_20
im_brown_20 = baseline2$simulation$im_brown


beta_gr_green_20 = baseline2$simulation$beta_gr_green
beta_gr_brown_20 = baseline2$simulation$beta_gr_brown

mu_brown_20 = baseline2$simulation$mu_brown # Ser ud til det er dem her der laver faldet i udledningen 
epsilon_brown_20 = baseline2$simulation$epsilon_brown # Ser ud til det er dem her der laver faldet i udledningen 
eta_brown_20 = baseline2$simulation$eta_brown # Ser ud til det er dem her der laver faldet i udledningen 

x_gr_brown_20 = baseline2$simulation$x_gr_brown
x_con_brown_20 = baseline2$simulation$x_con_brown
im_con_green_20 = baseline2$simulation$im_con_green
im_gr_green_20 = baseline2$simulation$im_gr_green
inv_gr_green_20 = baseline2$simulation$inv_gr_green
gov_tot_green_20 = baseline2$simulation$gov_tot_green
gov_tot_brown_20 = baseline2$simulation$gov_tot_brown
carbon_tax_brown_20 = baseline2$simulation$carbon_tax_brown
temp_at_20 = baseline2$simulation$temp_at
cons_r_green_20 = baseline2$simulation$cons_r_green
cons_r_brown_20 = baseline2$simulation$cons_r_brown
v_r_green_20 = baseline2$simulation$v_r_green
v_r_brown_20 = baseline2$simulation$v_r_brown

cons_w_green_20 = baseline2$simulation$cons_w_green
cons_w_brown_20 = baseline2$simulation$cons_w_brown
v_w_green_20 = baseline2$simulation$v_w_green
v_w_brown_20 = baseline2$simulation$v_w_brown


carbon_tax_brown_20 = baseline2$simulation$carbon_tax_brown


gov_gr_inv_brown_20 = baseline2$simulation$gov_gr_inv_brown


k_gr_green_20 = baseline2$simulation$k_gr_green
k_con_green_20 = baseline2$simulation$k_con_green
k_gr_im_green_20 = baseline2$simulation$k_gr_im_green
k_green_20 = baseline2$simulation$k_green


k_gr_green_20/k_green_20 + k_gr_im_green_20/k_green_20 + k_con_green_20/k_green_20 # Skal give 1 


k_gr_brown_20 = baseline2$simulation$k_gr_brown
k_con_brown_20 = baseline2$simulation$k_con_brown
k_gr_im_brown_20 = baseline2$simulation$k_gr_im_brown
k_brown_20 = baseline2$simulation$k_brown

yd_r_brown_20 = baseline2$simulation$yd_r_brown


k_gr_brown_20/k_brown_20 + k_gr_im_brown_20/k_brown_20 + k_con_brown_20/k_brown_20 # Skal give 1 


inv_con_brown_20 = baseline2$simulation$inv_con_brown
inv_gr_im_brown_20 = baseline2$simulation$inv_gr_im_brown
inv_gr_brown_t_20 = baseline2$simulation$inv_gr_brown_t
inv_gr_brown_20 = baseline2$simulation$inv_gr_brown
inv_brown_20 = baseline2$simulation$inv_brown

d_t_brown_20 = baseline2$simulation$d_t_brown
v_w_brown_20 = baseline2$simulation$v_w_brown
v_r_brown_20 = baseline2$simulation$v_r_brown

inv_con_brown_20 + inv_gr_im_brown_20 + inv_gr_brown_20 - inv_brown_20 # Skal give 0

(chi1_brown*gov_gr_inv_brown_20+chi2_brown*y_brown_20 + chi3_brown*TSLAG(d_t_brown_20,1))

inv_gr_brown_t_20 + inv_gr_im_brown_20 > inv_brown_20

(inv_gr_brown_20 + inv_gr_im_brown_20)/inv_brown_20
inv_con_brown_20/inv_brown_20

inv_gr_brown_t_20 > inv_brown_20

inv_con_green_20 = baseline2$simulation$inv_con_green
inv_gr_im_green_20 = baseline2$simulation$inv_gr_im_green
inv_gr_green_20 = baseline2$simulation$inv_gr_green
inv_green_20 = baseline2$simulation$inv_green

inv_con_green_20 + inv_gr_im_green_20 + inv_gr_green_20 - inv_green_20 # Skal give 0

inv_gr_green_20/inv_green_20
inv_con_green_20/inv_green_20

y_brown_20
cons_r_brown_20 + cons_w_brown_20 + gov_tot_brown_20 + x_brown_20 - im_brown_20 + inv_brown_20

gov_con_brown_20 = baseline2$simulation$gov_con_brown


share_x_brown_20 = baseline2$simulation$share_x_brown
share_tech_brown_20 = baseline2$simulation$share_tech_brown
share_dev_brown_20 = baseline2$simulation$share_dev_brown

###########
y_r_brown_20 = baseline2$simulation$y_r_brown
f_brown_20 = baseline2$simulation$f_brown
fu_brown_20 = baseline2$simulation$fu_brown


f_bank_brown_20 = baseline2$simulation$f_bank_brown # Bankers profit er negativ
b_brown_bank_20 = baseline2$simulation$b_brown_bank # Meget høj!
l_s_brown_20 = baseline2$simulation$l_s_brown # Negativ lån!!!



b_brownbrown_s_20 = baseline2$simulation$b_brownbrown_s

b_browngreen_s_20 = baseline2$simulation$b_browngreen_s

f_d_brownbrown_20 = baseline2$simulation$f_d_brownbrown

f_d_browngreen_20 = baseline2$simulation$f_d_browngreen

e_greenbrown_s_20 = baseline2$simulation$e_greenbrown_s


###### DEMAND FOR FINANCIAL ASSETS (PORTFOLIO EQUATIONS)

b_brownbrown_d_20 = baseline2$simulation$b_brownbrown_d

b_browngreen_d_20 = baseline2$simulation$b_browngreen_d

b_greenbrown_d_20 = baseline2$simulation$b_greenbrown_d # Skal være lavere:  Bills issued by Brownland acquired by Greenland: demand

b_greengreen_d_20 = baseline2$simulation$b_greengreen_d

e_brownbrown_d_20 = baseline2$simulation$e_brownbrown_d

e_browngreen_d_20 = baseline2$simulation$e_browngreen_d

e_greenbrown_d_20 = baseline2$simulation$e_greenbrown_d # Skal være lavere: Brownland shares held by Greenland capitalists

e_greengreen_d_20 = baseline2$simulation$e_greengreen_d

x_gr_brown_20 = baseline2$simulation$x_gr_brown
x_brown_20 = baseline2$simulation$x_brown

x_gr_brown_20/x_brown_20

# co2 intensity

beta_green_20 = baseline2$simulation$beta_green
en_brown_20 = baseline2$simulation$en_brown
en_green_20 = baseline2$simulation$en_green
e_brown_20 = baseline2$simulation$e_brown
er_brown_20 = baseline2$simulation$er_brown
epsilon_brown_20 = baseline2$simulation$epsilon_brown

beta_brown0 + beta_brown_20*en_brown_20 >= (emis_20-emis_l_20)*emis_ob_dk_s


###### Calibration tests

x_gr_green_20/x_green_20
x_gr_brown_20/x_brown_20


inv_gr_rd_brown_20/inv_brown_20
inv_gr_rd_green_20/inv_green_20


eta_gr_impv_brown_20
eta_gr_impv_green_20

## Stability check
h_brown_h_20 = baseline2$simulation$h_brown_h
h_brown_s_20 = baseline2$simulation$h_brown_s
h_green_h_20 = baseline2$simulation$h_green_h
h_green_s_20 = baseline2$simulation$h_green_s

plot(h_brown_h_20-h_brown_s_20)   
plot(h_green_h_20-h_green_s_20) 
```

## Baseline 3: Narrowly Strong PH


```{r}
Narrowly_strong_PH_model=Narrowly_strong_PH %>% window(start= c(1960,1))
```

```{r}
# Define add-factor list (defining shock)
constantAdjList_B3 <- list(
  
Narrowly_strong_PH = TIMESERIES(Narrowly_strong_PH_model+1 ,START=c(1960,1),  FREQ=1),
Weak_PH = TIMESERIES(Weak_PH_model+1 ,START=c(1960,1),  FREQ=1)

)

```

```{r}
baseline3 <- SIMULATE(S_model
                    ,simType='FORECAST'
                    ,TSRANGE=c(1961,1,2060,1)
                    ,simConvergence=0.00001
                    ,simIterLimit=100
                    ,ConstantAdjustment = constantAdjList_B3
                    )
```

```{r}

inv_gr_rd_brown_30= baseline3$simulation$inv_gr_rd_brown
inv_gr_rd_green_30= baseline3$simulation$inv_gr_rd_green
im_green_30= baseline3$simulation$im_green
gov_gr_brown_30= baseline3$simulation$gov_gr_brown
x_green_30= baseline3$simulation$x_green
d_t_brown_30= baseline3$simulation$d_t_brown
############### Validering ################

yd_hs_r_brown_30 = baseline3$simulation$yd_hs_r_brown
window(yd_hs_r_brown_30, start= 2016)


f_m_brown_30 = baseline3$simulation$f_m_brown

window(f_m_brown_30, start= 2016)

f_brown_30 = baseline3$simulation$f_brown
window(f_brown_30, start= 2016)

da_brown_30 = baseline3$simulation$da_brown
window(da_brown_30, start= 2016)

l_firm_brown_30 = baseline3$simulation$l_firm_brown
window(l_firm_brown_30, start= 2016)


e_browngreen_d_30= baseline3$simulation$e_browngreen_d
window(e_browngreen_d_30, start= 2016)
e_greenbrown_d_30= baseline3$simulation$e_greenbrown_d
window(e_greenbrown_d_30, start= 2016)

b_browngreen_d_30= baseline3$simulation$b_browngreen_d
window(b_browngreen_d_30, start= 2016)
b_greenbrown_d_30= baseline3$simulation$b_greenbrown_d
window(b_greenbrown_d_30, start= 2016)

#############  Slut #####################
eta_im_gr_green_30= baseline3$simulation$eta_im_gr_green
eta_im_gr_brown_30= baseline3$simulation$eta_im_gr_brown
eta_gr_brown_30 = baseline3$simulation$eta_gr_brown
eta_gr_brown_t_30 = baseline3$simulation$eta_gr_brown_t
eta_gr_green_30 = baseline3$simulation$eta_gr_green
eta_green_30= baseline3$simulation$eta_green
eta_gr_impv_green_30 = baseline3$simulation$eta_gr_impv_green

eta_gr_impv_brown_30 = baseline3$simulation$eta_gr_impv_brown

gov_gr_rd_brown_30 = baseline3$simulation$gov_gr_rd_brown
gov_gr_rd_green_30 = baseline3$simulation$gov_gr_rd_green


########### Grøn eksport ###########

x_gr_brown_30 = baseline3$simulation$x_gr_brown



x_brown_30 = baseline3$simulation$x_brown

x_gr_brown_30/x_brown_30
x_gr_brown_20/x_brown_20


x_gr_brown_30 = baseline3$simulation$x_gr_brown

x_brown_30 = baseline3$simulation$x_brown

im_gr_brown_30 = baseline3$simulation$im_gr_brown

im_brown_30 = baseline3$simulation$im_brown

im_gr_brown_30/im_brown_30

######## Patent ####################

eta_gr_brown_30 = baseline3$simulation$eta_gr_brown
eta_gr_green_30 = baseline3$simulation$eta_gr_green

eta_avg_gr_brown_30 = baseline3$simulation$eta_avg_gr_brown
eta_avg_gr_green_30 = baseline3$simulation$eta_avg_gr_green

eta_brown_30 = baseline3$simulation$eta_brown

growth_eta_gr_brown_30 = baseline3$simulation$growth_eta_gr_brown

inv_gr_brown_30 = baseline3$simulation$inv_gr_brown
inv_gr_green_30 = baseline3$simulation$inv_gr_green

inv_brown_30 = baseline3$simulation$inv_brown
inv_green_30 = baseline3$simulation$inv_green


gov_gr_rd_brown_30 = baseline3$simulation$gov_gr_rd_brown

####### difference in beta values #################


spill_browngreen_30 = baseline3$simulation$spill_browngreen
spill_greenbrown_30 = baseline3$simulation$spill_greenbrown

beta_avg_gr_green_30 = baseline3$simulation$beta_avg_gr_green
beta_avg_gr_brown_30 = baseline3$simulation$beta_avg_gr_brown

beta_gr_brown_30 = baseline3$simulation$beta_gr_brown
beta_con_green_30 = baseline3$simulation$beta_con_green

beta_im_gr_green_30 = baseline3$simulation$beta_im_gr_green
beta_im_gr_brown_30 = baseline3$simulation$beta_im_gr_brown

rel_beta_brown_30 = baseline3$simulation$rel_beta_brown
rel_beta_green_30 = baseline3$simulation$rel_beta_green
rel_gr_beta_30 = baseline3$simulation$rel_gr_beta

im_brown_30= baseline3$simulation$im_brown
x_gr_brown_30 = baseline3$simulation$x_gr_brown
x_gr_green_30 = baseline3$simulation$x_gr_green

k_gr_green_30 = baseline3$simulation$k_gr_green

share_im_gr_brown_30 = baseline3$simulation$share_im_gr_brown
share_x_gr_brown_30 = baseline3$simulation$share_x_gr_brown
##### Emission intensity #####

beta_con_brown_30 = baseline3$simulation$beta_con_brown
beta_gr_brown_30 = baseline3$simulation$beta_gr_brown

eta_con_brown_30 = baseline3$simulation$eta_con_brown
eta_gr_brown_30 = baseline3$simulation$eta_gr_brown

mu_con_brown_30 = baseline3$simulation$mu_con_brown
mu_gr_brown_30 = baseline3$simulation$mu_gr_brown

epsilon_con_brown_30 = baseline3$simulation$epsilon_con_brown
epsilon_gr_brown_30 = baseline3$simulation$epsilon_gr_brown



er_green_30 = baseline3$simulation$er_green
er_brown_30 = baseline3$simulation$er_brown

e_green_30 = baseline3$simulation$e_green
e_brown_30 = baseline3$simulation$e_brown

epsilon_green_30 = baseline3$simulation$epsilon_green
epsilon_brown_30 = baseline3$simulation$epsilon_brown

delta_green_30 = baseline3$simulation$delta_green
delta_brown_30 = baseline3$simulation$delta_brown
y_r_green_30 = baseline3$simulation$y_r_green
fd_brown_30 = baseline3$simulation$fd_brown
da_green_30 = baseline3$simulation$da_green
da_brown_30 = baseline3$simulation$da_brown
af_brown_30 = baseline3$simulation$af_brown
f_m_brown_30 = baseline3$simulation$f_m_brown
e_brownbrown_s_30 = baseline3$simulation$e_brownbrown_s 
l_firm_brown_30 = baseline3$simulation$l_firm_brown 
y_30 = baseline3$simulation$y 
inv_30 = baseline3$simulation$inv 
cons_30 = baseline3$simulation$cons 
gov_30 = baseline3$simulation$gov 
inv_green_30 = baseline3$simulation$inv_green
inv_brown_30 = baseline3$simulation$inv_brown
carbon_tax_green_30 = baseline3$simulation$carbon_tax_green
yd_r_green_30 = baseline3$simulation$yd_r_green
yd_r_brown_30 = baseline3$simulation$yd_r_brown
t_green_30 = baseline3$simulation$t_green
t_brown_30 = baseline3$simulation$t_brown
cons_30 = baseline3$simulation$cons 
cons_brown_30 = baseline3$simulation$cons_brown 
cons_green_30 = baseline3$simulation$cons_green  
emis_l_30 = baseline3$simulation$emis_l
xr_brown_30 = baseline3$simulation$xr_brown
p_e_green_30 = baseline3$simulation$p_e_green
p_e_brown_30 = baseline3$simulation$p_e_brown
emis_brown_30 = baseline3$simulation$emis_brown
emis_green_30 = baseline3$simulation$emis_green
beta_brown0_30 = baseline3$simulation$beta_brown0
beta_brown_30 = baseline3$simulation$beta_brown
en_brown_30 = baseline3$simulation$en_brown
emis_30 = baseline3$simulation$emis
emis_l_30 = baseline3$simulation$emis_l
y_green_30 = baseline3$simulation$y_green
y_brown_30 = baseline3$simulation$y_brown
x_brown_30 = baseline3$simulation$x_brown
im_brown_30 = baseline3$simulation$im_brown
k_gr_green_30 = baseline3$simulation$k_gr_green
k_green_30 = baseline3$simulation$k_green
k_brown_30 = baseline3$simulation$k_brown
yd_w_brown_30 = baseline3$simulation$yd_w_brown
yd_w_green_30 = baseline3$simulation$yd_w_green
yd_w_green_30

im_brown_30 - x_brown_30
b_brownbrown_d_30 = baseline3$simulation$b_brownbrown_d


x_brown_30 = baseline3$simulation$x_brown
1000000000000*x_brown_30
im_brown_30 = baseline3$simulation$im_brown


beta_gr_green_30 = baseline3$simulation$beta_gr_green
beta_gr_brown_30 = baseline3$simulation$beta_gr_brown

mu_brown_30 = baseline3$simulation$mu_brown # Ser ud til det er dem her der laver faldet i udledningen 
epsilon_brown_30 = baseline3$simulation$epsilon_brown # Ser ud til det er dem her der laver faldet i udledningen 
eta_brown_30 = baseline3$simulation$eta_brown # Ser ud til det er dem her der laver faldet i udledningen 

x_gr_brown_30 = baseline3$simulation$x_gr_brown
x_con_brown_30 = baseline3$simulation$x_con_brown
im_con_green_30 = baseline3$simulation$im_con_green
im_gr_green_30 = baseline3$simulation$im_gr_green
inv_gr_green_30 = baseline3$simulation$inv_gr_green
gov_tot_green_30 = baseline3$simulation$gov_tot_green
gov_tot_brown_30 = baseline3$simulation$gov_tot_brown
carbon_tax_brown_30 = baseline3$simulation$carbon_tax_brown
temp_at_30 = baseline3$simulation$temp_at
cons_r_green_30 = baseline3$simulation$cons_r_green
cons_r_brown_30 = baseline3$simulation$cons_r_brown
v_r_green_30 = baseline3$simulation$v_r_green
v_r_brown_30 = baseline3$simulation$v_r_brown

cons_w_green_30 = baseline3$simulation$cons_w_green
cons_w_brown_30 = baseline3$simulation$cons_w_brown
v_w_green_30 = baseline3$simulation$v_w_green
v_w_brown_30 = baseline3$simulation$v_w_brown


carbon_tax_brown_30 = baseline3$simulation$carbon_tax_brown


gov_gr_inv_brown_30 = baseline3$simulation$gov_gr_inv_brown


k_gr_green_30 = baseline3$simulation$k_gr_green
k_con_green_30 = baseline3$simulation$k_con_green
k_gr_im_green_30 = baseline3$simulation$k_gr_im_green
k_green_30 = baseline3$simulation$k_green


k_gr_green_30/k_green_30 + k_gr_im_green_30/k_green_30 + k_con_green_30/k_green_30 # Skal give 1 


k_gr_brown_30 = baseline3$simulation$k_gr_brown
k_con_brown_30 = baseline3$simulation$k_con_brown
k_gr_im_brown_30 = baseline3$simulation$k_gr_im_brown
k_brown_30 = baseline3$simulation$k_brown

yd_r_brown_30 = baseline3$simulation$yd_r_brown


k_gr_brown_30/k_brown_30 + k_gr_im_brown_30/k_brown_30 + k_con_brown_30/k_brown_30 # Skal give 1 


inv_con_brown_30 = baseline3$simulation$inv_con_brown
inv_gr_im_brown_30 = baseline3$simulation$inv_gr_im_brown
inv_gr_brown_t_30 = baseline3$simulation$inv_gr_brown_t
inv_gr_brown_30 = baseline3$simulation$inv_gr_brown
inv_brown_30 = baseline3$simulation$inv_brown

d_t_brown_30 = baseline3$simulation$d_t_brown
v_w_brown_30 = baseline3$simulation$v_w_brown
v_r_brown_30 = baseline3$simulation$v_r_brown

inv_con_brown_30 + inv_gr_im_brown_30 + inv_gr_brown_30 - inv_brown_30 # Skal give 0

(chi1_brown*gov_gr_inv_brown_30+chi2_brown*y_brown_30 + chi3_brown*TSLAG(d_t_brown_30,1))

inv_gr_brown_t_30 + inv_gr_im_brown_30 > inv_brown_30

(inv_gr_brown_30 + inv_gr_im_brown_30)/inv_brown_30
inv_con_brown_30/inv_brown_30

inv_gr_brown_t_30 > inv_brown_30

inv_con_green_30 = baseline3$simulation$inv_con_green
inv_gr_im_green_30 = baseline3$simulation$inv_gr_im_green
inv_gr_green_30 = baseline3$simulation$inv_gr_green
inv_green_30 = baseline3$simulation$inv_green

inv_con_green_30 + inv_gr_im_green_30 + inv_gr_green_30 - inv_green_30 # Skal give 0

inv_gr_green_30/inv_green_30
inv_con_green_30/inv_green_30

y_brown_30
cons_r_brown_30 + cons_w_brown_30 + gov_tot_brown_30 + x_brown_30 - im_brown_30 + inv_brown_30

gov_con_brown_30 = baseline3$simulation$gov_con_brown


share_x_brown_30 = baseline3$simulation$share_x_brown
share_tech_brown_30 = baseline3$simulation$share_tech_brown
share_dev_brown_30 = baseline3$simulation$share_dev_brown

###########
y_r_brown_30 = baseline3$simulation$y_r_brown
f_brown_30 = baseline3$simulation$f_brown
fu_brown_30 = baseline3$simulation$fu_brown


f_bank_brown_30 = baseline3$simulation$f_bank_brown # Bankers profit er negativ
b_brown_bank_30 = baseline3$simulation$b_brown_bank # Meget høj!
l_s_brown_30 = baseline3$simulation$l_s_brown # Negativ lån!!!



b_brownbrown_s_30 = baseline3$simulation$b_brownbrown_s

b_browngreen_s_30 = baseline3$simulation$b_browngreen_s

f_d_brownbrown_30 = baseline3$simulation$f_d_brownbrown

f_d_browngreen_30 = baseline3$simulation$f_d_browngreen

e_greenbrown_s_30 = baseline3$simulation$e_greenbrown_s


###### DEMAND FOR FINANCIAL ASSETS (PORTFOLIO EQUATIONS)

b_brownbrown_d_30 = baseline3$simulation$b_brownbrown_d

b_browngreen_d_30 = baseline3$simulation$b_browngreen_d

b_greenbrown_d_30 = baseline3$simulation$b_greenbrown_d # Skal være lavere:  Bills issued by Brownland acquired by Greenland: demand

b_greengreen_d_30 = baseline3$simulation$b_greengreen_d

e_brownbrown_d_30 = baseline3$simulation$e_brownbrown_d

e_browngreen_d_30 = baseline3$simulation$e_browngreen_d

e_greenbrown_d_30 = baseline3$simulation$e_greenbrown_d # Skal være lavere: Brownland shares held by Greenland capitalists

e_greengreen_d_30 = baseline3$simulation$e_greengreen_d

x_gr_brown_30 = baseline3$simulation$x_gr_brown
x_brown_30 = baseline3$simulation$x_brown

x_gr_brown_30/x_brown_30

# co2 intensity

beta_green_30 = baseline3$simulation$beta_green
en_brown_30 = baseline3$simulation$en_brown
en_green_30 = baseline3$simulation$en_green
e_brown_30 = baseline3$simulation$e_brown
er_brown_30 = baseline3$simulation$er_brown
epsilon_brown_30 = baseline3$simulation$epsilon_brown

beta_brown0 + beta_brown_30*en_brown_30 >= (emis_30-emis_l_30)*emis_ob_dk_s

## Stability check
h_brown_h_30 = baseline3$simulation$h_brown_h
h_brown_s_30 = baseline3$simulation$h_brown_s
h_green_h_30 = baseline3$simulation$h_green_h
h_green_s_30 = baseline3$simulation$h_green_s

plot(h_brown_h_30-h_brown_s_30)   
plot(h_green_h_30-h_green_s_30) 
```

## Baseline 4 Strong PH


```{r}
Strong_PH_model=Strong_PH %>% window(start= c(1960,1))
```

```{r}
# Define add-factor list (defining shock)
constantAdjList_B4 <- list(
  
Strong_PH = TIMESERIES(Strong_PH_model+1 ,START=c(1960,1),  FREQ=1),
Weak_PH = TIMESERIES(Weak_PH_model+1 ,START=c(1960,1),  FREQ=1),
Narrowly_strong_PH = TIMESERIES(Narrowly_strong_PH_model+1 ,START=c(1960,1),  FREQ=1)

)

```

```{r}
# Simulate the model (following shock)
baseline4 <- SIMULATE(S_model
                    ,simType='FORECAST'
                    ,TSRANGE=c(1961,1,2060,1)
                    ,simConvergence=0.00001
                    ,simIterLimit=100
                    ,ConstantAdjustment = constantAdjList_B4
                    )
```


```{r}
epsilon_green_40= baseline4$simulation$epsilon_green
f_brown_40= baseline4$simulation$f_brown
inv_gr_rd_brown_40= baseline4$simulation$inv_gr_rd_brown
x_gr_green_40= baseline4$simulation$x_gr_green
im_green_40= baseline4$simulation$im_green
eta_im_gr_brown_40 = baseline4$simulation$eta_im_gr_brown
eta_brown_40= baseline4$simulation$eta_brown

eta_im_gr_green_40 = baseline4$simulation$eta_im_gr_green
eta_green_40= baseline4$simulation$eta_green
d_t_brown_40= baseline4$simulation$d_t_brown
gov_gr_rd_brown_40= baseline4$simulation$gov_gr_rd_brown
gov_gr_brown_40= baseline4$simulation$gov_gr_brown

########### TEST ##########
xr_brown_40 = baseline4$simulation$xr_brown

########## Test færdsig ##############

epsilon_brown_40 = baseline4$simulation$epsilon_brown

share_x_brown_40 = baseline4$simulation$share_x_brown
share_tech_brown_40 = baseline4$simulation$share_tech_brown
share_dev_brown_40 = baseline4$simulation$share_dev_brown


rel_gr_beta_40 = baseline4$simulation$rel_gr_beta


eta_gr_brown_40 = baseline4$simulation$eta_gr_brown
eta_gr_green_40 = baseline4$simulation$eta_gr_green

eta_avg_gr_green_40 = baseline4$simulation$eta_avg_gr_green
eta_avg_gr_brown_40 = baseline4$simulation$eta_avg_gr_brown

beta_gr_green_40 = baseline4$simulation$beta_gr_green
beta_avg_gr_green_40 = baseline4$simulation$beta_avg_gr_green
beta_con_green_40 = baseline4$simulation$beta_con_green
beta_im_gr_green_40 = baseline4$simulation$beta_im_gr_green

cons_r_green_40 = baseline4$simulation$cons_r_green
cons_r_brown_40 = baseline4$simulation$cons_r_brown
cons_w_green_40 = baseline4$simulation$cons_w_green
cons_w_brown_40 = baseline4$simulation$cons_w_brown

cons_green_40 = baseline4$simulation$cons_green
cons_brown_40 = baseline4$simulation$cons_brown

gov_tot_brown_40 = baseline4$simulation$gov_tot_brown
gov_tot_green_40 = baseline4$simulation$gov_tot_green


yd_w_brown_40 = baseline4$simulation$yd_w_brown
yd_w_green_40 = baseline4$simulation$yd_w_green
yd_r_brown_40 = baseline4$simulation$yd_r_brown
yd_r_green_40 = baseline4$simulation$yd_r_green

v_w_green_40 = baseline4$simulation$v_w_green
v_w_brown_40 = baseline4$simulation$v_w_brown
v_r_green_40 = baseline4$simulation$v_r_green
v_r_brown_40 = baseline4$simulation$v_r_brown

inv_green_40 = baseline4$simulation$inv_green
inv_brown_40 = baseline4$simulation$inv_brown


beta_gr_brown_40 = baseline4$simulation$beta_gr_brown
beta_avg_gr_brown_40 = baseline4$simulation$beta_avg_gr_brown
beta_con_brown_40 = baseline4$simulation$beta_con_brown
beta_im_gr_brown_40 = baseline4$simulation$beta_im_gr_brown


x_gr_brown_40 = baseline4$simulation$x_gr_brown
x_brown_40 = baseline4$simulation$x_brown

im_gr_brown_40 = baseline4$simulation$im_gr_brown
im_brown_40 = baseline4$simulation$im_brown

x_gr_brown_40/x_brown_40
x_gr_brown_10/x_brown_10

im_gr_brown_40/im_brown_40
im_gr_brown_10/im_brown_10

x_green_40 = baseline4$simulation$x_green
y_brown_40 = baseline4$simulation$y_brown
y_green_40 = baseline4$simulation$y_green

# Carbon tax
carbon_tax_brown_40 = baseline4$simulation$carbon_tax_brown
carbon_tax_x_brown_40 = baseline4$simulation$carbon_tax_x_brown
carbon_tax_tech_brown_40 = baseline4$simulation$carbon_tax_tech_brown
carbon_tax_dev_brown_40 = baseline4$simulation$carbon_tax_dev_brown

# Capital

k_gr_brown_40 = baseline4$simulation$k_gr_brown
k_gr_im_brown_40 = baseline4$simulation$k_gr_im_brown
k_con_brown_40 = baseline4$simulation$k_con_brown
k_brown_40 = baseline4$simulation$k_brown

k_gr_green_40 = baseline4$simulation$k_gr_green
k_gr_im_green_40 = baseline4$simulation$k_gr_im_green
k_con_green_40 = baseline4$simulation$k_con_green
k_green_40 = baseline4$simulation$k_green

# Co2 
beta_brown_40 = baseline4$simulation$beta_brown
beta_green_40 = baseline4$simulation$beta_green


# Emission
emis_brown_40 = baseline4$simulation$emis_brown
emis_green_40 = baseline4$simulation$emis_green
emis_40 = baseline4$simulation$emis


x_gr_brown_40 = baseline4$simulation$x_gr_brown
im_gr_brown_40 = baseline4$simulation$im_gr_brown
carbon_tax_brown_40 = baseline4$simulation$carbon_tax_brown
carbon_tax_x_brown_40 = baseline4$simulation$carbon_tax_x_brown
gov_gr_inv_brown_40 = baseline4$simulation$gov_gr_inv_brown
beta_gr_brown_40 = baseline4$simulation$beta_gr_brown



temp_at_40 = baseline4$simulation$temp_at
## Stability check
h_brown_h_40 = baseline4$simulation$h_brown_h
h_brown_s_40 = baseline4$simulation$h_brown_s
h_green_h_40 = baseline4$simulation$h_green_h
h_green_s_40 = baseline4$simulation$h_green_s

plot(h_brown_h_40-h_brown_s_40)   
plot(h_green_h_40-h_green_s_40)  
```





## Validate baselines


```{r, fig.width= 10, fig.height= 7}

par(mfrow=c(2,2))
plot((k_gr_brown_10/k_brown_10*100), col= "Black", xlab= "Year", ylab= "Distribution of capital", main= "Baseline 1 capital Brown", ylim= c(0,100));
lines((k_gr_im_brown_10/k_brown_10*100), col= "green");
lines((k_con_brown_10/k_brown_10*100), col= "red");
legend("left", legend=c("Green capital","Imported Green capital","Conventional capital"),
       lty=c(1),lwd=c(2),bty="n", col = c("Black","green", "red"));
grid()

plot((k_gr_brown_20/k_brown_20*100), col= "Black", xlab= "Year", ylab= "Distribution of capital", main= "Baseline 2 capital Brown", ylim= c(0,100));
lines((k_gr_im_brown_20/k_brown_20*100), col= "green");
lines((k_con_brown_20/k_brown_20*100), col= "red");
legend("left", legend=c("Green capital","Imported Green capital","Conventional capital"),
       lty=c(1),lwd=c(2),bty="n", col = c("Black","green", "red"));
grid()


plot((k_gr_brown_30/k_brown_30*100), col= "Black", xlab= "Year", ylab= "Distribution of capital", main= "Baseline 1 capital Brown", ylim= c(0,100));
lines((k_gr_im_brown_30/k_brown_30*100), col= "green");
lines((k_con_brown_30/k_brown_30*100), col= "red");
legend("left", legend=c("Green capital","Imported Green capital","Conventional capital"),
       lty=c(1),lwd=c(2),bty="n", col = c("Black","green", "red"));
grid()

plot((k_gr_brown_40/k_brown_40*100), col= "Black", xlab= "Year", ylab= "Distribution of capital", main= "Baseline 2 capital Brown", ylim= c(0,100));
lines((k_gr_im_brown_40/k_brown_40*100), col= "green");
lines((k_con_brown_40/k_brown_40*100), col= "red");
legend("left", legend=c("Green capital","Imported Green capital","Conventional capital"),
       lty=c(1),lwd=c(2),bty="n", col = c("Black","green", "red"));
grid()
```


```{r, fig.width= 10, fig.height= 7}
par(mfrow=c(2,2))

plot((k_gr_green_10/k_green_10*100), col= "Black", xlab= "Year", ylab= "Distribution of capital", main= "Baseline 1 capital Green", ylim= c(0,100));
lines((k_gr_im_green_10/k_green_10*100), col= "green");
lines((k_con_green_10/k_green_10*100), col= "red");
legend("left", legend=c("Green capital","Imported Green capital","Conventional capital"),
       lty=c(1),lwd=c(2),bty="n", col = c("Black","green", "red"));
grid()

plot((k_gr_green_20/k_green_20*100), col= "Black", xlab= "Year", ylab= "Distribution of capital", main= "Baseline 2 capital Green", ylim= c(0,100));
lines((k_gr_im_green_20/k_green_20*100), col= "green");
lines((k_con_green_20/k_green_20*100), col= "red");
legend("left", legend=c("Green capital","Imported Green capital","Conventional capital"),
       lty=c(1),lwd=c(2),bty="n", col = c("Black","green", "red"));
grid()

plot((k_gr_green_30/k_green_30*100), col= "Black", xlab= "Year", ylab= "Distribution of capital", main= "Baseline 1 capital Green", ylim= c(0,100));
lines((k_gr_im_green_30/k_green_30*100), col= "green");
lines((k_con_green_30/k_green_30*100), col= "red");
legend("left", legend=c("Green capital","Imported Green capital","Conventional capital"),
       lty=c(1),lwd=c(2),bty="n", col = c("Black","green", "red"));
grid()

plot((k_gr_green_40/k_green_40*100), col= "Black", xlab= "Year", ylab= "Distribution of capital", main= "Baseline 2 capital Green", ylim= c(0,100));
lines((k_gr_im_green_40/k_green_40*100), col= "green");
lines((k_con_green_40/k_green_40*100), col= "red");
legend("left", legend=c("Green capital","Imported Green capital","Conventional capital"),
       lty=c(1),lwd=c(2),bty="n", col = c("Black","green", "red"));
grid()
```



```{r, fig.width= 10, fig.height= 5}

par(mfrow=c(1,2))
plot((y_green_10), col= "black", xlab= "Year", ylab= "GDP green", main= "GDP green", ylim= c(0,150));
lines((y_green_20), col= "red");
lines((y_green_30), col= "blue");
lines((y_green_40), col= "purple4");
lines((y_green), col= "green");
legend("left", legend=c("Baseline 1", "Baseline 2", "Real data"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","green"));
grid()

plot((y_brown_10), col= "black", xlab= "Year", ylab= "GDP Brown", main= "GDP Brown", ylim=c(0,0.6));
lines((y_brown_20), col= "red");
lines((y_brown_30), col= "blue");
lines((y_brown_40), col= "purple4");
lines((y_brown), col= "green");
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4", "Real data"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4","green"));
grid()

```
Grunden til det lille hop ved 2018, ser ud til at være på grund af høj v_r_brown, som påvirkes meget over tid. Grunden til høj v_r_brown ser ud til at være den negative consumption for lønmodtagerne. 

```{r, fig.width= 10, fig.height= 5}

par(mfrow=c(1,2))
plot((cons_r_green_10), col= "black", xlab= "Year", ylab= "Consumption capitalists green", main= "Base 1 Consumption capitalists green", ylim= c(0,150));
lines((cons_r_green_20), col= "red");
lines((cons_r_green_30), col= "blue");
lines((cons_r_green_40), col= "purple4");
lines((cons_r_green), col= "green");
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4", "Real data"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4","green"));
grid()

plot((cons_r_brown_10), col= "black", xlab= "Year", ylab= "Consumption capitalists Brown", main= " Base 1 Consumption capitalists Brown", ylim=c(0,0.2));
lines((cons_r_brown_20), col= "red");
lines((cons_r_brown_30), col= "blue");
lines((cons_r_brown_40), col= "purple4");
lines((cons_r_brown), col= "green");
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4", "Real data"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4","green"));
grid()

```

```{r, fig.width= 10, fig.height= 5}

par(mfrow=c(1,2))
plot((cons_w_green_10), col= "black", xlab= "Year", ylab= "Consumption wage green", main= "Consumption wage green", ylim= c(0,150));
lines((cons_w_green_20), col= "red");
lines((cons_w_green_30), col= "blue");
lines((cons_w_green_40), col= "purple4");
lines((cons_w_green), col= "green");
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4", "Real data"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4","green"));
grid()


plot((cons_w_brown_10), col= "black", xlab= "Year", ylab= "Consumption wage Brown", main= "Consumption wage Brown", ylim=c(0,0.2));
lines((cons_w_brown_20), col= "red");
lines((cons_w_brown_30), col= "blue");
lines((cons_w_brown_40), col= "purple4");
lines((cons_w_brown), col= "green");
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4", "Real data"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4","green"));
grid()


```


```{r, fig.width= 10, fig.height= 5}

par(mfrow=c(1,2))
plot((cons_green_10), col= "black", xlab= "Year", ylab= "Consumption ROW", main= "Consumption ROW", ylim= c(0,150));
lines((cons_green_20), col= "red");
lines((cons_green_30), col= "blue");
lines((cons_green_40), col= "purple4");
lines((cons_ob*(1-cons_ob_dk_s)), col= "green");
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4", "Real data"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4","green"));
grid()


plot((cons_brown_10), col= "black", xlab= "Year", ylab= "Consumption DK", main= "Consumption DK");
lines((cons_brown_20), col= "red");
lines((cons_brown_30), col= "blue");
lines((cons_brown_40), col= "purple4");
lines((cons_ob*cons_ob_dk_s), col= "green");
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4", "Real data"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4","green"));
grid()



```



```{r, fig.width= 10, fig.height= 5}

par(mfrow=c(1,2))

plot((yd_w_green_10), col= "black", xlab= "Year", ylab= "disp income wage green", main= "disp income wage green");
lines((yd_w_green_20), col= "red");
lines((yd_w_green_30), col= "blue");
lines((yd_w_green_40), col= "purple4");
lines((yd_w_green), col= "green");
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4", "Real data"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4","green"));
grid()

plot((yd_w_brown_10), col= "black", xlab= "Year", ylab= "disp income wage brown", main= "disp income wage brown", ylim= c(0,0.4));
lines((yd_w_brown_20), col= "red");
lines((yd_w_brown_30), col= "blue");
lines((yd_w_brown_40), col= "purple4");
lines((yd_w_brown), col= "green");
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4", "Real data"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4","green"));
grid()



```

```{r, fig.width= 10, fig.height= 5}

par(mfrow=c(1,2))

plot((yd_r_green_10), col= "black", xlab= "Year", ylab= "disp income cap green", main= "disp income cap green");
lines((yd_r_green_20), col= "red");
lines((yd_r_green_30), col= "blue");
lines((yd_r_green_40), col= "purple4");
lines((yd_r_green), col= "green");
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4", "Real data"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4","green"));
grid()


plot((yd_r_brown_10), col= "black", xlab= "Year", ylab= "disp income cap brown", main= "disp income cap brown", ylim= c(0,0.1));
lines((yd_r_brown_20), col= "red");
lines((yd_r_brown_30), col= "blue");
lines((yd_r_brown_40), col= "purple4");
lines((yd_r_brown), col= "green");
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4", "Real data"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4","green"));
grid()

```



```{r, fig.width= 10, fig.height= 5}

par(mfrow=c(1,2))
plot((v_w_green_10), col= "black", xlab= "Year", ylab= "wealth cap green", main= "wealth cap green", ylim= c(0,500));
lines((v_w_green_20), col= "red");
lines((v_w_green_30), col= "blue");
lines((v_w_green_40), col= "purple4");
lines((v_w_green), col= "green");
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4", "Real data"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4","green"));
grid()

plot((v_w_brown_10), col= "black", xlab= "Year", ylab= "wealth cap Brown", main= "wealth cap Brown", ylim=c(0,15));
lines((v_w_brown_20), col= "red");
lines((v_w_brown_30), col= "blue");
lines((v_w_brown_40), col= "purple4");
lines((v_w_brown), col= "green");
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4", "Real data"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4","green"));
grid()
```

```{r, fig.width= 10, fig.height= 5}

par(mfrow=c(1,2))
plot((v_r_green_10), col= "black", xlab= "Year", ylab= "wealth worker green", main= "wealth worker green", ylim= c(0,600));
lines((v_r_green_20), col= "red");
lines((v_r_green_30), col= "blue");
lines((v_r_green_40), col= "purple4");
lines((v_r_green), col= "green");
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4", "Real data"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4","green"));
grid()

plot((v_r_brown_10), col= "black", xlab= "Year", ylab= "wealth worker Brown", main= "wealth worker Brown", ylim=c(0,15));
lines((v_r_brown_20), col= "red");
lines((v_r_brown_30), col= "blue");
lines((v_r_brown_40), col= "purple4");
lines((v_r_brown), col= "green");
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4", "Real data"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4","green"));
grid()
```




```{r, fig.width= 10, fig.height= 5}

par(mfrow=c(1,2))
plot((inv_green_10), col= "black", xlab= "Year", ylab= "Investment green", main= "Investment green", ylim= c(0,80));
lines((inv_green_20), col= "red");
lines((inv_green_30), col= "blue");
lines((inv_green_40), col= "purple4");
lines((inv_green), col= "green");
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4", "Real data"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4","green"));
grid()

plot((inv_brown_10), col= "black", xlab= "Year", ylab= "Investment Brown", main= "Investment Brown", ylim=c(0,0.5));
lines((inv_brown_20), col= "red");
lines((inv_brown_30), col= "blue");
lines((inv_brown_40), col= "purple4");
lines((inv_brown), col= "green");
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4", "Real data"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4","green"));
grid()

```

```{r, fig.width= 10, fig.height= 5}

par(mfrow=c(1,2))
plot((k_green_10), col= "black", xlab= "Year", ylab= "Capital green", main= "Capital green", ylim= c(0,200));
lines((k_green_20), col= "red");
lines((k_green_30), col= "blue");
lines((k_green_40), col= "purple4");
lines((k_green), col= "green");
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4", "Real data"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4","green"));
grid()

plot((k_brown_10), col= "black", xlab= "Year", ylab= "Capital Brown", main= "Capital Brown", ylim=c(0,1.6));
lines((k_brown_20), col= "red");
lines((k_brown_30), col= "blue");
lines((k_brown_40), col= "purple4");
lines((k_brown), col= "green");
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4", "Real data"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4","green"));
grid()

```


```{r, fig.width= 10, fig.height= 5}

par(mfrow=c(1,2))
plot((emis_green_10), col= "black", xlab= "Year", ylab= "Emission green", main= "Emission green", ylim= c(0,50));
lines((emis_green_20), col= "red");
lines((emis_green_30), col= "blue");
lines((emis_green_40), col= "purple4");
lines((emis_green), col= "green");
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4", "Real data"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4","green"));
grid()

plot((emis_brown_10), col= "black", xlab= "Year", ylab= "Emission Brown", main= "Emission Brown", ylim=c(0,0.2));
lines((emis_brown_20), col= "red");
lines((emis_brown_30), col= "blue");
lines((emis_brown_40), col= "purple4");
lines((emis_brown), col= "green");
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4", "Real data"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4","green"));
grid()

```



```{r, fig.width= 10, fig.height= 5}

par(mfrow=c(1,2))
plot((gov_tot_green_10), col= "black", xlab= "Year", ylab= "Gov expenditure green", main= "Gov expenditure green", ylim= c(0,50));
lines((gov_tot_green_20), col= "red");
lines((gov_tot_green_30), col= "blue");
lines((gov_tot_green_40), col= "purple4");
lines((gov_tot_green), col= "green");
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4", "Real data"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4","green"));
grid()

plot((gov_tot_brown_10), col= "black", xlab= "Year", ylab= "Gov expenditure Brown", main= "Gov expenditure Brown", ylim=c(0,1));
lines((gov_tot_brown_20), col= "red");
lines((gov_tot_brown_30), col= "blue");
lines((gov_tot_brown_40), col= "purple4");
lines((gov_tot_brown), col= "green");
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4", "Real data"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4","green"));
grid()

```


### Plot used in paper

```{r, fig.width=12, fig.height=7}

par(mfrow=c(2,2))
plot((y_green_10*1000), col= "black", xlab= "Year", ylab= "Billion dollars", main= "GDP in ROW", ylim= c(0,150000), lwd= 2);
lines((y_green_20*1000), col= "red", lwd= 2);
lines((y_green_30*1000), col= "blue", lwd= 2);
lines((y_green_40*1000), col= "purple4", lwd= 2);
lines((y_green*1000), col= "green", lwd= 2);
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4", "Real data"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4","green"));
grid()

plot((y_brown_10*1000), col= "black", xlab= "Year", ylab= "Billion dollars", main= "GDP in DK", ylim=c(0,600), lwd= 2);
lines((y_brown_20*1000), col= "red", lwd= 2);
lines((y_brown_30*1000), col= "blue", lwd= 2);
lines((y_brown_40*1000), col= "purple4", lwd= 2);
lines((y_brown*1000), col= "green", lwd= 2);
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4", "Real data"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4","green"));
grid()

plot((emis_green_10*1000), col= "black", xlab= "Year", ylab= "Million tons Co2", main= "Emission in ROW", ylim= c(0,50000), lwd= 2);
lines((emis_green_20*1000), col= "red", lwd= 2);
lines((emis_green_30*1000), col= "blue", lwd= 2);
lines((emis_green_40*1000), col= "purple4", lwd= 2);
lines((emis_green*1000), col= "green", lwd= 2);
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4", "Real data"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4","green"));
grid()

plot((emis_brown_10*1000), col= "black", xlab= "Year", ylab= "Million tons Co2", main= "Emission in DK", ylim=c(0,200), lwd= 2);
lines((emis_brown_20*1000), col= "red", lwd= 2);
lines((emis_brown_30*1000), col= "blue", lwd= 2);
lines((emis_brown_40*1000), col= "purple4", lwd= 2);
lines((emis_brown*1000), col= "green", lwd= 2);
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4", "Real data"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4","green"));
grid()
```


```{r, fig.width=15, fig.height=10}
par(mfrow=c(3,4))

plot((y_green_10), col= "black", xlab= "Year", ylab= "GDP green", main= "GDP green", ylim= c(0,150));
lines((y_green_20), col= "red");
lines((y_green_30), col= "blue");
lines((y_green_40), col= "purple4");
lines((y_green), col= "green");
legend("left", legend=c("Baseline 1", "Baseline 2", "Real data"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","green"));
grid()

plot((y_brown_10), col= "black", xlab= "Year", ylab= "GDP Brown", main= "GDP Brown", ylim=c(0,0.6));
lines((y_brown_20), col= "red");
lines((y_brown_30), col= "blue");
lines((y_brown_40), col= "purple4");
lines((y_brown), col= "green");
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4", "Real data"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4","green"));
grid()

plot((cons_green_10), col= "black", xlab= "Year", ylab= "Consumption ROW", main= "Consumption ROW", ylim= c(0,150));
lines((cons_green_20), col= "red");
lines((cons_green_30), col= "blue");
lines((cons_green_40), col= "purple4");
lines((cons_ob*(1-cons_ob_dk_s)), col= "green");
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4", "Real data"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4","green"));
grid()


plot((cons_brown_10), col= "black", xlab= "Year", ylab= "Consumption DK", main= "Consumption DK");
lines((cons_brown_20), col= "red");
lines((cons_brown_30), col= "blue");
lines((cons_brown_40), col= "purple4");
lines((cons_ob*cons_ob_dk_s), col= "green");
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4", "Real data"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4","green"));
grid()

plot((inv_green_10), col= "black", xlab= "Year", ylab= "Investment green", main= "Investment green", ylim= c(0,80));
lines((inv_green_20), col= "red");
lines((inv_green_30), col= "blue");
lines((inv_green_40), col= "purple4");
lines((inv_green), col= "green");
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4", "Real data"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4","green"));
grid()

plot((inv_brown_10), col= "black", xlab= "Year", ylab= "Investment Brown", main= "Investment Brown", ylim=c(0,0.5));
lines((inv_brown_20), col= "red");
lines((inv_brown_30), col= "blue");
lines((inv_brown_40), col= "purple4");
lines((inv_brown), col= "green");
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4", "Real data"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4","green"));
grid()

plot((k_green_10), col= "black", xlab= "Year", ylab= "Capital green", main= "Capital green", ylim= c(0,200));
lines((k_green_20), col= "red");
lines((k_green_30), col= "blue");
lines((k_green_40), col= "purple4");
lines((k_green), col= "green");
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4", "Real data"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4","green"));
grid()

plot((k_brown_10), col= "black", xlab= "Year", ylab= "Capital Brown", main= "Capital Brown", ylim=c(0,1.6));
lines((k_brown_20), col= "red");
lines((k_brown_30), col= "blue");
lines((k_brown_40), col= "purple4");
lines((k_brown), col= "green");
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4", "Real data"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4","green"));
grid()

plot((emis_green_10), col= "black", xlab= "Year", ylab= "Emission green", main= "Emission green", ylim= c(0,50));
lines((emis_green_20), col= "red");
lines((emis_green_30), col= "blue");
lines((emis_green_40), col= "purple4");
lines((emis_green), col= "green");
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4", "Real data"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4","green"));
grid()

plot((emis_brown_10), col= "black", xlab= "Year", ylab= "Emission Brown", main= "Emission Brown", ylim=c(0,0.2));
lines((emis_brown_20), col= "red");
lines((emis_brown_30), col= "blue");
lines((emis_brown_40), col= "purple4");
lines((emis_brown), col= "green");
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4", "Real data"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4","green"));
grid()

plot((gov_tot_green_10), col= "black", xlab= "Year", ylab= "Gov expenditure green", main= "Gov expenditure green", ylim= c(0,50));
lines((gov_tot_green_20), col= "red");
lines((gov_tot_green_30), col= "blue");
lines((gov_tot_green_40), col= "purple4");
lines((gov_tot_green), col= "green");
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4", "Real data"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4","green"));
grid()

plot((gov_tot_brown_10), col= "black", xlab= "Year", ylab= "Gov expenditure Brown", main= "Gov expenditure Brown", ylim=c(0,1));
lines((gov_tot_brown_20), col= "red");
lines((gov_tot_brown_30), col= "blue");
lines((gov_tot_brown_40), col= "purple4");
lines((gov_tot_brown), col= "green");
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4", "Real data"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4","green"));
grid()

```


```{r, fig.width= 15, fig.height=7}

par(mfrow=c(1,2))
plot((cons_green_10*1000), col= "black", xlab= "Year", ylab= "Billion dollars", main= "Consumption in ROW", ylim= c(0,150000), lwd= 2);
lines((cons_green_20*1000), col= "red", lwd= 2);
lines((cons_green_30*1000), col= "blue", lwd= 2);
lines((cons_green_40*1000), col= "purple4", lwd= 2);
lines((cons_ob*(1-cons_ob_dk_s)*1000), col= "green", lwd= 2);
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4", "Real data"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4","green"));
grid()


plot((cons_brown_10*1000), col= "black", xlab= "Year", ylab= "Billion dollars", main= "Consumption in DK", lwd= 2);
lines((cons_brown_20*1000), col= "red", lwd= 2);
lines((cons_brown_30*1000), col= "blue", lwd= 2);
lines((cons_brown_40*1000), col= "purple4", lwd= 2);
lines((cons_ob*cons_ob_dk_s*1000), col= "green", lwd= 2);
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4", "Real data"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4","green"));
grid()
```


```{r, fig.width= 15, fig.height=7}

par(mfrow=c(1,2))
plot((k_green_10*1000), col= "black", xlab= "Year", ylab= "Billion dollars", main= "Capital stock in ROW", ylim= c(0,200000), lwd= 2);
lines((k_green_20*1000), col= "red", lwd= 2);
lines((k_green_30*1000), col= "blue", lwd= 2);
lines((k_green_40*1000), col= "purple4", lwd= 2);
lines((k_green*1000), col= "green", lwd= 2);
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4", "Real data"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4","green"));
grid()

plot((k_brown_10*1000), col= "black", xlab= "Year", ylab= "Billion dollars", main= "Capital stock in DK", ylim=c(0,1600), lwd= 2);
lines((k_brown_20*1000), col= "red", lwd= 2);
lines((k_brown_30*1000), col= "blue", lwd= 2);
lines((k_brown_40*1000), col= "purple4", lwd= 2);
lines((k_brown*1000), col= "green", lwd= 2);
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4", "Real data"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4","green"));
grid()
```


```{r, fig.width= 15, fig.height=7}

par(mfrow=c(1,2))
plot((inv_green_10*1000), col= "black", xlab= "Year", ylab= "Billion dollars", main= "Investment in ROW", ylim= c(0,40000), lwd=2);
lines((inv_green_20*1000), col= "red", lwd=2);
lines((inv_green_30*1000), col= "blue", lwd=2);
lines((inv_green_40*1000), col= "purple4", lwd=2);
lines((inv_green*1000), col= "green", lwd=2);
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4", "Real data"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4","green"));
grid()

plot((inv_brown_10*1000), col= "black", xlab= "Year", ylab= "Billion dollars", main= "Investment in DK", ylim=c(0,300), lwd=2);
lines((inv_brown_20*1000), col= "red", lwd=2);
lines((inv_brown_30*1000), col= "blue", lwd=2);
lines((inv_brown_40*1000), col= "purple4", lwd=2);
lines((inv_brown*1000), col= "green", lwd=2);
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4", "Real data"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4","green"));
grid()
```


```{r, fig.width=10, fig.height=10}
par(mfrow=c(4,2))
plot(h_brown_h_10-h_brown_s_10, col= "black", xlab= "Year", ylab= "h_DK_h-h_DK_s", main= "Redundant equation Scenario 1 DK", ylim=c(-2,2))

plot(h_green_h_10-h_green_s_10, col= "black", xlab= "Year", ylab= "h_ROW_h-h_ROW_s", main= "Redundant equation Scenario 1 ROW", ylim=c(-2,2))

plot(h_brown_h_20-h_brown_s_20, col= "black", xlab= "Year", ylab= "h_DK_h-h_DK_s", main= "Redundant equation Scenario 2 DK", ylim=c(-2,2))

plot(h_green_h_20-h_green_s_20, col= "black", xlab= "Year", ylab= "h_ROW_h-h_ROW_s", main= "Redundant equation Scenario 2 ROW", ylim=c(-2,2))

plot(h_brown_h_30-h_brown_s_30, col= "black", xlab= "Year", ylab= "h_DK_h-h_DK_s", main= "Redundant equation Scenario 3 DK", ylim=c(-2,2))


plot(h_green_h_30-h_green_s_30, col= "black", xlab= "Year", ylab= "h_ROW_h-h_ROW_s", main= "Redundant equation Scenario 3 ROW", ylim=c(-2,2))

plot(h_brown_h_40-h_brown_s_40, col= "black", xlab= "Year", ylab= "h_DK_h-h_DK_s", main= "Redundant equation Scenario 4 DK", ylim=c(-2,2))


plot(h_green_h_40-h_green_s_40, col= "black", xlab= "Year", ylab= "h_ROW_h-h_ROW_s", main= "Redundant equation Scenario 4 ROW", ylim=c(-2,2))
```




### Difference should be here

```{r, fig.width= 10, fig.height= 5}

par(mfrow=c(1,2))
plot((x_gr_green_10/x_green_10)*100, col= "black", xlab= "Year", ylab= "Share of green exports", main= "Share of green exports ROW", ylim=c(0,14));
lines((x_gr_green_20/x_green_20)*100, col= "red");
lines((x_gr_green_30/x_green_30)*100, col= "blue");
lines((x_gr_green_40/x_green_40)*100, col= "purple4");
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4"));
grid()

plot((x_gr_brown_10/x_brown_10)*100, col= "black", xlab= "Year", ylab= "Share of green exports", main= "Share of green exports DK", ylim= c(0,14));
lines((x_gr_brown_20/x_brown_20)*100, col= "red");
lines((x_gr_brown_30/x_brown_30)*100, col= "blue");
lines((x_gr_brown_40/x_brown_40)*100, col= "purple4");
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4"));
grid()

```

```{r, fig.width= 10, fig.height= 5}

par(mfrow=c(1,2))
plot((x_green_10), col= "black", xlab= "Year", ylab= "Share of green exports", main= "Total exports ROW");
lines((x_green_20), col= "red");
lines((x_green_30), col= "blue");
lines((x_green_40), col= "purple4");
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4"));
grid()

plot(x_brown_10, col= "black", xlab= "Year", ylab= "Share of green exports", main= "Total exports DK");
lines(x_brown_20, col= "red");
lines(x_brown_30, col= "blue");
lines(x_brown_40, col= "purple4");
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4"));
grid()

```


```{r, fig.width= 10, fig.height= 5}

par(mfrow=c(1,2))
plot((eta_gr_green_10), col= "black", xlab= "Year", ylab= "Share of green exports", main= "Renewability share ROW");
lines((eta_gr_green_20), col= "red");
lines((eta_gr_green_30), col= "blue");
lines((eta_gr_green_40), col= "purple4");
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4"));
grid()

plot(eta_gr_brown_10, col= "black", xlab= "Year", ylab= "Share of green exports", main= "Renewability share DK");
lines(eta_gr_brown_20, col= "red");
lines(eta_gr_brown_30, col= "blue");
lines(eta_gr_brown_40, col= "purple4");
legend("left", legend=c("Baseline 1", "Baseline 2","Baseline 3", "Baseline 4"),
       lty=c(1),lwd=c(2),bty="n", col = c("black", "red","blue", "purple4"));
grid()



```


**Calculating avg growth rate of share of renewable energy** 

```{r}
S_renew_data=c(14.839,	15.955,	16.332,	17.747,	18.543,	19.948,	21.888,	23.389,	25.465,	27.173,	29.310,	30.469,	31.715,	34.387,	35.159,	37.020,	31.681,	34.718)


S_renew_data=TIMESERIES(S_renew_data, START = c(2004, 1))
mean(TSDELTALOG(S_renew_data)) ## Mean growth rate of 5 %

mean(TSDELTALOG(window(eta_brown_10, start=2004, end= 2021)))


```


## Scenario 1

```{r}
carbon_tax_shock_brown_model=carbon_tax_shock_brown %>% window(start= c(2025,1))

```

```{r}
# Define add-factor list (defining shock)
constantAdjList_S1 <- list(
  
carbon_tax_shock_brown = TIMESERIES(carbon_tax_shock_brown_model+1 ,START=c(2025,1),  FREQ=1)

)

```


```{r}
# Simulate the model (following shock)
S_1 <- SIMULATE(S_model
                    ,simType='FORECAST'
                    ,TSRANGE=c(1961,1,2060,1)
                    ,simConvergence=0.00001
                    ,simIterLimit=100
                    ,ConstantAdjustment=constantAdjList_S1
                    )
```


```{r}

epsilon_green_11= S_1$simulation$epsilon_green
f_brown_11= S_1$simulation$f_brown

## Economic variables
cons_w_green_11= S_1$simulation$cons_w_green
cons_r_green_11= S_1$simulation$cons_r_green
im_green_11= S_1$simulation$im_green
inv_green_11= S_1$simulation$inv_green
gov_tot_green_11= S_1$simulation$gov_tot_green
cons_green_11= S_1$simulation$cons_green
cons_brown_11 = S_1$simulation$cons_brown
inv_gr_rd_brown_11= S_1$simulation$inv_gr_rd_brown
k_gr_con_11= S_1$simulation$k_gr_con
y_r_brown_11= S_1$simulation$y_r_brown
yd_r_brown_11 = S_1$simulation$yd_r_brown
inv_gr_brown_11= S_1$simulation$inv_gr_brown
inv_con_brown_11=  S_1$simulation$inv_con_brown
inv_brown_11=  S_1$simulation$inv_brown
inv_gr_im_brown_11=  S_1$simulation$inv_gr_im_brown
inv_gr_rd_green_11= S_1$simulation$inv_gr_rd_green
inv_gr_green_11= S_1$simulation$inv_gr_green
inv_con_green_11=  S_1$simulation$inv_con_green
inv_gr_im_green_11=  S_1$simulation$inv_gr_im_green
inv_gr_brown_t_11 = S_1$simulation$inv_gr_brown_t
gov_gr_inv_brown_11 = S_1$simulation$gov_gr_inv_brown
gov_tot_inv_brown_11 = S_1$simulation$gov_tot_inv_brown
gov_tot_brown_11 = S_1$simulation$gov_tot_brown
gov_con_brown_11 = S_1$simulation$gov_con_brown
yd_r_green_11 = S_1$simulation$yd_r_green
t_green_11 = S_1$simulation$t_green
t_brown_11 = S_1$simulation$t_brown
gov_gr_green_11 = S_1$simulation$gov_gr_green
y_green_11 = S_1$simulation$y_green
y_11 = S_1$simulation$y
inv_gr_green_11 = S_1$simulation$inv_gr_green
k_gr_green_11 = S_1$simulation$k_gr_green
k_con_green_11 = S_1$simulation$k_con_green
k_gr_im_green_11 = S_1$simulation$k_gr_im_green
k_green_11 = S_1$simulation$k_green
k_gr_brown_11 = S_1$simulation$k_gr_brown
k_con_brown_11 = S_1$simulation$k_con_brown
k_gr_im_brown_11 = S_1$simulation$k_gr_im_brown
k_brown_11 = S_1$simulation$k_brown
y_brown_11 = S_1$simulation$y_brown


## Environmental variables
d_t_brown_11=  S_1$simulation$d_t_brown
d_t_green_11 = S_1$simulation$d_t_green
eta_brown_11 = S_1$simulation$eta_brown
eta_green_11 = S_1$simulation$eta_green
eta_gr_brown_11 = S_1$simulation$eta_gr_brown
eta_gr_green_11 = S_1$simulation$eta_gr_green
eta_gr_impv_green_11 = S_1$simulation$eta_gr_impv_green
eta_gr_impv_brown_11 = S_1$simulation$eta_gr_impv_brown
eta_con_brown_11 = S_1$simulation$eta_con_brown
eta_con_green_11 = S_1$simulation$eta_con_green
eta_avg_gr_green_11 = S_1$simulation$eta_avg_gr_green
eta_avg_gr_brown_11 = S_1$simulation$eta_avg_gr_brown
eta_im_gr_green_11 = S_1$simulation$eta_im_gr_green
eta_im_gr_brown_11 = S_1$simulation$eta_im_gr_brown


epsilon_brown_11=  S_1$simulation$epsilon_brown

gov_gr_rd_brown_11 = S_1$simulation$gov_gr_rd_brown
gov_gr_rd_green_11 = S_1$simulation$gov_gr_rd_green
gov_gr_brown_11= S_1$simulation$gov_gr_brown

beta_gr_green_11 = S_1$simulation$beta_gr_green
beta_gr_brown_11 = S_1$simulation$beta_gr_brown
beta_con_brown_11 = S_1$simulation$beta_con_brown
beta_con_green_11 = S_1$simulation$beta_con_green
beta_avg_gr_green_11 = S_1$simulation$beta_avg_gr_green
beta_avg_gr_brown_11 = S_1$simulation$beta_avg_gr_brown
beta_im_gr_green_11 = S_1$simulation$beta_im_gr_green
beta_im_gr_brown_11 = S_1$simulation$beta_im_gr_brown
beta_brown_11 = S_1$simulation$beta_brown
beta_green_11 = S_1$simulation$beta_green

emis_green_11 = S_1$simulation$emis_green
emis_brown_11 = S_1$simulation$emis_brown
emis_11 = S_1$simulation$emis
temp_at_11 = S_1$simulation$temp_at

########### Grøn eksport ###########

x_gr_brown_11 = S_1$simulation$x_gr_brown
x_gr_brown_11 = S_1$simulation$x_gr_brown
x_brown_11 = S_1$simulation$x_brown
im_gr_brown_11 = S_1$simulation$im_gr_brown
im_brown_11 = S_1$simulation$im_brown
x_green_11 = S_1$simulation$x_green
x_gr_green_11 = S_1$simulation$x_gr_green
im_gr_green_11 = S_1$simulation$im_gr_green


############### Carbon tax #################
share_x_brown_11 = S_1$simulation$share_x_brown
share_tech_brown_11 = S_1$simulation$share_tech_brown
share_dev_brown_11 = S_1$simulation$share_dev_brown
carbon_tax_green_11 = S_1$simulation$carbon_tax_green
carbon_tax_brown_11 = S_1$simulation$carbon_tax_brown
carbon_tax_rate_brown_11 = S_1$simulation$carbon_tax_rate_brown
carbon_tax_x_brown_11 = S_1$simulation$carbon_tax_x_brown
carbon_tax_tech_brown_11 = S_1$simulation$carbon_tax_tech_brown
carbon_tax_dev_brown_11 = S_1$simulation$carbon_tax_dev_brown

#### Important checks #########

inv_gr_brown_t_11 > inv_brown_11 - inv_gr_im_brown_11 - inv_gr_rd_brown_11


## Stability check
h_brown_h_11 = S_1$simulation$h_brown_h
h_brown_s_11 = S_1$simulation$h_brown_s
h_green_h_11 = S_1$simulation$h_green_h
h_green_s_11 = S_1$simulation$h_green_s

plot(h_brown_h_11-h_brown_s_11)   
plot(h_green_h_11-h_green_s_11)  
```



## Scenario 2 



```{r}
# Define add-factor list (defining shock)
constantAdjList_S2 <- list(
  
carbon_tax_shock_brown = TIMESERIES(carbon_tax_shock_brown_model+1 ,START=c(2025,1),  FREQ=1),
Weak_PH = TIMESERIES(Weak_PH_model+1 ,START=c(1960,1),  FREQ=1)

)

```


```{r}
# Simulate the model (following shock)
S_2 <- SIMULATE(S_model
                    ,simType='FORECAST'
                    ,TSRANGE=c(1961,1,2060,1)
                    ,simConvergence=0.00001
                    ,simIterLimit=100
                    ,ConstantAdjustment=constantAdjList_S2
                    )
```


```{r}

f_brown_12= S_2$simulation$f_brown
epsilon_green_12= S_2$simulation$epsilon_green
## Economic variables
cons_w_green_12= S_2$simulation$cons_w_green
cons_r_green_12= S_2$simulation$cons_r_green
im_green_12= S_2$simulation$im_green
inv_green_12= S_2$simulation$inv_green
gov_tot_green_12= S_2$simulation$gov_tot_green
cons_green_12= S_2$simulation$cons_green
cons_brown_12 = S_2$simulation$cons_brown
inv_gr_rd_brown_12= S_2$simulation$inv_gr_rd_brown
k_gr_con_12= S_2$simulation$k_gr_con
y_r_brown_12= S_2$simulation$y_r_brown
yd_r_brown_12 = S_2$simulation$yd_r_brown
inv_gr_brown_12= S_2$simulation$inv_gr_brown
inv_con_brown_12=  S_2$simulation$inv_con_brown
inv_brown_12=  S_2$simulation$inv_brown
inv_gr_im_brown_12=  S_2$simulation$inv_gr_im_brown
inv_gr_rd_green_12= S_2$simulation$inv_gr_rd_green
inv_gr_green_12= S_2$simulation$inv_gr_green
inv_con_green_12=  S_2$simulation$inv_con_green
inv_gr_im_green_12=  S_2$simulation$inv_gr_im_green
inv_gr_brown_t_12 = S_2$simulation$inv_gr_brown_t
gov_gr_inv_brown_12 = S_2$simulation$gov_gr_inv_brown
gov_tot_inv_brown_12 = S_2$simulation$gov_tot_inv_brown
gov_tot_brown_12 = S_2$simulation$gov_tot_brown
gov_con_brown_12 = S_2$simulation$gov_con_brown
yd_r_green_12 = S_2$simulation$yd_r_green
t_green_12 = S_2$simulation$t_green
t_brown_12 = S_2$simulation$t_brown
gov_gr_green_12 = S_2$simulation$gov_gr_green
y_green_12 = S_2$simulation$y_green
y_12 = S_2$simulation$y
inv_gr_green_12 = S_2$simulation$inv_gr_green
k_gr_green_12 = S_2$simulation$k_gr_green
k_con_green_12 = S_2$simulation$k_con_green
k_gr_im_green_12 = S_2$simulation$k_gr_im_green
k_green_12 = S_2$simulation$k_green
k_gr_brown_12 = S_2$simulation$k_gr_brown
k_con_brown_12 = S_2$simulation$k_con_brown
k_gr_im_brown_12 = S_2$simulation$k_gr_im_brown
k_brown_12 = S_2$simulation$k_brown
y_brown_12 = S_2$simulation$y_brown


## Environmental variables
d_t_brown_12=  S_2$simulation$d_t_brown
d_t_green_12 = S_2$simulation$d_t_green
eta_brown_12 = S_2$simulation$eta_brown
eta_green_12 = S_2$simulation$eta_green
eta_gr_brown_12 = S_2$simulation$eta_gr_brown
eta_gr_green_12 = S_2$simulation$eta_gr_green
eta_gr_impv_green_12 = S_2$simulation$eta_gr_impv_green
eta_gr_impv_brown_12 = S_2$simulation$eta_gr_impv_brown
eta_con_brown_12 = S_2$simulation$eta_con_brown
eta_con_green_12 = S_2$simulation$eta_con_green
eta_avg_gr_green_12 = S_2$simulation$eta_avg_gr_green
eta_avg_gr_brown_12 = S_2$simulation$eta_avg_gr_brown
eta_im_gr_green_12 = S_2$simulation$eta_im_gr_green
eta_im_gr_brown_12 = S_2$simulation$eta_im_gr_brown


epsilon_brown_12=  S_2$simulation$epsilon_brown

gov_gr_rd_brown_12 = S_2$simulation$gov_gr_rd_brown
gov_gr_rd_green_12 = S_2$simulation$gov_gr_rd_green
gov_gr_brown_12= S_2$simulation$gov_gr_brown

beta_gr_green_12 = S_2$simulation$beta_gr_green
beta_gr_brown_12 = S_2$simulation$beta_gr_brown
beta_con_brown_12 = S_2$simulation$beta_con_brown
beta_con_green_12 = S_2$simulation$beta_con_green
beta_avg_gr_green_12 = S_2$simulation$beta_avg_gr_green
beta_avg_gr_brown_12 = S_2$simulation$beta_avg_gr_brown
beta_im_gr_green_12 = S_2$simulation$beta_im_gr_green
beta_im_gr_brown_12 = S_2$simulation$beta_im_gr_brown
beta_brown_12 = S_2$simulation$beta_brown
beta_green_12 = S_2$simulation$beta_green

emis_green_12 = S_2$simulation$emis_green
emis_brown_12 = S_2$simulation$emis_brown
emis_12 = S_2$simulation$emis
temp_at_12 = S_2$simulation$temp_at

########### Grøn eksport ###########

x_gr_brown_12 = S_2$simulation$x_gr_brown
x_gr_brown_12 = S_2$simulation$x_gr_brown
x_brown_12 = S_2$simulation$x_brown
im_gr_brown_12 = S_2$simulation$im_gr_brown
im_brown_12 = S_2$simulation$im_brown
x_green_12 = S_2$simulation$x_green
x_gr_green_12 = S_2$simulation$x_gr_green
im_gr_green_12 = S_2$simulation$im_gr_green


############### Carbon tax #################
share_x_brown_12 = S_2$simulation$share_x_brown
share_tech_brown_12 = S_2$simulation$share_tech_brown
share_dev_brown_12 = S_2$simulation$share_dev_brown
carbon_tax_green_12 = S_2$simulation$carbon_tax_green
carbon_tax_brown_12 = S_2$simulation$carbon_tax_brown
carbon_tax_rate_brown_12 = S_2$simulation$carbon_tax_rate_brown
carbon_tax_x_brown_12 = S_2$simulation$carbon_tax_x_brown
carbon_tax_tech_brown_12 = S_2$simulation$carbon_tax_tech_brown
carbon_tax_dev_brown_12 = S_2$simulation$carbon_tax_dev_brown

#### Important checks #########

inv_gr_brown_t_12 > inv_brown_12 - inv_gr_im_brown_12 - inv_gr_rd_brown_12


## Stability check
h_brown_h_12 = S_2$simulation$h_brown_h
h_brown_s_12 = S_2$simulation$h_brown_s
h_green_h_12 = S_2$simulation$h_green_h
h_green_s_12 = S_2$simulation$h_green_s

plot(h_brown_h_12-h_brown_s_12)   
plot(h_green_h_12-h_green_s_12)  
```


# Sensitivity

## Sens 1 strong PH 

### Baseline

```{r}
# Define add-factor list (defining shock)
constantAdjList_sen1b <- list(
  
Strong_PH = TIMESERIES(Strong_PH_model+1 ,START=c(1960,1),  FREQ=1)

)

```


```{r}
# Simulate the model (following shock)
Sen_1b <- SIMULATE(S_model
                    ,simType='FORECAST'
                    ,TSRANGE=c(1961,1,2060,1)
                    ,simConvergence=0.00001
                    ,simIterLimit=100
                    ,ConstantAdjustment=constantAdjList_sen1b
                    )
```


```{r}

carbon_tax_x_brown_sen1b= Sen_1b$simulation$carbon_tax_x_brown
x_gr_brown_sen1b= Sen_1b$simulation$x_gr_brown

cons_w_green_sen1b= Sen_1b$simulation$cons_w_green
cons_r_green_sen1b= Sen_1b$simulation$cons_r_green
im_green_sen1b= Sen_1b$simulation$im_green
inv_green_sen1b= Sen_1b$simulation$inv_green
gov_tot_green_sen1b= Sen_1b$simulation$gov_tot_green
cons_green_sen1b= Sen_1b$simulation$cons_green
cons_brown_sen1b = Sen_1b$simulation$cons_brown
inv_gr_rd_brown_sen1b= Sen_1b$simulation$inv_gr_rd_brown
k_gr_con_sen1b= Sen_1b$simulation$k_gr_con
y_r_brown_sen1b= Sen_1b$simulation$y_r_brown
yd_r_brown_sen1b = Sen_1b$simulation$yd_r_brown
inv_gr_brown_sen1b= Sen_1b$simulation$inv_gr_brown
eta_brown_sen1b= Sen_1b$simulation$eta_brown
inv_con_brown_sen1b=  Sen_1b$simulation$inv_con_brown
d_t_brown_sen1b=  Sen_1b$simulation$d_t_brown
inv_brown_sen1b=  Sen_1b$simulation$inv_brown
epsilon_brown_sen1b=  Sen_1b$simulation$epsilon_brown
inv_gr_im_brown_sen1b=  Sen_1b$simulation$inv_gr_im_brown

inv_gr_rd_green_sen1b= Sen_1b$simulation$inv_gr_rd_green

inv_gr_green_sen1b= Sen_1b$simulation$inv_gr_green

inv_con_green_sen1b=  Sen_1b$simulation$inv_con_green

inv_gr_im_green_sen1b=  Sen_1b$simulation$inv_gr_im_green

eta_brown_sen1b = Sen_1b$simulation$eta_brown
eta_green_sen1b = Sen_1b$simulation$eta_green

eta_gr_brown_sen1b = Sen_1b$simulation$eta_gr_brown
eta_gr_green_sen1b = Sen_1b$simulation$eta_gr_green

eta_gr_impv_green_sen1b = Sen_1b$simulation$eta_gr_impv_green

eta_gr_impv_brown_sen1b = Sen_1b$simulation$eta_gr_impv_brown


########### Grøn eksport ###########

x_gr_brown_sen1b = Sen_1b$simulation$x_gr_brown

x_brown_sen1b = Sen_1b$simulation$x_brown

x_gr_brown_sen1b = Sen_1b$simulation$x_gr_brown

x_brown_sen1b = Sen_1b$simulation$x_brown

im_gr_brown_sen1b = Sen_1b$simulation$im_gr_brown

im_brown_sen1b = Sen_1b$simulation$im_brown


eta_gr_green_sen1b = Sen_1b$simulation$eta_gr_green
eta_gr_brown_sen1b = Sen_1b$simulation$eta_gr_brown
eta_con_brown_sen1b = Sen_1b$simulation$eta_con_brown
eta_con_green_sen1b = Sen_1b$simulation$eta_con_green


eta_avg_gr_green_sen1b = Sen_1b$simulation$eta_avg_gr_green
eta_avg_gr_brown_sen1b = Sen_1b$simulation$eta_avg_gr_brown

eta_im_gr_green_sen1b = Sen_1b$simulation$eta_im_gr_green
eta_im_gr_brown_sen1b = Sen_1b$simulation$eta_im_gr_brown


x_brown_sen1b = Sen_1b$simulation$x_brown
x_gr_brown_sen1b = Sen_1b$simulation$x_gr_brown

x_green_sen1b = Sen_1b$simulation$x_green
x_gr_green_sen1b = Sen_1b$simulation$x_gr_green


y_green_sen1b = Sen_1b$simulation$y_green
y_sen1b = Sen_1b$simulation$y
emis_green_sen1b = Sen_1b$simulation$emis_green
emis_brown_sen1b = Sen_1b$simulation$emis_brown
emiD_sen1b = Sen_1b$simulation$emis
x_gr_brown_sen1b = Sen_1b$simulation$x_gr_brown
im_gr_green_sen1b = Sen_1b$simulation$im_gr_green
inv_gr_green_sen1b = Sen_1b$simulation$inv_gr_green
k_gr_green_sen1b = Sen_1b$simulation$k_gr_green
k_gr_green_sen1b = Sen_1b$simulation$k_gr_green
k_con_green_sen1b = Sen_1b$simulation$k_con_green
k_gr_im_green_sen1b = Sen_1b$simulation$k_gr_im_green
k_green_sen1b = Sen_1b$simulation$k_green
k_gr_brown_sen1b = Sen_1b$simulation$k_gr_brown
k_con_brown_sen1b = Sen_1b$simulation$k_con_brown
k_gr_im_brown_sen1b = Sen_1b$simulation$k_gr_im_brown

k_brown_sen1b = Sen_1b$simulation$k_brown

y_brown_sen1b = Sen_1b$simulation$y_brown



## Stability check
h_brown_h_sen1b = Sen_1b$simulation$h_brown_h
h_brown_s_sen1b = Sen_1b$simulation$h_brown_s
h_green_h_sen1b = Sen_1b$simulation$h_green_h
h_green_s_sen1b = Sen_1b$simulation$h_green_s

plot(h_brown_h_sen1b-h_brown_s_sen1b)   
plot(h_green_h_sen1b-h_green_s_sen1b)  
```


### Scenario 

```{r}
# Define add-factor list (defining shock)
constantAdjList_sen1 <- list(
  
Strong_PH = TIMESERIES(Strong_PH_model+1 ,START=c(1960,1),  FREQ=1),
carbon_tax_shock_brown = TIMESERIES(carbon_tax_shock_brown_model+1 ,START=c(2025,1),  FREQ=1)

)

```


```{r}
# Simulate the model (following shock)
Sen_1 <- SIMULATE(S_model
                    ,simType='FORECAST'
                    ,TSRANGE=c(1961,1,2060,1)
                    ,simConvergence=0.00001
                    ,simIterLimit=100
                    ,ConstantAdjustment=constantAdjList_sen1
                    )
```


```{r}

carbon_tax_x_brown_sen1= Sen_1$simulation$carbon_tax_x_brown
x_gr_brown_sen1= Sen_1$simulation$x_gr_brown

cons_w_green_sen1= Sen_1$simulation$cons_w_green
cons_r_green_sen1= Sen_1$simulation$cons_r_green
im_green_sen1= Sen_1$simulation$im_green
inv_green_sen1= Sen_1$simulation$inv_green
gov_tot_green_sen1= Sen_1$simulation$gov_tot_green
cons_green_sen1= Sen_1$simulation$cons_green
cons_brown_sen1 = Sen_1$simulation$cons_brown
inv_gr_rd_brown_sen1= Sen_1$simulation$inv_gr_rd_brown
k_gr_con_sen1= Sen_1$simulation$k_gr_con
y_r_brown_sen1= Sen_1$simulation$y_r_brown
yd_r_brown_sen1 = Sen_1$simulation$yd_r_brown
inv_gr_brown_sen1= Sen_1$simulation$inv_gr_brown
eta_brown_sen1= Sen_1$simulation$eta_brown
inv_con_brown_sen1=  Sen_1$simulation$inv_con_brown
d_t_brown_sen1=  Sen_1$simulation$d_t_brown
inv_brown_sen1=  Sen_1$simulation$inv_brown
epsilon_brown_sen1=  Sen_1$simulation$epsilon_brown
inv_gr_im_brown_sen1=  Sen_1$simulation$inv_gr_im_brown

inv_gr_rd_green_sen1= Sen_1$simulation$inv_gr_rd_green

inv_gr_green_sen1= Sen_1$simulation$inv_gr_green

inv_con_green_sen1=  Sen_1$simulation$inv_con_green

inv_gr_im_green_sen1=  Sen_1$simulation$inv_gr_im_green

eta_brown_sen1 = Sen_1$simulation$eta_brown
eta_green_sen1 = Sen_1$simulation$eta_green

eta_gr_brown_sen1 = Sen_1$simulation$eta_gr_brown
eta_gr_green_sen1 = Sen_1$simulation$eta_gr_green

eta_gr_impv_green_sen1 = Sen_1$simulation$eta_gr_impv_green

eta_gr_impv_brown_sen1 = Sen_1$simulation$eta_gr_impv_brown


########### Grøn eksport ###########

x_gr_brown_sen1 = Sen_1$simulation$x_gr_brown

x_brown_sen1 = Sen_1$simulation$x_brown

x_gr_brown_sen1 = Sen_1$simulation$x_gr_brown

x_brown_sen1 = Sen_1$simulation$x_brown

im_gr_brown_sen1 = Sen_1$simulation$im_gr_brown

im_brown_sen1 = Sen_1$simulation$im_brown


eta_gr_green_sen1 = Sen_1$simulation$eta_gr_green
eta_gr_brown_sen1 = Sen_1$simulation$eta_gr_brown
eta_con_brown_sen1 = Sen_1$simulation$eta_con_brown
eta_con_green_sen1 = Sen_1$simulation$eta_con_green


eta_avg_gr_green_sen1 = Sen_1$simulation$eta_avg_gr_green
eta_avg_gr_brown_sen1 = Sen_1$simulation$eta_avg_gr_brown

eta_im_gr_green_sen1 = Sen_1$simulation$eta_im_gr_green
eta_im_gr_brown_sen1 = Sen_1$simulation$eta_im_gr_brown


x_brown_sen1 = Sen_1$simulation$x_brown
x_gr_brown_sen1 = Sen_1$simulation$x_gr_brown

x_green_sen1 = Sen_1$simulation$x_green
x_gr_green_sen1 = Sen_1$simulation$x_gr_green


y_green_sen1 = Sen_1$simulation$y_green
y_sen1 = Sen_1$simulation$y
emis_green_sen1 = Sen_1$simulation$emis_green
emis_brown_sen1 = Sen_1$simulation$emis_brown
emiD_sen1 = Sen_1$simulation$emis
x_gr_brown_sen1 = Sen_1$simulation$x_gr_brown
im_gr_green_sen1 = Sen_1$simulation$im_gr_green
inv_gr_green_sen1 = Sen_1$simulation$inv_gr_green
k_gr_green_sen1 = Sen_1$simulation$k_gr_green
k_gr_green_sen1 = Sen_1$simulation$k_gr_green
k_con_green_sen1 = Sen_1$simulation$k_con_green
k_gr_im_green_sen1 = Sen_1$simulation$k_gr_im_green
k_green_sen1 = Sen_1$simulation$k_green
k_gr_brown_sen1 = Sen_1$simulation$k_gr_brown
k_con_brown_sen1 = Sen_1$simulation$k_con_brown
k_gr_im_brown_sen1 = Sen_1$simulation$k_gr_im_brown

k_brown_sen1 = Sen_1$simulation$k_brown

y_brown_sen1 = Sen_1$simulation$y_brown


## Stability check
h_brown_h_sen1 = Sen_1$simulation$h_brown_h
h_brown_s_sen1 = Sen_1$simulation$h_brown_s
h_green_h_sen1 = Sen_1$simulation$h_green_h
h_green_s_sen1 = Sen_1$simulation$h_green_s

plot(h_brown_h_sen1-h_brown_s_sen1)   
plot(h_green_h_sen1-h_green_s_sen1)  
```



## Sens 2 Narrowly strong PH 

### Baseline

```{r}
# Define add-factor list (defining shock)
constantAdjList_sen2b <- list(
  
Narrowly_strong_PH = TIMESERIES(Narrowly_strong_PH_model+1 ,START=c(1960,1),  FREQ=1)

)

```


```{r}
# Simulate the model (following shock)
Sen_2b <- SIMULATE(S_model
                    ,simType='FORECAST'
                    ,TSRANGE=c(1961,1,2060,1)
                    ,simConvergence=0.00001
                    ,simIterLimit=100
                    ,ConstantAdjustment=constantAdjList_sen2b
                    )
```


```{r}

carbon_tax_x_brown_sen2b= Sen_2b$simulation$carbon_tax_x_brown
x_gr_brown_sen2b= Sen_2b$simulation$x_gr_brown

cons_w_green_sen2b= Sen_2b$simulation$cons_w_green
cons_r_green_sen2b= Sen_2b$simulation$cons_r_green
im_green_sen2b= Sen_2b$simulation$im_green
inv_green_sen2b= Sen_2b$simulation$inv_green
gov_tot_green_sen2b= Sen_2b$simulation$gov_tot_green
cons_green_sen2b= Sen_2b$simulation$cons_green
cons_brown_sen2b = Sen_2b$simulation$cons_brown
inv_gr_rd_brown_sen2b= Sen_2b$simulation$inv_gr_rd_brown
k_gr_con_sen2b= Sen_2b$simulation$k_gr_con
y_r_brown_sen2b= Sen_2b$simulation$y_r_brown
yd_r_brown_sen2b = Sen_2b$simulation$yd_r_brown
inv_gr_brown_sen2b= Sen_2b$simulation$inv_gr_brown
eta_brown_sen2b= Sen_2b$simulation$eta_brown
inv_con_brown_sen2b=  Sen_2b$simulation$inv_con_brown
d_t_brown_sen2b=  Sen_2b$simulation$d_t_brown
inv_brown_sen2b=  Sen_2b$simulation$inv_brown
epsilon_brown_sen2b=  Sen_2b$simulation$epsilon_brown
inv_gr_im_brown_sen2b=  Sen_2b$simulation$inv_gr_im_brown

inv_gr_rd_green_sen2b= Sen_2b$simulation$inv_gr_rd_green

inv_gr_green_sen2b= Sen_2b$simulation$inv_gr_green

inv_con_green_sen2b=  Sen_2b$simulation$inv_con_green

inv_gr_im_green_sen2b=  Sen_2b$simulation$inv_gr_im_green

eta_brown_sen2b = Sen_2b$simulation$eta_brown
eta_green_sen2b = Sen_2b$simulation$eta_green

eta_gr_brown_sen2b = Sen_2b$simulation$eta_gr_brown
eta_gr_green_sen2b = Sen_2b$simulation$eta_gr_green

eta_gr_impv_green_sen2b = Sen_2b$simulation$eta_gr_impv_green

eta_gr_impv_brown_sen2b = Sen_2b$simulation$eta_gr_impv_brown


########### Grøn eksport ###########

x_gr_brown_sen2b = Sen_2b$simulation$x_gr_brown

x_brown_sen2b = Sen_2b$simulation$x_brown

x_gr_brown_sen2b = Sen_2b$simulation$x_gr_brown

x_brown_sen2b = Sen_2b$simulation$x_brown

im_gr_brown_sen2b = Sen_2b$simulation$im_gr_brown

im_brown_sen2b = Sen_2b$simulation$im_brown


eta_gr_green_sen2b = Sen_2b$simulation$eta_gr_green
eta_gr_brown_sen2b = Sen_2b$simulation$eta_gr_brown
eta_con_brown_sen2b = Sen_2b$simulation$eta_con_brown
eta_con_green_sen2b = Sen_2b$simulation$eta_con_green


eta_avg_gr_green_sen2b = Sen_2b$simulation$eta_avg_gr_green
eta_avg_gr_brown_sen2b = Sen_2b$simulation$eta_avg_gr_brown

eta_im_gr_green_sen2b = Sen_2b$simulation$eta_im_gr_green
eta_im_gr_brown_sen2b = Sen_2b$simulation$eta_im_gr_brown


x_brown_sen2b = Sen_2b$simulation$x_brown
x_gr_brown_sen2b = Sen_2b$simulation$x_gr_brown

x_green_sen2b = Sen_2b$simulation$x_green
x_gr_green_sen2b = Sen_2b$simulation$x_gr_green


y_green_sen2b = Sen_2b$simulation$y_green
y_sen2b = Sen_2b$simulation$y
emis_green_sen2b = Sen_2b$simulation$emis_green
emis_brown_sen2b = Sen_2b$simulation$emis_brown
emiD_sen2b = Sen_2b$simulation$emis
x_gr_brown_sen2b = Sen_2b$simulation$x_gr_brown
im_gr_green_sen2b = Sen_2b$simulation$im_gr_green
inv_gr_green_sen2b = Sen_2b$simulation$inv_gr_green
k_gr_green_sen2b = Sen_2b$simulation$k_gr_green
k_gr_green_sen2b = Sen_2b$simulation$k_gr_green
k_con_green_sen2b = Sen_2b$simulation$k_con_green
k_gr_im_green_sen2b = Sen_2b$simulation$k_gr_im_green
k_green_sen2b = Sen_2b$simulation$k_green
k_gr_brown_sen2b = Sen_2b$simulation$k_gr_brown
k_con_brown_sen2b = Sen_2b$simulation$k_con_brown
k_gr_im_brown_sen2b = Sen_2b$simulation$k_gr_im_brown

k_brown_sen2b = Sen_2b$simulation$k_brown

y_brown_sen2b = Sen_2b$simulation$y_brown


#### Important checks #########

## Stability check
h_brown_h_sen2b = Sen_2b$simulation$h_brown_h
h_brown_s_sen2b = Sen_2b$simulation$h_brown_s
h_green_h_sen2b = Sen_2b$simulation$h_green_h
h_green_s_sen2b = Sen_2b$simulation$h_green_s

plot(h_brown_h_sen2b-h_brown_s_sen2b)   
plot(h_green_h_sen2b-h_green_s_sen2b)  
```


### Scenario 

```{r}
# Define add-factor list (defining shock)
constantAdjList_sen2 <- list(
  
Narrowly_strong_PH = TIMESERIES(Narrowly_strong_PH_model+1 ,START=c(1960,1),  FREQ=1),
carbon_tax_shock_brown = TIMESERIES(carbon_tax_shock_brown_model+1 ,START=c(2025,1),  FREQ=1)

)

```


```{r}
# Simulate the model (following shock)
Sen_2 <- SIMULATE(S_model
                    ,simType='FORECAST'
                    ,TSRANGE=c(1961,1,2060,1)
                    ,simConvergence=0.00001
                    ,simIterLimit=100
                    ,ConstantAdjustment=constantAdjList_sen2
                    )
```


```{r}

carbon_tax_x_brown_sen2= Sen_2$simulation$carbon_tax_x_brown
x_gr_brown_sen2= Sen_2$simulation$x_gr_brown

cons_w_green_sen2= Sen_2$simulation$cons_w_green
cons_r_green_sen2= Sen_2$simulation$cons_r_green
im_green_sen2= Sen_2$simulation$im_green
inv_green_sen2= Sen_2$simulation$inv_green
gov_tot_green_sen2= Sen_2$simulation$gov_tot_green
cons_green_sen2= Sen_2$simulation$cons_green
cons_brown_sen2 = Sen_2$simulation$cons_brown
inv_gr_rd_brown_sen2= Sen_2$simulation$inv_gr_rd_brown
k_gr_con_sen2= Sen_2$simulation$k_gr_con
y_r_brown_sen2= Sen_2$simulation$y_r_brown
yd_r_brown_sen2 = Sen_2$simulation$yd_r_brown
inv_gr_brown_sen2= Sen_2$simulation$inv_gr_brown
eta_brown_sen2= Sen_2$simulation$eta_brown
inv_con_brown_sen2=  Sen_2$simulation$inv_con_brown
d_t_brown_sen2=  Sen_2$simulation$d_t_brown
inv_brown_sen2=  Sen_2$simulation$inv_brown
epsilon_brown_sen2=  Sen_2$simulation$epsilon_brown
inv_gr_im_brown_sen2=  Sen_2$simulation$inv_gr_im_brown

inv_gr_rd_green_sen2= Sen_2$simulation$inv_gr_rd_green

inv_gr_green_sen2= Sen_2$simulation$inv_gr_green

inv_con_green_sen2=  Sen_2$simulation$inv_con_green

inv_gr_im_green_sen2=  Sen_2$simulation$inv_gr_im_green

eta_brown_sen2 = Sen_2$simulation$eta_brown
eta_green_sen2 = Sen_2$simulation$eta_green

eta_gr_brown_sen2 = Sen_2$simulation$eta_gr_brown
eta_gr_green_sen2 = Sen_2$simulation$eta_gr_green

eta_gr_impv_green_sen2 = Sen_2$simulation$eta_gr_impv_green

eta_gr_impv_brown_sen2 = Sen_2$simulation$eta_gr_impv_brown


########### Grøn eksport ###########

x_gr_brown_sen2 = Sen_2$simulation$x_gr_brown

x_brown_sen2 = Sen_2$simulation$x_brown

x_gr_brown_sen2 = Sen_2$simulation$x_gr_brown

x_brown_sen2 = Sen_2$simulation$x_brown

im_gr_brown_sen2 = Sen_2$simulation$im_gr_brown

im_brown_sen2 = Sen_2$simulation$im_brown


eta_gr_green_sen2 = Sen_2$simulation$eta_gr_green
eta_gr_brown_sen2 = Sen_2$simulation$eta_gr_brown
eta_con_brown_sen2 = Sen_2$simulation$eta_con_brown
eta_con_green_sen2 = Sen_2$simulation$eta_con_green


eta_avg_gr_green_sen2 = Sen_2$simulation$eta_avg_gr_green
eta_avg_gr_brown_sen2 = Sen_2$simulation$eta_avg_gr_brown

eta_im_gr_green_sen2 = Sen_2$simulation$eta_im_gr_green
eta_im_gr_brown_sen2 = Sen_2$simulation$eta_im_gr_brown


x_brown_sen2 = Sen_2$simulation$x_brown
x_gr_brown_sen2 = Sen_2$simulation$x_gr_brown

x_green_sen2 = Sen_2$simulation$x_green
x_gr_green_sen2 = Sen_2$simulation$x_gr_green


y_green_sen2 = Sen_2$simulation$y_green
y_sen2 = Sen_2$simulation$y
emis_green_sen2 = Sen_2$simulation$emis_green
emis_brown_sen2 = Sen_2$simulation$emis_brown
emiD_sen2 = Sen_2$simulation$emis
x_gr_brown_sen2 = Sen_2$simulation$x_gr_brown
im_gr_green_sen2 = Sen_2$simulation$im_gr_green
inv_gr_green_sen2 = Sen_2$simulation$inv_gr_green
k_gr_green_sen2 = Sen_2$simulation$k_gr_green
k_gr_green_sen2 = Sen_2$simulation$k_gr_green
k_con_green_sen2 = Sen_2$simulation$k_con_green
k_gr_im_green_sen2 = Sen_2$simulation$k_gr_im_green
k_green_sen2 = Sen_2$simulation$k_green
k_gr_brown_sen2 = Sen_2$simulation$k_gr_brown
k_con_brown_sen2 = Sen_2$simulation$k_con_brown
k_gr_im_brown_sen2 = Sen_2$simulation$k_gr_im_brown

k_brown_sen2 = Sen_2$simulation$k_brown

y_brown_sen2 = Sen_2$simulation$y_brown


## Stability check
h_brown_h_sen2 = Sen_2$simulation$h_brown_h
h_brown_s_sen2 = Sen_2$simulation$h_brown_s
h_green_h_sen2 = Sen_2$simulation$h_green_h
h_green_s_sen2 = Sen_2$simulation$h_green_s

plot(h_brown_h_sen2-h_brown_s_sen2)   
plot(h_green_h_sen2-h_green_s_sen2)  
```

## Sens 3 Strong PH  and Weak PH

### Baseline

```{r}
# Define add-factor list (defining shock)
constantAdjList_sen3b <- list(
  
Weak_PH = TIMESERIES(Weak_PH_model+1 ,START=c(1960,1),  FREQ=1),
Strong_PH = TIMESERIES(Strong_PH_model+1 ,START=c(1960,1),  FREQ=1)

)

```


```{r}
# Simulate the model (following shock)
Sen_3b <- SIMULATE(S_model
                    ,simType='FORECAST'
                    ,TSRANGE=c(1961,1,2060,1)
                    ,simConvergence=0.00001
                    ,simIterLimit=100
                    ,ConstantAdjustment=constantAdjList_sen3b
                    )
```


```{r}

carbon_tax_x_brown_sen3b= Sen_3b$simulation$carbon_tax_x_brown
x_gr_brown_sen3b= Sen_3b$simulation$x_gr_brown

cons_w_green_sen3b= Sen_3b$simulation$cons_w_green
cons_r_green_sen3b= Sen_3b$simulation$cons_r_green
im_green_sen3b= Sen_3b$simulation$im_green
inv_green_sen3b= Sen_3b$simulation$inv_green
gov_tot_green_sen3b= Sen_3b$simulation$gov_tot_green
cons_green_sen3b= Sen_3b$simulation$cons_green
cons_brown_sen3b = Sen_3b$simulation$cons_brown
inv_gr_rd_brown_sen3b= Sen_3b$simulation$inv_gr_rd_brown
k_gr_con_sen3b= Sen_3b$simulation$k_gr_con
y_r_brown_sen3b= Sen_3b$simulation$y_r_brown
yd_r_brown_sen3b = Sen_3b$simulation$yd_r_brown
inv_gr_brown_sen3b= Sen_3b$simulation$inv_gr_brown
eta_brown_sen3b= Sen_3b$simulation$eta_brown
inv_con_brown_sen3b=  Sen_3b$simulation$inv_con_brown
d_t_brown_sen3b=  Sen_3b$simulation$d_t_brown
inv_brown_sen3b=  Sen_3b$simulation$inv_brown
epsilon_brown_sen3b=  Sen_3b$simulation$epsilon_brown
inv_gr_im_brown_sen3b=  Sen_3b$simulation$inv_gr_im_brown

inv_gr_rd_green_sen3b= Sen_3b$simulation$inv_gr_rd_green

inv_gr_green_sen3b= Sen_3b$simulation$inv_gr_green

inv_con_green_sen3b=  Sen_3b$simulation$inv_con_green

inv_gr_im_green_sen3b=  Sen_3b$simulation$inv_gr_im_green

eta_brown_sen3b = Sen_3b$simulation$eta_brown
eta_green_sen3b = Sen_3b$simulation$eta_green

eta_gr_brown_sen3b = Sen_3b$simulation$eta_gr_brown
eta_gr_green_sen3b = Sen_3b$simulation$eta_gr_green

eta_gr_impv_green_sen3b = Sen_3b$simulation$eta_gr_impv_green

eta_gr_impv_brown_sen3b = Sen_3b$simulation$eta_gr_impv_brown


########### Grøn eksport ###########

x_gr_brown_sen3b = Sen_3b$simulation$x_gr_brown

x_brown_sen3b = Sen_3b$simulation$x_brown

x_gr_brown_sen3b = Sen_3b$simulation$x_gr_brown

x_brown_sen3b = Sen_3b$simulation$x_brown

im_gr_brown_sen3b = Sen_3b$simulation$im_gr_brown

im_brown_sen3b = Sen_3b$simulation$im_brown


eta_gr_green_sen3b = Sen_3b$simulation$eta_gr_green
eta_gr_brown_sen3b = Sen_3b$simulation$eta_gr_brown
eta_con_brown_sen3b = Sen_3b$simulation$eta_con_brown
eta_con_green_sen3b = Sen_3b$simulation$eta_con_green


eta_avg_gr_green_sen3b = Sen_3b$simulation$eta_avg_gr_green
eta_avg_gr_brown_sen3b = Sen_3b$simulation$eta_avg_gr_brown

eta_im_gr_green_sen3b = Sen_3b$simulation$eta_im_gr_green
eta_im_gr_brown_sen3b = Sen_3b$simulation$eta_im_gr_brown


x_brown_sen3b = Sen_3b$simulation$x_brown
x_gr_brown_sen3b = Sen_3b$simulation$x_gr_brown

x_green_sen3b = Sen_3b$simulation$x_green
x_gr_green_sen3b = Sen_3b$simulation$x_gr_green


y_green_sen3b = Sen_3b$simulation$y_green
y_sen3b = Sen_3b$simulation$y
emis_green_sen3b = Sen_3b$simulation$emis_green
emis_brown_sen3b = Sen_3b$simulation$emis_brown
emiD_sen3b = Sen_3b$simulation$emis
x_gr_brown_sen3b = Sen_3b$simulation$x_gr_brown
im_gr_green_sen3b = Sen_3b$simulation$im_gr_green
inv_gr_green_sen3b = Sen_3b$simulation$inv_gr_green
k_gr_green_sen3b = Sen_3b$simulation$k_gr_green
k_gr_green_sen3b = Sen_3b$simulation$k_gr_green
k_con_green_sen3b = Sen_3b$simulation$k_con_green
k_gr_im_green_sen3b = Sen_3b$simulation$k_gr_im_green
k_green_sen3b = Sen_3b$simulation$k_green
k_gr_brown_sen3b = Sen_3b$simulation$k_gr_brown
k_con_brown_sen3b = Sen_3b$simulation$k_con_brown
k_gr_im_brown_sen3b = Sen_3b$simulation$k_gr_im_brown

k_brown_sen3b = Sen_3b$simulation$k_brown

y_brown_sen3b = Sen_3b$simulation$y_brown


#### Important checks #########

## Stability check
h_brown_h_sen3b = Sen_3b$simulation$h_brown_h
h_brown_s_sen3b = Sen_3b$simulation$h_brown_s
h_green_h_sen3b = Sen_3b$simulation$h_green_h
h_green_s_sen3b = Sen_3b$simulation$h_green_s

plot(h_brown_h_sen3b-h_brown_s_sen3b)   
plot(h_green_h_sen3b-h_green_s_sen3b)  
```


### Scenario 

```{r}
# Define add-factor list (defining shock)
constantAdjList_sen3 <- list(
  
Weak_PH = TIMESERIES(Weak_PH_model+1 ,START=c(1960,1),  FREQ=1),
Strong_PH = TIMESERIES(Strong_PH_model+1 ,START=c(1960,1),  FREQ=1),
carbon_tax_shock_brown = TIMESERIES(carbon_tax_shock_brown_model+1 ,START=c(2025,1),  FREQ=1)

)

```


```{r}
# Simulate the model (following shock)
Sen_3 <- SIMULATE(S_model
                    ,simType='FORECAST'
                    ,TSRANGE=c(1961,1,2060,1)
                    ,simConvergence=0.00001
                    ,simIterLimit=100
                    ,ConstantAdjustment=constantAdjList_sen3
                    )
```


```{r}

carbon_tax_x_brown_sen3= Sen_3$simulation$carbon_tax_x_brown
x_gr_brown_sen3= Sen_3$simulation$x_gr_brown

cons_w_green_sen3= Sen_3$simulation$cons_w_green
cons_r_green_sen3= Sen_3$simulation$cons_r_green
im_green_sen3= Sen_3$simulation$im_green
inv_green_sen3= Sen_3$simulation$inv_green
gov_tot_green_sen3= Sen_3$simulation$gov_tot_green
cons_green_sen3= Sen_3$simulation$cons_green
cons_brown_sen3 = Sen_3$simulation$cons_brown
inv_gr_rd_brown_sen3= Sen_3$simulation$inv_gr_rd_brown
k_gr_con_sen3= Sen_3$simulation$k_gr_con
y_r_brown_sen3= Sen_3$simulation$y_r_brown
yd_r_brown_sen3 = Sen_3$simulation$yd_r_brown
inv_gr_brown_sen3= Sen_3$simulation$inv_gr_brown
eta_brown_sen3= Sen_3$simulation$eta_brown
inv_con_brown_sen3=  Sen_3$simulation$inv_con_brown
d_t_brown_sen3=  Sen_3$simulation$d_t_brown
inv_brown_sen3=  Sen_3$simulation$inv_brown
epsilon_brown_sen3=  Sen_3$simulation$epsilon_brown
inv_gr_im_brown_sen3=  Sen_3$simulation$inv_gr_im_brown

inv_gr_rd_green_sen3= Sen_3$simulation$inv_gr_rd_green

inv_gr_green_sen3= Sen_3$simulation$inv_gr_green

inv_con_green_sen3=  Sen_3$simulation$inv_con_green

inv_gr_im_green_sen3=  Sen_3$simulation$inv_gr_im_green

eta_brown_sen3 = Sen_3$simulation$eta_brown
eta_green_sen3 = Sen_3$simulation$eta_green

eta_gr_brown_sen3 = Sen_3$simulation$eta_gr_brown
eta_gr_green_sen3 = Sen_3$simulation$eta_gr_green

eta_gr_impv_green_sen3 = Sen_3$simulation$eta_gr_impv_green

eta_gr_impv_brown_sen3 = Sen_3$simulation$eta_gr_impv_brown


########### Grøn eksport ###########

x_gr_brown_sen3 = Sen_3$simulation$x_gr_brown

x_brown_sen3 = Sen_3$simulation$x_brown

x_gr_brown_sen3 = Sen_3$simulation$x_gr_brown

x_brown_sen3 = Sen_3$simulation$x_brown

im_gr_brown_sen3 = Sen_3$simulation$im_gr_brown

im_brown_sen3 = Sen_3$simulation$im_brown


eta_gr_green_sen3 = Sen_3$simulation$eta_gr_green
eta_gr_brown_sen3 = Sen_3$simulation$eta_gr_brown
eta_con_brown_sen3 = Sen_3$simulation$eta_con_brown
eta_con_green_sen3 = Sen_3$simulation$eta_con_green


eta_avg_gr_green_sen3 = Sen_3$simulation$eta_avg_gr_green
eta_avg_gr_brown_sen3 = Sen_3$simulation$eta_avg_gr_brown

eta_im_gr_green_sen3 = Sen_3$simulation$eta_im_gr_green
eta_im_gr_brown_sen3 = Sen_3$simulation$eta_im_gr_brown


x_brown_sen3 = Sen_3$simulation$x_brown
x_gr_brown_sen3 = Sen_3$simulation$x_gr_brown

x_green_sen3 = Sen_3$simulation$x_green
x_gr_green_sen3 = Sen_3$simulation$x_gr_green


y_green_sen3 = Sen_3$simulation$y_green
y_sen3 = Sen_3$simulation$y
emis_green_sen3 = Sen_3$simulation$emis_green
emis_brown_sen3 = Sen_3$simulation$emis_brown
emiD_sen3 = Sen_3$simulation$emis
x_gr_brown_sen3 = Sen_3$simulation$x_gr_brown
im_gr_green_sen3 = Sen_3$simulation$im_gr_green
inv_gr_green_sen3 = Sen_3$simulation$inv_gr_green
k_gr_green_sen3 = Sen_3$simulation$k_gr_green
k_gr_green_sen3 = Sen_3$simulation$k_gr_green
k_con_green_sen3 = Sen_3$simulation$k_con_green
k_gr_im_green_sen3 = Sen_3$simulation$k_gr_im_green
k_green_sen3 = Sen_3$simulation$k_green
k_gr_brown_sen3 = Sen_3$simulation$k_gr_brown
k_con_brown_sen3 = Sen_3$simulation$k_con_brown
k_gr_im_brown_sen3 = Sen_3$simulation$k_gr_im_brown

k_brown_sen3 = Sen_3$simulation$k_brown

y_brown_sen3 = Sen_3$simulation$y_brown


## Stability check
h_brown_h_sen3 = Sen_3$simulation$h_brown_h
h_brown_s_sen3 = Sen_3$simulation$h_brown_s
h_green_h_sen3 = Sen_3$simulation$h_green_h
h_green_s_sen3 = Sen_3$simulation$h_green_s

plot(h_brown_h_sen3-h_brown_s_sen3)   
plot(h_green_h_sen3-h_green_s_sen3)  
```



# Sensitivity plots


## Isolating the effects

```{r, fig.width= 10, fig.height= 15}
par(mfrow=c(3,2))
plot((y_brown_12 - y_brown_20)/y_brown_20*100, col= "green", xlab= "Year", ylab= "% change in GDP", main= "Change in GDP DK", lwd=2);
lines((y_brown_11 - y_brown_10)/y_brown_10*100, col= "black", lwd=2);
lines((y_brown_sen1 - y_brown_sen1b)/y_brown_sen1b*100, col= "red", lwd=2);
lines((y_brown_sen2 - y_brown_sen2b)/y_brown_sen2b*100, col= "blue", lwd=2);
legend("left", legend=c("No PH effects","Weak PH","Narrowly strong PH" ,"Strong PH"),
       lty=c(1),lwd=c(2),bty="n", col = c("black","green","blue", "red"));
grid()

plot((y_green_12 - y_green_20)/y_green_20*100, col= "green", xlab= "Year", ylab= "% change in GDP", main= "Change in GDP ROW", lwd=2);
lines((y_green_11 - y_green_10)/y_green_10*100, col= "black", lwd=2);
lines((y_green_sen1 - y_green_sen1b)/y_green_sen1b*100, col= "red", lwd=2);
lines((y_green_sen2 - y_green_sen2b)/y_green_sen2b*100, col= "blue", lwd=2);
legend("left", legend=c("No PH effects","Weak PH","Narrowly strong PH" ,"Strong PH"),
       lty=c(1),lwd=c(2),bty="n", col = c("black","green","blue", "red"));
grid()

plot((eta_brown_12 - eta_brown_20)/eta_brown_20*100, col= "green", xlab= "Year", ylab= "% change in renewability share", main= "renewability share DK", lwd=2);
lines((eta_brown_11 - eta_brown_10)/eta_brown_10*100, col= "black", lwd=2);
lines((eta_brown_sen1 - eta_brown_sen1b)/eta_brown_sen1b*100, col= "red", lwd=2);
lines((eta_brown_sen2 - eta_brown_sen2b)/eta_brown_sen2b*100, col= "blue", lwd=2);
legend("left", legend=c("No PH effects","Weak PH","Narrowly strong PH" ,"Strong PH"),
       lty=c(1),lwd=c(2),bty="n", col = c("black","green","blue", "red"));
grid()

plot((eta_green_12 - eta_green_20)/eta_green_20*100, col= "green", xlab= "Year", ylab= "% change in renewability share", main= "renewability share ROW", ylim= c(0,0.015), lwd=2);
lines((eta_green_11 - eta_green_10)/eta_green_10*100, col= "black", lwd=2);
lines((eta_green_sen1 - eta_green_sen1b)/eta_green_sen1b*100, col= "red", lwd=2);
lines((eta_green_sen2 - eta_green_sen2b)/eta_green_sen2b*100, col= "blue", lwd=2);
legend("left", legend=c("No PH effects","Weak PH","Narrowly strong PH" ,"Strong PH"),
       lty=c(1),lwd=c(2),bty="n", col = c("black","green","blue", "red"));
grid()


plot((emis_brown_12-emis_brown_20)/emis_brown_20*100, col= "green", xlab= "Year", ylab= "% change in emission", main= "Emission DK", lwd=2);
lines((emis_brown_11-emis_brown_10)/emis_brown_10*100, col= "black", lwd=2);
lines((emis_brown_sen1-emis_brown_sen1b)/emis_brown_sen1b*100, col= "red", lwd=2);
lines((emis_brown_sen2-emis_brown_sen2b)/emis_brown_sen2b*100, col= "blue", lwd=2);
legend("left", legend=c("No PH effects","Weak PH","Narrowly strong PH" ,"Strong PH"),
       lty=c(1),lwd=c(2),bty="n", col = c("black","green","blue", "red"));
grid()


plot((emis_green_12-emis_green_20)/emis_green_20*100, col= "green", xlab= "Year", ylab= "% change in emission", main= "Emission ROW", ylim= c(-0.03, 0.005), lwd=2);
lines((emis_green_11-emis_green_10)/emis_green_10*100, col= "black", lwd=2);
lines((emis_green_sen1-emis_green_sen1b)/emis_green_sen1b*100, col= "red", lwd=2);
lines((emis_green_sen2-emis_green_sen2b)/emis_green_sen2b*100, col= "blue", lwd=2);
legend("left", legend=c("No PH effects","Weak PH","Narrowly strong PH" ,"Strong PH"),
       lty=c(1),lwd=c(2),bty="n", col = c("black","green","blue", "red"));
grid()
```


